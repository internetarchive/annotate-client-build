!function e(t,n,r){var o="function"==typeof hypothesisRequire&&hypothesisRequire;function i(a,u){if(!n[a]){if(!t[a]){var c="function"==typeof hypothesisRequire&&hypothesisRequire;if(!u&&c)return c(a,!0);if(o)return o(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return i(n||e)}),l,l.exports,e,t,n,r)}return n[a].exports}for(var a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){(function(e){
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)&&o.length){var a=r.apply(null,o);a&&e.push(a)}else if("object"===i)for(var u in o)n.call(o,u)&&o[u]&&e.push(u)}}return e.join(" ")}void 0!==t&&t.exports?(r.default=r,t.exports=r):"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],(function(){return r})):window.classNames=r}()}).call(this,void 0)},{}],2:[function(e,t,n){(function(e){var r,o;r=this,o=function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,n=Object.isFrozen,r=Object.keys,o=Object.freeze,i=Object.seal,a=Object.create,u="undefined"!=typeof Reflect&&Reflect,c=u.apply,s=u.construct;c||(c=function(e,t,n){return e.apply(t,n)}),o||(o=function(e){return e}),i||(i=function(e){return e}),s||(s=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var l=S(Array.prototype.forEach),f=S(Array.prototype.indexOf),d=S(Array.prototype.join),p=S(Array.prototype.pop),m=S(Array.prototype.push),h=S(Array.prototype.slice),y=S(String.prototype.toLowerCase),v=S(String.prototype.match),g=S(String.prototype.replace),b=S(String.prototype.indexOf),_=S(String.prototype.trim),w=S(RegExp.prototype.test),O=A(RegExp),E=A(TypeError);function S(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return c(e,t,r)}}function A(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return s(e,n)}}function j(e,r){t&&t(e,null);for(var o=r.length;o--;){var i=r[o];if("string"==typeof i){var a=y(i);a!==i&&(n(r)||(r[o]=a),i=a)}e[i]=!0}return e}function k(t){var n=a(null),r=void 0;for(r in t)c(e,t,[r])&&(n[r]=t[r]);return n}var T=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),x=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),C=o(["#text"]),M=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),D=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),I=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),L=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),R=i(/\{\{[\s\S]*|[\s\S]*\}\}/gm),F=i(/<%[\s\S]*|[\s\S]*%>/gm),U=i(/^data-[\-\w.\u00B7-\uFFFF]/),q=i(/^aria-[\-\w]+$/),H=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B=i(/^(?:\w+script|data):/i),G=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function $(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var W=function(){return"undefined"==typeof window?null:window},V=function(e,t){if("object"!==(void 0===e?"undefined":z(e))||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W(),n=function(t){return e(t)};if(n.version="2.0.15",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var i=t.document,a=!1,u=t.document,c=t.DocumentFragment,s=t.HTMLTemplateElement,S=t.Node,A=t.NodeFilter,K=t.NamedNodeMap,Q=void 0===K?t.NamedNodeMap||t.MozNamedAttrMap:K,Y=t.Text,J=t.Comment,X=t.DOMParser,Z=t.trustedTypes;if("function"==typeof s){var ee=u.createElement("template");ee.content&&ee.content.ownerDocument&&(u=ee.content.ownerDocument)}var te=V(Z,i),ne=te&&Ie?te.createHTML(""):"",re=u,oe=re.implementation,ie=re.createNodeIterator,ae=re.getElementsByTagName,ue=re.createDocumentFragment,ce=i.importNode,se=k(u).documentMode?u.documentMode:{},le={};n.isSupported=oe&&void 0!==oe.createHTMLDocument&&9!==se;var fe=R,de=F,pe=U,me=q,he=B,ye=G,ve=H,ge=null,be=j({},[].concat($(T),$(P),$(x),$(N),$(C))),_e=null,we=j({},[].concat($(M),$(D),$(I),$(L))),Oe=null,Ee=null,Se=!0,Ae=!0,je=!1,ke=!1,Te=!1,Pe=!1,xe=!1,Ne=!1,Ce=!1,Me=!1,De=!1,Ie=!1,Le=!0,Re=!0,Fe=!1,Ue={},qe=j({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),He=null,Be=j({},["audio","video","img","source","image","track"]),Ge=null,ze=j({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),$e=null,We=u.createElement("form"),Ve=function(e){$e&&$e===e||(e&&"object"===(void 0===e?"undefined":z(e))||(e={}),e=k(e),ge="ALLOWED_TAGS"in e?j({},e.ALLOWED_TAGS):be,_e="ALLOWED_ATTR"in e?j({},e.ALLOWED_ATTR):we,Ge="ADD_URI_SAFE_ATTR"in e?j(k(ze),e.ADD_URI_SAFE_ATTR):ze,He="ADD_DATA_URI_TAGS"in e?j(k(Be),e.ADD_DATA_URI_TAGS):Be,Oe="FORBID_TAGS"in e?j({},e.FORBID_TAGS):{},Ee="FORBID_ATTR"in e?j({},e.FORBID_ATTR):{},Ue="USE_PROFILES"in e&&e.USE_PROFILES,Se=!1!==e.ALLOW_ARIA_ATTR,Ae=!1!==e.ALLOW_DATA_ATTR,je=e.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=e.SAFE_FOR_JQUERY||!1,Te=e.SAFE_FOR_TEMPLATES||!1,Pe=e.WHOLE_DOCUMENT||!1,Ce=e.RETURN_DOM||!1,Me=e.RETURN_DOM_FRAGMENT||!1,De=e.RETURN_DOM_IMPORT||!1,Ie=e.RETURN_TRUSTED_TYPE||!1,Ne=e.FORCE_BODY||!1,Le=!1!==e.SANITIZE_DOM,Re=!1!==e.KEEP_CONTENT,Fe=e.IN_PLACE||!1,ve=e.ALLOWED_URI_REGEXP||ve,Te&&(Ae=!1),Me&&(Ce=!0),Ue&&(ge=j({},[].concat($(C))),_e=[],!0===Ue.html&&(j(ge,T),j(_e,M)),!0===Ue.svg&&(j(ge,P),j(_e,D),j(_e,L)),!0===Ue.svgFilters&&(j(ge,x),j(_e,D),j(_e,L)),!0===Ue.mathMl&&(j(ge,N),j(_e,I),j(_e,L))),e.ADD_TAGS&&(ge===be&&(ge=k(ge)),j(ge,e.ADD_TAGS)),e.ADD_ATTR&&(_e===we&&(_e=k(_e)),j(_e,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&j(Ge,e.ADD_URI_SAFE_ATTR),Re&&(ge["#text"]=!0),Pe&&j(ge,["html","head","body"]),ge.table&&(j(ge,["tbody"]),delete Oe.tbody),o&&o(e),$e=e)},Ke=function(e){m(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=ne}},Qe=function(e,t){try{m(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){m(n.removed,{attribute:null,from:t})}t.removeAttribute(e)},Ye=function(e){var t=void 0,n=void 0;if(Ne)e="<remove></remove>"+e;else{var r=v(e,/^[\r\n\t ]+/);n=r&&r[0]}var o=te?te.createHTML(e):e;try{t=(new X).parseFromString(o,"text/html")}catch(e){}if(a&&j(Oe,["title"]),!t||!t.documentElement){var i=(t=oe.createHTMLDocument("")).body;i.parentNode.removeChild(i.parentNode.firstElementChild),i.outerHTML=o}return e&&n&&t.body.insertBefore(u.createTextNode(n),t.body.childNodes[0]||null),ae.call(t,Pe?"html":"body")[0]};n.isSupported&&function(){try{var e=Ye("<x/><title>&lt;/title&gt;&lt;img&gt;");w(/<\/title/,e.querySelector("title").innerHTML)&&(a=!0)}catch(e){}}();var Je=function(e){return ie.call(e.ownerDocument||e,e,A.SHOW_ELEMENT|A.SHOW_COMMENT|A.SHOW_TEXT,(function(){return A.FILTER_ACCEPT}),!1)},Xe=function(e){return!(e instanceof Y||e instanceof J||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof Q&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI)},Ze=function(e){return"object"===(void 0===S?"undefined":z(S))?e instanceof S:e&&"object"===(void 0===e?"undefined":z(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},et=function(e,t,r){le[e]&&l(le[e],(function(e){e.call(n,t,r,$e)}))},tt=function(e){var t=void 0;if(et("beforeSanitizeElements",e,null),Xe(e))return Ke(e),!0;if(v(e.nodeName,/[\u0080-\uFFFF]/))return Ke(e),!0;var r=y(e.nodeName);if(et("uponSanitizeElement",e,{tagName:r,allowedTags:ge}),("svg"===r||"math"===r)&&0!==e.querySelectorAll("p, br").length)return Ke(e),!0;if(!ge[r]||Oe[r]){if(Re&&!qe[r]&&"function"==typeof e.insertAdjacentHTML)try{var o=e.innerHTML;e.insertAdjacentHTML("AfterEnd",te?te.createHTML(o):o)}catch(e){}return Ke(e),!0}return"noscript"===r&&w(/<\/noscript/i,e.innerHTML)||"noembed"===r&&w(/<\/noembed/i,e.innerHTML)?(Ke(e),!0):(!ke||Ze(e.firstElementChild)||Ze(e.content)&&Ze(e.content.firstElementChild)||!w(/</g,e.textContent)||(m(n.removed,{element:e.cloneNode()}),e.innerHTML?e.innerHTML=g(e.innerHTML,/</g,"&lt;"):e.innerHTML=g(e.textContent,/</g,"&lt;")),Te&&3===e.nodeType&&(t=e.textContent,t=g(t,fe," "),t=g(t,de," "),e.textContent!==t&&(m(n.removed,{element:e.cloneNode()}),e.textContent=t)),et("afterSanitizeElements",e,null),!1)},nt=function(e,t,n){if(Le&&("id"===t||"name"===t)&&(n in u||n in We))return!1;if(Ae&&w(pe,t));else if(Se&&w(me,t));else{if(!_e[t]||Ee[t])return!1;if(Ge[t]);else if(w(ve,g(n,ye,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!He[e])if(je&&!w(he,g(n,ye,"")));else if(n)return!1}return!0},rt=function(e){var t=void 0,o=void 0,i=void 0,a=void 0,u=void 0;et("beforeSanitizeAttributes",e,null);var c=e.attributes;if(c){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_e};for(u=c.length;u--;){var l=t=c[u],m=l.name,v=l.namespaceURI;if(o=_(t.value),i=y(m),s.attrName=i,s.attrValue=o,s.keepAttr=!0,s.forceKeepAttr=void 0,et("uponSanitizeAttribute",e,s),o=s.attrValue,!s.forceKeepAttr){if("name"===i&&"IMG"===e.nodeName&&c.id)a=c.id,c=h(c,[]),Qe("id",e),Qe(m,e),f(c,a)>u&&e.setAttribute("id",a.value);else{if("INPUT"===e.nodeName&&"type"===i&&"file"===o&&s.keepAttr&&(_e[i]||!Ee[i]))continue;"id"===m&&e.setAttribute(m,""),Qe(m,e)}if(s.keepAttr)if(ke&&w(/\/>/i,o))Qe(m,e);else if(w(/svg|math/i,e.namespaceURI)&&w(O("</("+d(r(qe),"|")+")","i"),o))Qe(m,e);else{Te&&(o=g(o,fe," "),o=g(o,de," "));var b=e.nodeName.toLowerCase();if(nt(b,i,o))try{v?e.setAttributeNS(v,m,o):e.setAttribute(m,o),p(n.removed)}catch(e){}}}}et("afterSanitizeAttributes",e,null)}},ot=function e(t){var n=void 0,r=Je(t);for(et("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)et("uponSanitizeShadowNode",n,null),tt(n)||(n.content instanceof c&&e(n.content),rt(n));et("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,r){var o=void 0,a=void 0,u=void 0,s=void 0,l=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Ze(e)){if("function"!=typeof e.toString)throw E("toString is not a function");if("string"!=typeof(e=e.toString()))throw E("dirty is not a string, aborting")}if(!n.isSupported){if("object"===z(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Ze(e))return t.toStaticHTML(e.outerHTML)}return e}if(xe||Ve(r),n.removed=[],"string"==typeof e&&(Fe=!1),Fe);else if(e instanceof S)1===(a=(o=Ye("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!Ce&&!Te&&!Pe&&-1===e.indexOf("<"))return te&&Ie?te.createHTML(e):e;if(!(o=Ye(e)))return Ce?null:ne}o&&Ne&&Ke(o.firstChild);for(var f=Je(Fe?e:o);u=f.nextNode();)3===u.nodeType&&u===s||tt(u)||(u.content instanceof c&&ot(u.content),rt(u),s=u);if(s=null,Fe)return e;if(Ce){if(Me)for(l=ue.call(o.ownerDocument);o.firstChild;)l.appendChild(o.firstChild);else l=o;return De&&(l=ce.call(i,l,!0)),l}var d=Pe?o.outerHTML:o.innerHTML;return Te&&(d=g(d,fe," "),d=g(d,de," ")),te&&Ie?te.createHTML(d):d},n.setConfig=function(e){Ve(e),xe=!0},n.clearConfig=function(){$e=null,xe=!1},n.isValidAttribute=function(e,t,n){$e||Ve({});var r=y(e),o=y(t);return nt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(le[e]=le[e]||[],m(le[e],t))},n.removeHook=function(e){le[e]&&p(le[e])},n.removeHooks=function(e){le[e]&&(le[e]=[])},n.removeAllHooks=function(){le={}},n}()},"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof e&&e.amd?e(o):(r=r||self).DOMPurify=o()}).call(this,void 0)},{}],3:[function(e,t,n){
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
"use strict";var r=/["'&<>]/;t.exports=function(e){var t,n=""+e,o=r.exec(n);if(!o)return n;var i="",a=0,u=0;for(a=o.index;a<n.length;a++){switch(n.charCodeAt(a)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}u!==a&&(i+=n.substring(u,a)),u=a+1,i+=t}return u!==a?i+n.substring(u,a):i}},{}],4:[function(e,t,n){"use strict";var r=/[|\\{}()[\]^$+*?.]/g;t.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(r,"\\$&")}},{}],5:[function(e,t,n){(function(e){var r;r=function(){"use strict";function e(e){var t=!0,n=!1,r=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function i(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function a(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function u(e){t=!1}function c(){document.addEventListener("mousemove",s),document.addEventListener("mousedown",s),document.addEventListener("mouseup",s),document.addEventListener("pointermove",s),document.addEventListener("pointerdown",s),document.addEventListener("pointerup",s),document.addEventListener("touchmove",s),document.addEventListener("touchstart",s),document.addEventListener("touchend",s)}function s(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(t=!1,document.removeEventListener("mousemove",s),document.removeEventListener("mousedown",s),document.removeEventListener("mouseup",s),document.removeEventListener("pointermove",s),document.removeEventListener("pointerdown",s),document.removeEventListener("pointerup",s),document.removeEventListener("touchmove",s),document.removeEventListener("touchstart",s),document.removeEventListener("touchend",s))}document.addEventListener("keydown",(function(n){n.metaKey||n.altKey||n.ctrlKey||(i(e.activeElement)&&a(e.activeElement),t=!0)}),!0),document.addEventListener("mousedown",u,!0),document.addEventListener("pointerdown",u,!0),document.addEventListener("touchstart",u,!0),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&(n&&(t=!0),c())}),!0),c(),e.addEventListener("focus",(function(e){var n,r,u;i(e.target)&&(t||(r=(n=e.target).type,"INPUT"===(u=n.tagName)&&o[r]&&!n.readOnly||"TEXTAREA"===u&&!n.readOnly||n.isContentEditable))&&a(e.target)}),!0),e.addEventListener("blur",(function(e){var t;i(e.target)&&(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(r),r=window.setTimeout((function(){n=!1}),100),(t=e.target).hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added")))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if("undefined"!=typeof window&&"undefined"!=typeof document){var t;window.applyFocusVisiblePolyfill=e;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){(t=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}"undefined"!=typeof document&&e(document)},"object"==typeof n&&void 0!==t?r():"function"==typeof e&&e.amd?e(r):r()}).call(this,void 0)},{}],6:[function(e,t,n){(function(e){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt,u="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),l=Object.prototype.toString,f=Math.max,d=Math.min,p=function(){return s.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==l.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var u=o.test(e);return u||i.test(e)?a(e.slice(2),u?2:8):r.test(e)?NaN:+e}t.exports=function(e,t,n){var r,o,i,a,u,c,s=0,l=!1,y=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=r,i=o;return r=o=void 0,s=t,a=e.apply(i,n)}function b(e){return s=e,u=setTimeout(w,t),l?g(e):a}function _(e){var n=e-c;return void 0===c||n>=t||n<0||y&&e-s>=i}function w(){var e=p();if(_(e))return O(e);u=setTimeout(w,function(e){var n=t-(e-c);return y?d(n,i-(e-s)):n}(e))}function O(e){return u=void 0,v&&r?g(e):(r=o=void 0,a)}function E(){var e=p(),n=_(e);if(r=arguments,o=this,c=e,n){if(void 0===u)return b(c);if(y)return u=setTimeout(w,t),g(c)}return void 0===u&&(u=setTimeout(w,t)),a}return t=h(t)||0,m(n)&&(l=!!n.leading,i=(y="maxWait"in n)?f(h(n.maxWait)||0,t):i,v="trailing"in n?!!n.trailing:v),E.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},E.flush=function(){return void 0===u?a:O(p())},E}}).call(this,window)},{}],7:[function(e,t,n){var r,o,i,a,u,c,s,l={},f=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(e,t){for(var n in t)e[n]=t[n];return e}function m(e){var t=e.parentNode;t&&t.removeChild(e)}function h(e,t,n){var r,o,i,a=arguments,u={};for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:u[i]=t[i];if(arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(a[i]);if(null!=n&&(u.children=n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===u[i]&&(u[i]=e.defaultProps[i]);return y(e,u,r,o,null)}function y(e,t,n,o,i){var a={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i};return null==i&&(a.__v=a),null!=r.vnode&&r.vnode(a),a}function v(e){return e.children}function g(e,t){this.props=e,this.context=t}function b(e,t){if(null==t)return e.__?b(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?b(e):null}function _(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return _(e)}}function w(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!O.__r++||u!==r.debounceRendering)&&((u=r.debounceRendering)||a)(O)}function O(){for(var e;O.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,n,r,o,i,a,u;e.__d&&(a=(i=(t=e).__v).__e,(u=t.__P)&&(n=[],(r=p({},i)).__v=r,o=P(u,i,r,t.__n,void 0!==u.ownerSVGElement,null,n,null==a?b(i):a),x(n,i),o!=a&&_(i)))}))}function E(e,t,n,r,o,i,a,u,c,s){var d,p,h,g,_,w,O,E=r&&r.__k||f,A=E.length;for(c==l&&(c=null!=a?a[0]:A?b(r,0):null),n.__k=[],d=0;d<t.length;d++)if(null!=(g=n.__k[d]=null==(g=t[d])||"boolean"==typeof g?null:"string"==typeof g||"number"==typeof g?y(null,g,null,null,g):Array.isArray(g)?y(v,{children:g},null,null,null):null!=g.__e||null!=g.__c?y(g.type,g.props,g.key,null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(h=E[d])||h&&g.key==h.key&&g.type===h.type)E[d]=void 0;else for(p=0;p<A;p++){if((h=E[p])&&g.key==h.key&&g.type===h.type){E[p]=void 0;break}h=null}_=P(e,g,h=h||l,o,i,a,u,c,s),(p=g.ref)&&h.ref!=p&&(O||(O=[]),h.ref&&O.push(h.ref,null,g),O.push(p,g.__c||_,g)),null!=_?(null==w&&(w=_),c=S(e,g,h,E,a,_,c),s||"option"!=n.type?"function"==typeof n.type&&(n.__d=c):e.value=""):c&&h.__e==c&&c.parentNode!=e&&(c=b(h))}if(n.__e=w,null!=a&&"function"!=typeof n.type)for(d=a.length;d--;)null!=a[d]&&m(a[d]);for(d=A;d--;)null!=E[d]&&M(E[d],E[d]);if(O)for(d=0;d<O.length;d++)C(O[d],O[++d],O[++d])}function S(e,t,n,r,o,i,a){var u,c,s;if(void 0!==t.__d)u=t.__d,t.__d=void 0;else if(o==n||i!=a||null==i.parentNode)e:if(null==a||a.parentNode!==e)e.appendChild(i),u=null;else{for(c=a,s=0;(c=c.nextSibling)&&s<r.length;s+=2)if(c==i)break e;e.insertBefore(i,a),u=a}return void 0!==u?u:i.nextSibling}function A(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||d.test(t)?n:n+"px"}function j(e,t,n,r,o){var i,a;if(o&&"className"==t&&(t="class"),"style"===t)if("string"==typeof n)e.style=n;else{if("string"==typeof r&&(e.style=r=""),r)for(t in r)n&&t in n||A(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||A(e.style,t,n[t])}else"o"===t[0]&&"n"===t[1]?(i=t!==(t=t.replace(/Capture$/,"")),(a=t.toLowerCase())in e&&(t=a),t=t.slice(2),e.l||(e.l={}),e.l[t]=n,n?r||e.addEventListener(t,k,i):e.removeEventListener(t,k,i)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function k(e){this.l[e.type](r.event?r.event(e):e)}function T(e,t,n){var r,o;for(r=0;r<e.__k.length;r++)(o=e.__k[r])&&(o.__=e,o.__e&&("function"==typeof o.type&&o.__k.length>1&&T(o,t,n),t=S(n,o,o,e.__k,null,o.__e,t),"function"==typeof e.type&&(e.__d=t)))}function P(e,t,n,o,i,a,u,c,s){var l,f,d,m,h,y,b,_,w,O,S,A=t.type;if(void 0!==t.constructor)return null;(l=r.__b)&&l(t);try{e:if("function"==typeof A){if(_=t.props,w=(l=A.contextType)&&o[l.__c],O=l?w?w.props.value:l.__:o,n.__c?b=(f=t.__c=n.__c).__=f.__E:("prototype"in A&&A.prototype.render?t.__c=f=new A(_,O):(t.__c=f=new g(_,O),f.constructor=A,f.render=D),w&&w.sub(f),f.props=_,f.state||(f.state={}),f.context=O,f.__n=o,d=f.__d=!0,f.__h=[]),null==f.__s&&(f.__s=f.state),null!=A.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=p({},f.__s)),p(f.__s,A.getDerivedStateFromProps(_,f.__s))),m=f.props,h=f.state,d)null==A.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==A.getDerivedStateFromProps&&_!==m&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(_,O),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(_,f.__s,O)||t.__v===n.__v){f.props=_,f.state=f.__s,t.__v!==n.__v&&(f.__d=!1),f.__v=t,t.__e=n.__e,t.__k=n.__k,f.__h.length&&u.push(f),T(t,c,e);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(_,f.__s,O),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(m,h,y)}))}f.context=O,f.props=_,f.state=f.__s,(l=r.__r)&&l(t),f.__d=!1,f.__v=t,f.__P=e,l=f.render(f.props,f.state,f.context),f.state=f.__s,null!=f.getChildContext&&(o=p(p({},o),f.getChildContext())),d||null==f.getSnapshotBeforeUpdate||(y=f.getSnapshotBeforeUpdate(m,h)),S=null!=l&&l.type==v&&null==l.key?l.props.children:l,E(e,Array.isArray(S)?S:[S],t,n,o,i,a,u,c,s),f.base=t.__e,f.__h.length&&u.push(f),b&&(f.__E=f.__=null),f.__e=!1}else null==a&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=N(n.__e,t,n,o,i,a,u,s);(l=r.diffed)&&l(t)}catch(e){t.__v=null,r.__e(e,t,n)}return t.__e}function x(e,t){r.__c&&r.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){r.__e(e,t.__v)}}))}function N(e,t,n,r,o,i,a,u){var c,s,d,p,m,h=n.props,y=t.props;if(o="svg"===t.type||o,null!=i)for(c=0;c<i.length;c++)if(null!=(s=i[c])&&((null===t.type?3===s.nodeType:s.localName===t.type)||e==s)){e=s,i[c]=null;break}if(null==e){if(null===t.type)return document.createTextNode(y);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,y.is&&{is:y.is}),i=null,u=!1}if(null===t.type)h!==y&&e.data!==y&&(e.data=y);else{if(null!=i&&(i=f.slice.call(e.childNodes)),d=(h=n.props||l).dangerouslySetInnerHTML,p=y.dangerouslySetInnerHTML,!u){if(null!=i)for(h={},m=0;m<e.attributes.length;m++)h[e.attributes[m].name]=e.attributes[m].value;(p||d)&&(p&&d&&p.__html==d.__html||(e.innerHTML=p&&p.__html||""))}(function(e,t,n,r,o){var i;for(i in n)"children"===i||"key"===i||i in t||j(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||j(e,i,t[i],n[i],r)})(e,y,h,o,u),p?t.__k=[]:(c=t.props.children,E(e,Array.isArray(c)?c:[c],t,n,r,"foreignObject"!==t.type&&o,i,a,l,u)),u||("value"in y&&void 0!==(c=y.value)&&c!==e.value&&j(e,"value",c,h.value,!1),"checked"in y&&void 0!==(c=y.checked)&&c!==e.checked&&j(e,"checked",c,h.checked,!1))}return e}function C(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,n)}}function M(e,t,n){var o,i,a;if(r.unmount&&r.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||C(o,null,t)),n||"function"==typeof e.type||(n=null!=(i=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){r.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(a=0;a<o.length;a++)o[a]&&M(o[a],t,n);null!=i&&m(i)}function D(e,t,n){return this.constructor(e,n)}function I(e,t,n){var o,i,a;r.__&&r.__(e,t),i=(o=n===c)?null:n&&n.__k||t.__k,e=h(v,null,[e]),a=[],P(t,(o?t:n||t).__k=e,i||l,l,void 0!==t.ownerSVGElement,n&&!o?[n]:i?null:t.childNodes.length?f.slice.call(t.childNodes):null,a,n||l,o),x(a,e)}r={__e:function(e,t){for(var n,r;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(r=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(r=!0,n.componentDidCatch(e)),r)return w(n.__E=n)}catch(t){e=t}throw e}},o=function(e){return null!=e&&void 0===e.constructor},g.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(p({},n),this.props)),e&&p(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),w(this))},g.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),w(this))},g.prototype.render=v,i=[],a="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,O.__r=0,c=l,s=0,n.render=I,n.hydrate=function(e,t){I(e,t,c)},n.createElement=h,n.h=h,n.Fragment=v,n.createRef=function(){return{current:null}},n.isValidElement=o,n.Component=g,n.cloneElement=function(e,t,n){var r,o,i,a=arguments,u=p({},e.props);for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:u[i]=t[i];if(arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(a[i]);return null!=n&&(u.children=n),y(e.type,u,r||e.key,o||e.ref,null)},n.createContext=function(e,t){var n={__c:t="__cC"+s++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e,n,r){return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(w)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n},n.toChildArray=function e(t,n){return n=n||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){e(t,n)})):n.push(t)),n},n.__u=M,n.options=r},{}],8:[function(e,t,n){var r,o,i,a=e("preact"),u=0,c=[],s=a.options.__r,l=a.options.diffed,f=a.options.__c,d=a.options.unmount;function p(e,t){a.options.__h&&a.options.__h(o,e,u||t),u=0;var n=o.__H||(o.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function m(e){return u=1,h(E,e)}function h(e,t,n){var i=p(r++,2);return i.t=e,i.__c||(i.__c=o,i.__=[n?n(t):E(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}]),i.__}function y(e,t){var n=p(r++,4);!a.options.__s&&O(n.__H,t)&&(n.__=e,n.__H=t,o.__h.push(n))}function v(e,t){var n=p(r++,7);return O(n.__H,t)?(n.__H=t,n.__h=e,n.__=e()):n.__}function g(){c.some((function(e){if(e.__P)try{e.__H.__h.forEach(_),e.__H.__h.forEach(w),e.__H.__h=[]}catch(t){return e.__H.__h=[],a.options.__e(t,e.__v),!0}})),c=[]}a.options.__r=function(e){s&&s(e),r=0;var t=(o=e.__c).__H;t&&(t.__h.forEach(_),t.__h.forEach(w),t.__h=[])},a.options.diffed=function(e){l&&l(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==c.push(t)&&i===a.options.requestAnimationFrame||((i=a.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),b&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);b&&(t=requestAnimationFrame(n))})(g))},a.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(_),e.__h=e.__h.filter((function(e){return!e.__||w(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],a.options.__e(n,e.__v)}})),f&&f(e,t)},a.options.unmount=function(e){d&&d(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(_)}catch(e){a.options.__e(e,t.__v)}};var b="function"==typeof requestAnimationFrame;function _(e){"function"==typeof e.u&&e.u()}function w(e){e.u=e.__()}function O(e,t){return!e||t.some((function(t,n){return t!==e[n]}))}function E(e,t){return"function"==typeof t?t(e):t}n.useState=m,n.useReducer=h,n.useEffect=function(e,t){var n=p(r++,3);!a.options.__s&&O(n.__H,t)&&(n.__=e,n.__H=t,o.__H.__h.push(n))},n.useLayoutEffect=y,n.useRef=function(e){return u=5,v((function(){return{current:e}}),[])},n.useImperativeHandle=function(e,t,n){u=6,y((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},n.useMemo=v,n.useCallback=function(e,t){return u=8,v((function(){return e}),t)},n.useContext=function(e){var t=o.context[e.__c],n=p(r++,9);return n.__c=e,t?(null==n.__&&(n.__=!0,t.sub(o)),t.props.value):e.__},n.useDebugValue=function(e,t){a.options.useDebugValue&&a.options.useDebugValue(t?t(e):e)},n.useErrorBoundary=function(e){var t=p(r++,10),n=m();return t.__=e,o.componentDidCatch||(o.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}},{preact:7}],9:[function(e,t,n){"use strict";var r=e("./lib/ReactPropTypesSecret");function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},{"./lib/ReactPropTypesSecret":11}],10:[function(e,t,n){t.exports=e("./factoryWithThrowingShims")()},{"./factoryWithThrowingShims":9}],11:[function(e,t,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}],12:[function(e,t,n){"use strict";var r=e("strict-uri-encode");n.extract=function(e){return e.split("?")[1]||""},n.parse=function(e){return"string"!=typeof e?{}:(e=e.trim().replace(/^(\?|#|&)/,""))?e.split("&").reduce((function(e,t){var n=t.replace(/\+/g," ").split("="),r=n.shift(),o=n.length>0?n.join("="):void 0;return r=decodeURIComponent(r),o=void 0===o?null:decodeURIComponent(o),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]:e[r]=o,e}),{}):{}},n.stringify=function(e){return e?Object.keys(e).sort().map((function(t){var n=e[t];return void 0===n?"":null===n?t:Array.isArray(n)?n.slice().sort().map((function(e){return r(t)+"="+r(e)})).join("&"):r(t)+"="+r(n)})).filter((function(e){return e.length>0})).join("&"):""}},{"strict-uri-encode":21}],13:[function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}n.__esModule=!0;var o=r();o.withExtraArgument=r,n.default=o},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=(r=e("symbol-observable"))&&"object"==typeof r&&"default"in r?r.default:r,i=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function u(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function c(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function s(e,t){return function(){return t(e.apply(this,arguments))}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}n.__DO_NOT_USE__ActionTypes=a,n.applyMiddleware=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return d({},n,{dispatch:r=p.apply(void 0,i)(n.dispatch)})}}},n.bindActionCreators=function(e,t){if("function"==typeof e)return s(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in e){var o=e[r];"function"==typeof o&&(n[r]=s(o,t))}return n},n.combineReducers=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var i,u=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:a.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},a=0;a<u.length;a++){var s=u[a],l=n[s],f=e[s],d=l(f,t);if(void 0===d){var p=c(s,t);throw new Error(p)}o[s]=d,r=r||d!==f}return(r=r||u.length!==Object.keys(e).length)?o:e}},n.compose=p,n.createStore=function e(t,n,r){var i;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,s=n,l=[],f=l,d=!1;function p(){f===l&&(f=l.slice())}function m(){if(d)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return s}function h(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(d)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return p(),f.push(e),function(){if(t){if(d)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,p();var n=f.indexOf(e);f.splice(n,1),l=null}}}function y(e){if(!u(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw new Error("Reducers may not dispatch actions.");try{d=!0,s=c(s,e)}finally{d=!1}for(var t=l=f,n=0;n<t.length;n++)(0,t[n])();return e}function v(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,y({type:a.REPLACE})}function g(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(m())}return n(),{unsubscribe:t(n)}}})[o]=function(){return this},e}return y({type:a.INIT}),(i={dispatch:y,subscribe:h,getState:m,replaceReducer:v})[o]=g,i}},{"symbol-observable":22}],15:[function(e,t,n){"use strict";function r(e,t){return e===t}function o(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,i=null;return function(){return o(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}function a(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function u(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=0,u=r.pop(),c=a(r),s=e.apply(void 0,[function(){return i++,u.apply(null,arguments)}].concat(n)),l=e((function(){for(var e=[],t=c.length,n=0;n<t;n++)e.push(c[n].apply(null,arguments));return s.apply(null,e)}));return l.resultFunc=u,l.dependencies=c,l.recomputations=function(){return i},l.resetRecomputations=function(){return i=0},l}}n.__esModule=!0,n.defaultMemoize=i,n.createSelectorCreator=u,n.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t,r){return e[n[r]]=t,e}),{})}))};var c=n.createSelector=u(i)},{}],16:[function(e,t,n){t.exports=e("./lib/retry")},{"./lib/retry":17}],17:[function(e,t,n){var r=e("./retry_operation");n.operation=function(e){var t=n.timeouts(e);return new r(t,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},n.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<t.retries;o++)r.push(this.createTimeout(o,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(o,t)),r.sort((function(e,t){return e-t})),r},n.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return Math.min(r,t.maxTimeout)},n.wrap=function(e,t,r){if(t instanceof Array&&(r=t,t=null),!r)for(var o in r=[],e)"function"==typeof e[o]&&r.push(o);for(var i=0;i<r.length;i++){var a=r[i],u=e[a];e[a]=function(r){var o=n.operation(t),i=Array.prototype.slice.call(arguments,1),a=i.pop();i.push((function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),a.apply(this,arguments))})),o.attempt((function(){r.apply(e,i)}))}.bind(e,u),e[a].options=t}}},{"./retry_operation":18}],18:[function(e,t,n){function r(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=r,r.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var r=this,o=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n);return this._options.unref&&o.unref(),!0},r.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},r.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},r.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],i=o.message,a=(e[i]||0)+1;e[i]=a,a>=n&&(t=o,n=a)}return t}},{}],19:[function(e,t,n){var r="complete",o="canceled";function i(e,t,n){e.self===e?e.scrollTo(t,n):(e.scrollLeft=t,e.scrollTop=n)}function a(e){var t=e._scrollSettings;if(t){var n=t.maxSynchronousAlignments,o=function(e,t){var n,r,o,i,a,u,c,s=e.align,l=e.target.getBoundingClientRect(),f=s&&null!=s.left?s.left:.5,d=s&&null!=s.top?s.top:.5,p=s&&null!=s.leftOffset?s.leftOffset:0,m=s&&null!=s.topOffset?s.topOffset:0,h=f,y=d;if(e.isWindow(t))u=Math.min(l.width,t.innerWidth),c=Math.min(l.height,t.innerHeight),r=l.left+t.pageXOffset-t.innerWidth*h+u*h,o=l.top+t.pageYOffset-t.innerHeight*y+c*y,o-=m,i=(r-=p)-t.pageXOffset,a=o-t.pageYOffset;else{u=l.width,c=l.height,n=t.getBoundingClientRect();var v=l.left-(n.left-t.scrollLeft),g=l.top-(n.top-t.scrollTop);r=v+u*h-t.clientWidth*h,o=g+c*y-t.clientHeight*y,r-=p,o-=m,r=Math.max(Math.min(r,t.scrollWidth-t.clientWidth),0),o=Math.max(Math.min(o,t.scrollHeight-t.clientHeight),0),i=r-t.scrollLeft,a=o-t.scrollTop}return{x:r,y:o,differenceX:i,differenceY:a}}(t,e),u=Date.now()-t.startTime,c=Math.min(1/t.time*u,1);if(t.endIterations>=n)return i(e,o.x,o.y),e._scrollSettings=null,t.end(r);var s=1-t.ease(c);if(i(e,o.x-o.differenceX*s,o.y-o.differenceY*s),u>=t.time)return t.endIterations++,a(e);!function(e){if("requestAnimationFrame"in window)return window.requestAnimationFrame(e);setTimeout(e,16)}(a.bind(null,e))}}function u(e){return e.self===e}function c(e,t,n,r){var i,c=!t._scrollSettings,s=t._scrollSettings,l=Date.now(),f={passive:!0};function d(e){t._scrollSettings=null,t.parentElement&&t.parentElement._scrollSettings&&t.parentElement._scrollSettings.end(e),n.debug&&console.log("Scrolling ended with type",e,"for",t),r(e),i&&(t.removeEventListener("touchstart",i,f),t.removeEventListener("wheel",i,f))}s&&s.end(o);var p=n.maxSynchronousAlignments;return null==p&&(p=3),t._scrollSettings={startTime:l,endIterations:0,target:e,time:n.time,ease:n.ease,align:n.align,isWindow:n.isWindow||u,maxSynchronousAlignments:p,end:d},"cancellable"in n&&!n.cancellable||(i=d.bind(null,o),t.addEventListener("touchstart",i,f),t.addEventListener("wheel",i,f)),c&&a(t),i}function s(e){return"pageXOffset"in e||(e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth)&&"hidden"!==getComputedStyle(e).overflow}function l(){return!0}function f(e){if(e.assignedSlot)return f(e.assignedSlot);if(e.parentElement)return"BODY"===e.parentElement.tagName?e.parentElement.ownerDocument.defaultView||e.parentElement.ownerDocument.ownerWindow:e.parentElement;if(e.getRootNode){var t=e.getRootNode();if(11===t.nodeType)return t.host}}t.exports=function(e,t,n){if(e){"function"==typeof t&&(n=t,t=null),t||(t={}),t.time=isNaN(t.time)?1e3:t.time,t.ease=t.ease||function(e){return 1-Math.pow(1-e,e/2)};var o,i=f(e),a=1,u=t.validTarget||l,d=t.isScrollable;for(t.debug&&(console.log("About to scroll to",e),i||console.error("Target did not have a parent, is it mounted in the DOM?"));i;)if(t.debug&&console.log("Scrolling parent node",i),u(i,a)&&(d?d(i,s):s(i))&&(a++,o=c(e,i,t,p)),!(i=f(i))){p(r);break}return o}function p(e){--a||n&&n(e)}}},{}],20:[function(e,t,n){t.exports=function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var u=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var s=i[c];if(!u(s))return!1;var l=e[s],f=t[s];if(!1===(o=n?n.call(r,l,f,s):void 0)||void 0===o&&l!==f)return!1}return!0}},{}],21:[function(e,t,n){"use strict";t.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},{}],22:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i,a=e("./ponyfill.js"),u=(i=a)&&i.__esModule?i:{default:i};o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==t?t:Function("return this")();var c=(0,u.default)(o);n.default=c}).call(this,window)},{"./ponyfill.js":23}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}},{}],24:[function(e,t,n){function r(){}r.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},t.exports=r,t.exports.TinyEmitter=r},{}],25:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--plus"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8V3v5H3h5zm0 0v5-5h5-5z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],26:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"/>\n</svg>\n'},{}],27:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-left"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12L3 8l4-4M4 8h9-9z"></path></g></svg>\n'},{}],28:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 4l4 4-4 4m3-4H3h9z"></path></g></svg>\n'},{}],29:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cancel"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8l3.536-3.536L8 8 4.464 4.464 8 8zm0 0l-3.536 3.536L8 8l3.536 3.536L8 8z"></path></g></svg>\n'},{}],30:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--caret-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4l4 4-4 4"></path></g></svg>\n'},{}],31:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-std"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.985 0c2.238 0 4.143.781 5.715 2.343a7.694 7.694 0 011.714 2.579C15.804 5.888 16 6.914 16 8a8.164 8.164 0 01-.579 3.078 7.344 7.344 0 01-1.707 2.536 8.222 8.222 0 01-2.657 1.772c-.99.41-2.014.614-3.071.614a7.775 7.775 0 01-3.036-.607 8.047 8.047 0 01-2.6-1.757A7.846 7.846 0 010 8c0-1.057.202-2.074.607-3.05A8.033 8.033 0 012.371 2.33C3.895.777 5.766 0 7.985 0zm.03 1.443c-1.83 0-3.367.638-4.615 1.914a6.878 6.878 0 00-1.45 2.15A6.301 6.301 0 001.443 8c0 .858.168 1.684.507 2.479a6.627 6.627 0 001.45 2.129 6.593 6.593 0 002.129 1.428c.79.329 1.619.493 2.485.493.857 0 1.688-.166 2.494-.5a6.91 6.91 0 002.178-1.442c1.247-1.22 1.871-2.748 1.871-4.586a6.57 6.57 0 00-.486-2.515 6.397 6.397 0 00-1.413-2.114C11.37 2.086 9.824 1.443 8.014 1.443zm-.1 5.229l-1.073.557c-.114-.238-.254-.405-.42-.5a.95.95 0 00-.465-.143c-.714 0-1.072.472-1.072 1.415 0 .428.09.77.271 1.028.181.257.448.386.8.386.467 0 .796-.229.987-.686l.985.5a2.35 2.35 0 01-2.1 1.257c-.714 0-1.29-.218-1.729-.657-.438-.438-.657-1.047-.657-1.828 0-.762.222-1.367.665-1.814.442-.448 1.002-.672 1.678-.672.991 0 1.7.385 2.13 1.157zm4.613 0l-1.057.557c-.114-.238-.255-.405-.421-.5a.972.972 0 00-.479-.143c-.714 0-1.072.472-1.072 1.415 0 .428.091.77.272 1.028.18.257.447.386.8.386.466 0 .795-.229.985-.686l1 .5c-.218.39-.514.698-.885.922a2.308 2.308 0 01-1.214.335c-.724 0-1.302-.218-1.735-.657-.434-.438-.65-1.047-.65-1.828 0-.762.22-1.367.664-1.814.442-.448 1.002-.672 1.678-.672.99 0 1.696.385 2.114 1.157z"></path></g></svg>\n'},{}],32:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-zero"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.983 0c2.238 0 4.148.78 5.72 2.342a7.662 7.662 0 011.715 2.582c.39.962.582 1.99.582 3.076a8.13 8.13 0 01-.583 3.087 7.262 7.262 0 01-1.703 2.526 8.213 8.213 0 01-2.655 1.77c-.99.41-2.018.617-3.076.617a7.902 7.902 0 01-3.042-.6 8.301 8.301 0 01-2.6-1.759A8.087 8.087 0 01.6 11.042 7.84 7.84 0 010 8c0-1.057.2-2.07.6-3.042a8.12 8.12 0 011.77-2.633C3.893.772 5.764 0 7.983 0zm.034 1.44c-1.829 0-3.369.64-4.616 1.915a6.962 6.962 0 00-1.457 2.157 6.388 6.388 0 000 4.969 6.83 6.83 0 003.585 3.558c.79.324 1.62.487 2.488.487.857 0 1.681-.165 2.482-.498a6.88 6.88 0 002.184-1.446C13.931 11.364 14.56 9.838 14.56 8a6.57 6.57 0 00-.487-2.515 6.418 6.418 0 00-1.418-2.118C11.37 2.081 9.826 1.44 8.017 1.44zM8 3.395c2.641 0 3.305 2.492 3.305 4.605 0 2.113-.664 4.605-3.305 4.605S4.694 10.113 4.694 8l.007-.355c.073-2.027.804-4.25 3.299-4.25zm1.316 3.227L7.35 10.017c-.274.412-.083.645.219.774l.135.044c.091.022.19.034.297.034 1.357 0 1.422-1.938 1.422-2.869l-.007-.409a7.282 7.282 0 00-.06-.72l-.04-.25zM8 5.132c-1.258 0-1.406 1.66-1.421 2.646L6.577 8c0 .24.005.544.035.865l.027.244 1.759-3.232c.182-.316.09-.542-.101-.706A1.222 1.222 0 008 5.13z"></path></g></svg>\n'},{}],33:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="Icon Icon--check"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 3L6 13 3 8"></path></g></svg>\n'},{}],34:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 4.212a.804.804 0 0 1 1.088 0l6.23 5.867c.301.283.301.742 0 1.025l-.726.684a.804.804 0 0 1-1.087.001L8 7.139l-4.961 4.65a.804.804 0 0 1-1.087-.001l-.727-.684a.695.695 0 0 1 0-1.025l6.23-5.867z"/>\n</svg>'},{}],35:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="16" height="16" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,15.9996,0.000432345)">\n        <path fill="currentColor" d="M7.456,4.212C7.762,3.931 8.238,3.931 8.544,4.212L14.774,10.079C15.075,10.362 15.075,10.821 14.774,11.104L14.048,11.788C13.742,12.069 13.267,12.069 12.961,11.789L8,7.139L3.039,11.789C2.733,12.069 2.258,12.069 1.952,11.788L1.225,11.104C1.081,10.972 0.999,10.786 0.999,10.592C0.999,10.397 1.081,10.211 1.225,10.079L7.455,4.212L7.456,4.212Z" />\n    </g>\n</svg>\n'},{}],36:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--copy"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 15H1V5h3m11-4v10H7V1h8z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],37:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="10px" height="30px" viewBox="0 0 10 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --\x3e\n    <title>Shape</title>\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-239.000000, -73.000000)" fill-rule="nonzero" fill="#000000">\n            <g transform="translate(1.000000, 1.000000)">\n                <path d="M243.3125,75.186875 C243.3125,73.535 243.3125,72.625 246.434687,72.625 L248,72.625 L248,72 L246.434687,72 C244.324375,72 243.402813,72.4684375 243,73.183125 C242.597187,72.4684375 241.675625,72 239.565313,72 L238,72 L238,72.625 L239.565313,72.625 C242.6875,72.6246875 242.6875,73.5346875 242.6875,75.186875 L242.6875,82 L242.6875,86.6875 L240.929375,86.6875 L240.929375,87.3125 L242.6875,87.3125 L242.6875,92 L242.6875,98.5434375 C242.6875,100.187188 242.6875,101.375 239.565313,101.375 L238,101.375 L238,102 L239.565313,102 C241.675625,102 242.5975,101.442813 243,100.6525 C243.402813,101.442813 244.324375,102 246.434687,102 L248,102 L248,101.375 L246.434687,101.375 C243.3125,101.374688 243.3125,100.187188 243.3125,98.5434375 L243.3125,91.9996875 L243.3125,87.3121875 L245.070312,87.3121875 L245.070312,86.6871875 L243.3125,86.6871875 L243.3125,81.9996875 L243.3125,75.186875 Z"></path>\n            </g>\n        </g>\n    </g>\n</svg>\n'},{}],38:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--edit"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4l1 1-9 9-2 1 1-2 9-9zm3-3l1 1-1 1-1-1 1-1z"></path></g></svg>\n'},{}],39:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--email"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 3v10h14V3H1zm0 0l7 6 7-6H1z"></path></g></svg>\n'},{}],40:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 11.788L1.226 5.92a.695.695 0 0 1 0-1.025l.726-.684a.804.804 0 0 1 1.087-.001L8 8.861l4.961-4.65a.804.804 0 0 1 1.087.001l.727.684c.3.283.3.742 0 1.025l-6.23 5.867a.804.804 0 0 1-1.09 0z"/>\n</svg>'},{}],41:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--external"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 3h6v6m-1-5l-9 9 9-9z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],42:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-facebook"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.999 8.049c0-4.445-3.582-8.049-8-8.049S0 3.604 0 8.049C0 12.066 2.925 15.396 6.75 16v-5.624H4.717V8.049H6.75V6.276c0-2.018 1.195-3.132 3.022-3.132.875 0 1.79.157 1.79.157v1.981h-1.008c-.994 0-1.304.62-1.304 1.257v1.51h2.219l-.355 2.327H9.25V16c3.825-.604 6.75-3.934 6.75-7.951z"></path></g></svg>\n'},{}],43:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag-filled"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2 1a1 1 0 01.883-.993L3 0h12c.852 0 1.297.986.783 1.623l-.076.084L12.415 5l3.292 3.293c.575.575.253 1.523-.485 1.684l-.108.017L15 10H4v5a1 1 0 01-1.993.117L2 15V1z"></path></g></svg>\n'},{}],44:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9v6V1h12l-4 4 4 4H3z"></path></g></svg>\n'},{}],45:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-bold"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M8.661 16c.805 0 1.536-.117 2.193-.351a4.953 4.953 0 001.69-.993c.47-.428.831-.947 1.081-1.557s.375-1.287.375-2.03c0-.29-.038-.588-.114-.893a4.123 4.123 0 00-.325-.87 3.937 3.937 0 00-.495-.754 4.412 4.412 0 00-.604-.597c-.17-.126-.17-.264 0-.412.381-.335.699-.772.953-1.311.254-.54.382-1.062.382-1.568 0-.64-.132-1.244-.394-1.813a4.628 4.628 0 00-1.081-1.484c-.458-.42-1-.753-1.627-.999A5.531 5.531 0 008.66 0h-6.14a.534.534 0 00-.362.14A.415.415 0 002 .456v15.086c0 .119.053.225.159.318.106.093.227.139.362.139h6.14zm-.127-9.852H5.826c-.17 0-.254-.075-.254-.223V3.437c0-.157.085-.235.254-.235h2.708c.45 0 .847.145 1.195.435.347.29.521.633.521 1.027 0 .394-.174.74-.521 1.038a1.784 1.784 0 01-1.195.446zm0 6.65H5.826c-.17 0-.254-.075-.254-.223v-2.99c0-.157.085-.235.254-.235h2.708c.56 0 1.004.177 1.335.53.33.353.495.75.495 1.188 0 .454-.165.856-.495 1.205-.33.35-.776.525-1.335.525z"></path></g></svg>\n'},{}],46:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-latex"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M13.392 16c.158 0 .299-.036.423-.108.123-.073.185-.155.185-.248v-1.778c0-.099-.062-.183-.185-.252a.848.848 0 00-.423-.104H6.85c-.138 0-.227-.028-.267-.083-.04-.055-.04-.105 0-.152l5.533-5.101c.158-.14.223-.265.193-.378a.755.755 0 00-.193-.325L6.88 2.707c-.04-.046-.042-.094-.007-.143.034-.05.13-.074.289-.074h6.17a.782.782 0 00.416-.108c.119-.073.178-.155.178-.248V.356c0-.093-.06-.175-.178-.248A.782.782 0 0013.333 0H2.905c-.158 0-.3.036-.423.108-.124.073-.185.155-.185.248v1.943c0 .128.037.236.11.326l.171.204 5.31 4.815c.04.047.065.106.075.178a.221.221 0 01-.074.195l-5.622 5.154c-.04.047-.094.113-.163.2A.512.512 0 002 13.7v1.943c0 .093.062.175.185.248a.822.822 0 00.423.108h10.784z"></path></g></svg>\n'},{}],47:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-italic"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M10.61 16c.12 0 .23-.046.329-.14a.633.633 0 00.191-.317l.457-2.176a.348.348 0 00-.064-.313.336.336 0 00-.276-.133H8.845c-.142-.008-.198-.086-.17-.235l1.892-9.372c.035-.149.124-.223.266-.223H13a.49.49 0 00.335-.14.62.62 0 00.196-.318L13.99.457a.542.542 0 00.011-.1.337.337 0 00-.085-.223.336.336 0 00-.276-.134H5.805a.49.49 0 00-.335.14.62.62 0 00-.196.317l-.457 2.176a.353.353 0 00.069.318c.074.093.168.14.281.14h2.18c.141 0 .198.074.17.223l-1.893 9.372c-.028.156-.113.235-.255.235H2.967a.489.489 0 00-.324.133.59.59 0 00-.197.313l-.435 2.176a.542.542 0 00-.011.1c0 .082.025.156.074.223.071.09.16.134.266.134h8.27z"></path></g></svg>\n'},{}],48:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-ordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.748 11.5c.227 0 .443.034.646.103.203.069.381.164.534.286.155.123.276.267.364.432.089.168.134.35.134.543 0 .17-.042.333-.124.484a1.384 1.384 0 01-.19.269l-.062.061.047.035c.047.041.09.086.13.134l.058.075.075.122c.093.172.14.352.14.538 0 .201-.048.39-.143.566a1.44 1.44 0 01-.384.45c-.16.125-.344.223-.554.294-.21.072-.434.108-.67.108-.237 0-.461-.036-.671-.108a1.871 1.871 0 01-.555-.295 1.42 1.42 0 01-.382-.45 1.178 1.178 0 01-.132-.417L1 14.582l.002-.078.01-.05a.249.249 0 01.077-.111.283.283 0 01.121-.06l.07-.008h.708l.05.007c.044.01.084.028.12.056a.24.24 0 01.089.133l.006.054v.047l.005.077a.279.279 0 00.112.186c.088.066.213.101.378.101a.615.615 0 00.376-.102.29.29 0 00.12-.252.29.29 0 00-.12-.252.538.538 0 00-.262-.096l-.114-.007h-.1l-.051-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.053.001-.57.01-.05a.249.249 0 01.078-.112.283.283 0 01.121-.06l.07-.008h.076l.112-.006a.454.454 0 00.224-.086.26.26 0 00.104-.222.246.246 0 00-.103-.213.533.533 0 00-.329-.09.527.527 0 00-.324.09.24.24 0 00-.098.148l-.006.065-.002.11-.01.05a.249.249 0 01-.081.112.292.292 0 01-.12.059l-.066.007h-.712l-.052-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.054v-.096l.008-.135c.018-.141.062-.275.132-.402.091-.164.213-.307.366-.43.152-.122.33-.217.533-.286.203-.069.418-.103.645-.103zM15 13a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2.777 5.5c.234 0 .454.034.66.101.207.068.389.164.544.288.156.124.28.27.372.437.093.17.14.355.14.551 0 .19-.049.37-.145.542-.07.123-.156.237-.258.34l-.108.1L2.71 8.932l1.52.001.053.006c.044.01.084.029.12.056.047.036.078.08.091.132l.007.054-.002.59-.01.05a.25.25 0 01-.083.113.298.298 0 01-.121.059L4.216 10H1.27l-.053-.007a.298.298 0 01-.122-.059.246.246 0 01-.089-.132L1 9.748v-.711l.004-.05a.26.26 0 01.04-.115l.034-.043.035-.033L3.04 7.167l.036-.036a.98.98 0 00.08-.114.295.295 0 00.055-.145.27.27 0 00-.099-.21c-.068-.062-.167-.094-.303-.094-.163 0-.285.032-.369.093a.244.244 0 00-.103.147l-.006.064-.002.123-.01.052a.25.25 0 01-.084.112.298.298 0 01-.12.058l-.069.008h-.726l-.053-.007a.298.298 0 01-.121-.059.246.246 0 01-.09-.132l-.006-.054V6.87l.01-.137c.017-.143.063-.28.135-.407.094-.167.22-.313.379-.437.157-.123.339-.219.544-.287.206-.067.425-.101.658-.101zM15 7a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM3.237 0l.052.008c.044.01.084.031.12.061a.248.248 0 01.083.132l.006.052-.004 3.167.744.001.051.007c.044.01.084.03.119.058.044.036.074.08.086.132l.006.053-.001.595-.01.05a.278.278 0 01-.197.176l-.07.008H1.29l-.051-.008a.287.287 0 01-.12-.061.248.248 0 01-.084-.132l-.006-.052.001-.596.01-.05a.247.247 0 01.077-.113.28.28 0 01.12-.06l.069-.008.932.002.003-1.959-.796.629-.068.037a.295.295 0 01-.196-.002.25.25 0 01-.172-.179L1 1.881v-.587l.007-.089.015-.075a.345.345 0 01.073-.132l.06-.059.83-.758.04-.036A.994.994 0 012.139.07a.498.498 0 01.183-.062L2.428 0h.809zM15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8z"></path></g></svg>\n'},{}],49:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-unordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8zm0 6a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM2 12a2 2 0 110 4 2 2 0 010-4zm13 1a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2 6a2 2 0 110 4 2 2 0 010-4zm0-6a2 2 0 110 4 2 2 0 010-4z"></path></g></svg>\n'},{}],50:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-quote"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.701 14c.38 0 .659-.085.837-.255.177-.17.328-.343.45-.52l2.408-3.25c.246-.328.445-.725.598-1.19a4.69 4.69 0 00.23-1.475V2.775a.752.752 0 00-.23-.539A.713.713 0 006.47 2H1.947a.713.713 0 00-.524.236.752.752 0 00-.23.539v4.649c0 .214.077.396.23.548a.726.726 0 00.524.226h.901c.123 0 .23.054.322.161.092.107.101.224.028.35l-2.041 3.817c-.196.365-.208.702-.037 1.011.172.309.447.463.827.463h.754zm7.795 0c.367 0 .64-.085.818-.255.178-.17.328-.343.45-.52l2.409-3.25c.257-.328.46-.725.606-1.19A4.87 4.87 0 0015 7.31V2.775a.752.752 0 00-.23-.539.713.713 0 00-.524-.236H9.742a.703.703 0 00-.533.236.767.767 0 00-.22.539v4.649c0 .214.076.396.23.548a.726.726 0 00.523.226h.9c.123 0 .228.054.313.161.086.107.092.224.019.35L8.95 12.526c-.208.365-.223.702-.045 1.011.177.309.456.463.836.463h.754z"></path></g></svg>\n'},{}],51:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--groups"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15a3 3 0 0 1 6 0m2-4a3 3 0 0 1 6 0M4 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8-4a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],52:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--help"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4c0-1.657 1.79-3 4-3s4 1.343 4 3-1.79 3-4 3m0 0v2-2zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],53:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15H1h11zm-.5-6v2l-1 1v-2l1-1zm.5-7v6h-2V2h2zm0-1h-2 2zm0 8h-2 2z"></path></g></svg>\n'},{}],54:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--image"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 1v14H1V1h14zM1 15l3-8 4 6 3-4 4 6m-4-9a1 1 0 110-2 1 1 0 010 2z"></path></g></svg>\n'},{}],55:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm0 14.452A6.45 6.45 0 0 0 14.452 8 6.45 6.45 0 0 0 8 1.548 6.45 6.45 0 0 0 1.548 8 6.45 6.45 0 0 0 8 14.452zm3.284-8.458L9.277 8l2.007 2.006a.387.387 0 0 1 0 .549l-.73.729a.387.387 0 0 1-.548 0L8 9.277l-2.006 2.007a.387.387 0 0 1-.549 0l-.729-.73a.387.387 0 0 1 0-.548L6.723 8 4.716 5.994a.387.387 0 0 1 0-.549l.73-.729a.387.387 0 0 1 .548 0L8 6.723l2.006-2.007a.387.387 0 0 1 .549 0l.729.73a.387.387 0 0 1 0 .548z"/>\n</svg>'},{}],56:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--link"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.069 3.042l1.057-1.274c1.193-1.106 3.035-.938 4.046 0 1.012.94 1.193 2.649 0 3.755L11.046 9.17m0 0c-1.193 1.107-2.853 1.107-4.046 0m-.069 3.788l-1.057 1.274c-1.193 1.106-3.035.938-4.046 0-1.012-.94-1.193-2.649 0-3.755L4.954 6.83m0 0C6.147 5.723 7.807 5.723 9 6.8"></path></g></svg>\n'},{}],57:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="48px" height="56px" viewBox="0 0 48 56" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g fill="currentColor">\n            <rect x="0" y="24" width="48" height="32"></rect>\n            <path d="M24,0 C24,0 8,0 8,16 L8,32 L16,32 L16,16.0000004 C16,8 24,8 24,8 C24,8 32,8 32,16 L32,32 L40,32 L40,16 C40,0 24,0 24,0 Z"></path>\n        </g>\n    </g>\n</svg>\n'},{}],58:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="24px" height="28px" viewBox="0 0 24 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <rect fill="#ffffff" stroke="none" width="17.14407" height="16.046612" x="3.8855932" y="3.9449153" />\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M0,2.00494659 C0,0.897645164 0.897026226,0 2.00494659,0 L21.9950534,0 C23.1023548,0 24,0.897026226 24,2.00494659 L24,21.9950534 C24,23.1023548 23.1029738,24 21.9950534,24 L2.00494659,24 C0.897645164,24 0,23.1029738 0,21.9950534 L0,2.00494659 Z M9,24 L12,28 L15,24 L9,24 Z M7.00811294,4 L4,4 L4,20 L7.00811294,20 L7.00811294,15.0028975 C7.00811294,12.004636 8.16824717,12.0097227 9,12 C10,12.0072451 11.0189302,12.0606714 11.0189302,14.003477 L11.0189302,20 L14.0270431,20 L14.0270431,13.1087862 C14.0270433,10 12,9.00309038 10,9.00309064 C8.01081726,9.00309091 8,9.00309086 7.00811294,11.0019317 L7.00811294,4 Z M19,19.9869002 C20.1045695,19.9869002 21,19.0944022 21,17.9934501 C21,16.892498 20.1045695,16 19,16 C17.8954305,16 17,16.892498 17,17.9934501 C17,19.0944022 17.8954305,19.9869002 19,19.9869002 Z" fill="currentColor"></path>\n    </g>\n</svg>\n'},{}],59:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="15" height="8" viewBox="0 0 15 8" aria-hidden="true" focusable="false"><path d="M0 8 L7 0 L15 8" stroke="currentColor" strokeWidth="2" /></svg>\n'},{}],60:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--profile"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15c0-2.761 3.134-5 7-5s7 2.239 7 5M8 7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"></path></g></svg>\n'},{}],61:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm2.655 11.535c.244-.242.442-.719.442-1.063a1.13 1.13 0 0 0-.288-.696l-.442-.442a1.033 1.033 0 0 0-.73-.302H7.484C7.181 8.88 6.791 8 6.452 8c-.34 0-.674-.08-.978-.231l-.357-.179a.386.386 0 0 1-.213-.345c0-.153.118-.317.263-.366l1.006-.335a.618.618 0 0 1 .163-.026c.106 0 .258.056.338.126l.3.26c.046.04.106.063.169.063h.182a.258.258 0 0 0 .23-.373l-.503-1.006a.306.306 0 0 1-.027-.116c0-.06.035-.143.078-.185l.32-.31a.258.258 0 0 1 .18-.074h.29c.06 0 .141-.034.183-.076l.258-.258c.1-.1.1-.264 0-.364l-.151-.152c-.101-.1-.101-.264 0-.365l.333-.333.151-.151a.516.516 0 0 0 0-.73l-.912-.913a6.45 6.45 0 0 0-.787.078v.365a.516.516 0 0 1-.747.461l-.775-.387a6.487 6.487 0 0 0-3.329 3.287c.32.474.813 1.205 1.116 1.65.138.203.4.503.582.668l.026.023c.308.278.65.516 1.021.702.452.227 1.111.586 1.575.842.328.182.53.527.53.903v1.032c0 .274.11.537.303.73.484.484.785 1.246.73 1.653v.884c.473 0 .932-.055 1.376-.152l.56-1.511c.067-.177.106-.362.155-.544a.771.771 0 0 1 .199-.346l.365-.364zm2.797-2.946l.94.235c.036-.27.06-.544.06-.824a6.4 6.4 0 0 0-.688-2.882l-.419.21a.773.773 0 0 0-.298.263l-.632.947a.908.908 0 0 0-.13.43c0 .13.058.321.13.43l.58.87c.107.16.27.274.457.32z"/>\n</svg>\n'},{}],62:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 39.1 (31720) - http://www.bohemiancoding.com/sketch --\x3e\n    <defs/>\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g fill="currentColor">\n            <g>\n                <path d="M0,8 C0,12.418278 3.581722,16 8,16 C12.418278,16 16,12.418278 16,8 C16,4.89580324 14.2154684,2.11256098 11.4682644,0.789110134 L10.6002482,2.59092808 C12.661769,3.58405472 14,5.6712248 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,5.65296151 3.35941993,3.55225774 5.44569583,2.56903563 L4.59307587,0.759881355 C1.81273067,2.07020511 0,4.87140735 0,8 Z" />\n                <polygon points="7 8.58578644 7 0 9 0 9 8.58578644 10.2928932 7.29289322 11 6.58578644 12.4142136 8 11.7071068 8.70710678 8.70710678 11.7071068 8 12.4142136 7.64644661 12.0606602 7.29289322 11.7071068 4.29289322 8.70710678 3.58578644 8 5 6.58578644 5.70710678 7.29289322"/>\n            </g>\n        </g>\n    </g>\n</svg>\n'},{}],63:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M6.422 5.422c2 0 3.542.417 4.625 1.25 1.083.833 1.875 1.75 2.375 2.75s.792 1.917.875 2.75l.125 1.25h-2l-.094-.938c-.062-.625-.281-1.312-.656-2.062-.375-.75-.969-1.438-1.781-2.063-.813-.625-1.97-.937-3.47-.937H4.829l2 2-1.406 1.422L1 6.422 5.422 2l1.406 1.422-2 2h1.594z"/>\n</svg>\n'},{}],64:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 1C4.5 1 1 4.5 1 8s3.5 7 7 7 7-3.5 7-7-3.5-7-7-7zm0 7l-4 4 4-4 4-4-4 4z"></path></g></svg>\n'},{}],65:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--search"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.536 9.536a5 5 0 1 1-7.071-7.071 5 5 0 0 1 7.07 7.07L15 15 9.536 9.536z"></path></g></svg>\n'},{}],66:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--share"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V2m7 8v5H1v-5m3-5l4-4 4 4"></path></g></svg>\n'},{}],67:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--sort"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 9V2v7zM1 5l4-4 4 4m2 2v7-7zm-4 4l4 4 4-4"></path></g></svg>\n'},{}],68:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--trash"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 4h12l-2 11H4L2 4zM1 1h14H1z"></path></g></svg>\n'},{}],69:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-twitter"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.969 3.049c-.59.259-1.22.436-1.884.516a3.305 3.305 0 0 0 1.442-1.815c-.634.37-1.336.64-2.084.79a3.28 3.28 0 0 0-5.59 2.988 9.29 9.29 0 0 1-6.76-3.418A3.214 3.214 0 0 0 .65 3.76c0 1.14.58 2.142 1.459 2.73a3.27 3.27 0 0 1-1.485-.41v.04a3.282 3.282 0 0 0 2.63 3.218 3.33 3.33 0 0 1-1.474.057 3.291 3.291 0 0 0 3.069 2.278A6.578 6.578 0 0 1 .78 13.076c-.26 0-.52-.015-.78-.044a9.33 9.33 0 0 0 5.038 1.472c6.036 0 9.332-4.997 9.332-9.323 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7l-.031-.012z"></path></g></svg>\n'},{}],70:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={FEATURE_FLAGS_UPDATED:"featureFlagsUpdated",HELP_REQUESTED:"helpRequested",LOGIN_REQUESTED:"loginRequested",LOGOUT_REQUESTED:"logoutRequested",PROFILE_REQUESTED:"profileRequested",PUBLIC_ANNOTATION_COUNT_CHANGED:"publicAnnotationCountChanged",SIGNUP_REQUESTED:"signupRequested"}},{}],71:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("./frame-rpc"))&&r.__esModule?r:{default:r};function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.links=[],this.channelListeners={},this.onConnectListeners=[]}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(e,[{key:"destroy",value:function(){Array.from(this.links).map((function(e){return e.channel.destroy()}))}},{key:"createChannel",value:function(e,t,n){var r=this,i=null,a=!1,s=function(){a||(a=!0,Array.from(r.onConnectListeners).forEach((function(t){return t.call(null,i,e)})))},l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({connect:function(e,t){e===n&&(t(),s())}},this.channelListeners);return(i=new o.default(window,e,t,l)).call("connect",n,s),this.links.push({channel:i,window:e}),i}},{key:"call",value:function(e){for(var t,n=this,r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];"function"==typeof o[o.length-1]&&(t=o[o.length-1],o=o.slice(0,-1));var u=function(e){return function(t){throw e.destroy(),n.links=Array.from(n.links).filter((function(t){return t.channel!==e})).map((function(e){return e})),t}},c=this.links.map((function(t){return new Promise((function(n,r){var a=setTimeout((function(){return n(null)}),1e3);try{var u;return(u=t.channel).call.apply(u,[e].concat(i(Array.from(o)),[function(e,t){return clearTimeout(a),e?r(e):n(t)}]))}catch(e){return r(e)}})).catch(u(t.channel))})),s=Promise.all(c);return t&&(s=s.then((function(e){return t(null,e)})).catch((function(e){return t(e)}))),s}},{key:"on",value:function(e,t){if(this.channelListeners[e])throw new Error("Listener '".concat(e,"' already bound in Bridge"));return this.channelListeners[e]=t,this}},{key:"off",value:function(e){return delete this.channelListeners[e],this}},{key:"onConnect",value:function(e){return this.onConnectListeners.push(e),this}}]),e}();n.default=l},{"./frame-rpc":76}],72:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeKeyName=function(e){var t={Left:"ArrowLeft",Up:"ArrowUp",Down:"ArrowDown",Right:"ArrowRight",Spacebar:" ",Del:"Delete"};return t[e]?t[e]:e}},{}],73:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l,n.registerIcons=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.reset,r=void 0!==n&&n;r&&(s={}),Object.assign(s,e)},n.availableIcons=function(){return s};var r=u(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=u(e("prop-types"));function u(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s={};function l(e){var t=e.name,n=e.className,a=void 0===n?"":n,u=e.inline,l=void 0!==u&&u,f=e.title,d=void 0===f?"":f;if(!s[t])throw new Error('Icon name "'.concat(t,'" is not registered'));var p=s[t],m=(0,i.useRef)();(0,i.useLayoutEffect)((function(){var e=m.current.querySelector("svg");e&&e.setAttribute("class",a)}),[a,p]);var h={};return d&&(h.title=d),(0,o.createElement)("span",c({className:(0,r.default)("svg-icon",{"svg-icon--inline":l}),dangerouslySetInnerHTML:{__html:p},ref:m},h))}l.propTypes={name:a.default.string.isRequired,className:a.default.string,inline:a.default.bool,title:a.default.string}},{classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],74:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.target=t,this.server=!1,this.origin="*",this.requestInProgress=!1,this.onDiscovery=null,void 0!==n.server&&(this.server=n.server),void 0!==n.origin&&(this.origin=n.origin),this._onMessage=this._onMessage.bind(this)}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(e,[{key:"startDiscovery",value:function(e){if(this.onDiscovery)throw new Error("Discovery is already in progress. Call stopDiscovery() first");this.onDiscovery=e,this.target.addEventListener("message",this._onMessage,!1),this._beacon()}},{key:"stopDiscovery",value:function(){this.onDiscovery=null,this.target.removeEventListener("message",this._onMessage)}},{key:"_beacon",value:function(){var e;e=this.server?"__cross_frame_dhcp_offer":"__cross_frame_dhcp_discovery";for(var t=[this.target.top];t.length>0;){var n=t.shift();n!==this.target&&n.postMessage(e,this.origin);for(var r=0;r<n.frames.length;r++)t.push(n.frames[r])}}},{key:"_onMessage",value:function(e){var t=e.source,n=e.data,o=e.origin;("null"===o||o.match("moz-extension:")||"moz-extension:"===window.location.protocol)&&(o="*");var i="string"==typeof n&&n.match(/^__cross_frame_dhcp_(discovery|offer|request|ack)(?::(\d+))?$/);if(i){var a=r(i,3),u=a[1],c=a[2],s=this._processMessage(u,c,o),l=s.reply,f=s.discovered,d=s.token;l&&t.postMessage("__cross_frame_dhcp_"+l,o),f&&this.onDiscovery&&this.onDiscovery.call(null,t,o,d)}}},{key:"_processMessage",value:function(e,t,n){var r=null,o=!1;if(this.server){if("discovery"===e)r="offer";else if("request"===e)t=this.generateToken(),r="ack:".concat(t),o=!0;else if("offer"===e||"ack"===e)throw new Error("A second Discovery server has been detected at ".concat(n,".\n This is unsupported and will cause unexpected behaviour."))}else"offer"===e?this.requestInProgress||(this.requestInProgress=!0,r="request"):"ack"===e&&(this.requestInProgress=!1,o=!0);return{reply:r,discovered:o,token:t}}},{key:"generateToken",value:function(){return Math.random().toString().replace(/\D/g,"")}}]),e}();n.default=u},{}],75:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.closest=function(e,t){for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}},{}],76:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=i;var o="1.0.0";function i(e,t,n,o){if(!(this instanceof i))return new i(e,t,n,o);var a=this;if(this.src=e,this.dst=t,"*"===n)this.origin="*";else{var u=new URL(n);this.origin=u.protocol+"//"+u.host}this._sequence=0,this._callbacks={},this._onmessage=function(e){a._destroyed||a.dst===e.source&&("*"!==a.origin&&e.origin!==a.origin||e.data&&"object"===r(e.data)&&"frame-rpc"===e.data.protocol&&Array.isArray(e.data.arguments)&&a._handle(e.data))},this.src.addEventListener("message",this._onmessage),this._methods=("function"==typeof o?o(this):o)||{}}i.prototype.destroy=function(){this._destroyed=!0,this.src.removeEventListener("message",this._onmessage)},i.prototype.call=function(e){var t=[].slice.call(arguments,1);return this.apply(e,t)},i.prototype.apply=function(e,t){if(!this._destroyed){var n=this._sequence++;"function"==typeof t[t.length-1]&&(this._callbacks[n]=t[t.length-1],t=t.slice(0,-1)),this.dst.postMessage({protocol:"frame-rpc",version:o,sequence:n,method:e,arguments:t},this.origin)}},i.prototype._handle=function(e){var t=this;if(!t._destroyed)if(e.hasOwnProperty("method")){if(!this._methods.hasOwnProperty(e.method))return;var n=e.arguments.concat((function(){t.dst.postMessage({protocol:"frame-rpc",version:o,response:e.sequence,arguments:[].slice.call(arguments)},t.origin)}));this._methods[e.method].apply(this._methods,n)}else if(e.hasOwnProperty("response")){var r=this._callbacks[e.response];delete this._callbacks[e.response],r&&r.apply(null,e.arguments)}}},{}],77:[function(e,t,n){"use strict";function r(e,t,n){return(r=o()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&i(o,n.prototype),o}).apply(null,arguments)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Injector=void 0;var l=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._providers=new Map,this._instances=new Map,this._constructing=new Set}return function(e,t,n){t&&c(e.prototype,t),n&&c(e,n)}(e,[{key:"get",value:function(e){if(this._instances.has(e))return this._instances.get(e);var t=this._providers.get(e);if(!t)throw new Error('"'.concat(e,'" is not registered'));if("value"in t)return this._instances.set(e,t.value),t.value;if(this._constructing.has(e))throw new Error('Encountered a circular dependency when constructing "'.concat(e,'"'));this._constructing.add(e);try{var n,o,i=[],u=a("class"in t&&t.class.$inject||"factory"in t&&t.factory.$inject||[]);try{for(u.s();!(n=u.n()).done;){var c=n.value;try{i.push(this.get(c))}catch(t){var s=new Error('Failed to construct dependency "'.concat(c,'" of "').concat(e,'": ').concat(t.message));throw s.cause=t,s}}}catch(e){u.e(e)}finally{u.f()}return o=t.class?r(t.class,i):t.factory.apply(void 0,i),this._instances.set(e,o),o}finally{this._constructing.delete(e)}}},{key:"register",value:function(e,t){if("function"==typeof t)t={class:t};else if(!function(e){return"object"===s(e)&&null!==e&&("value"in e||"function"==typeof e.class||"function"==typeof e.factory)}(t))throw new Error('Invalid provider for "'.concat(e,'"'));return this._providers.set(e,t),this}},{key:"run",value:function(e){var t="Injector.run";this.register(t,{factory:e});try{return this.get(t)}finally{this._instances.delete(t),this._providers.delete(t)}}}]),e}();n.Injector=l},{}],78:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setupIE11Fixes=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.options;if((0,o.isIE11)()){var t=e.vnode;e.vnode=function(e){"string"==typeof e.type&&"dir"in e.props&&"auto"===e.props.dir&&(e.props.dir=""),t&&t(e)}}};var r=e("preact"),o=e("./user-agent")},{"./user-agent":81,preact:7}],79:[function(e,t,n){"use strict";function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(n,"__esModule",{value:!0}),n.jsonConfigsFrom=function(e){for(var t={},n=e.querySelectorAll("script.js-hypothesis-config"),o=0;o<n.length;o++){var i=void 0;try{i=JSON.parse(n[o].textContent||"")}catch(e){console.warn("Could not parse settings from js-hypothesis-config tags",e),i={}}r(t,i)}return t}},{}],80:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.toBoolean=function(e){if("string"==typeof e&&"false"===e.trim().toLocaleLowerCase())return!1;var t=Number(e);return isNaN(t)?"string"==typeof e:Boolean(t)},n.toInteger=function(e){return parseInt(e)},n.toObject=function(e){return"object"===r(e)&&null!==e?e:{}},n.toString=function(e){return e&&"function"==typeof e.toString?e.toString():""}},{}],81:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isMacOS=n.isIE11=void 0;n.isIE11=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return e.indexOf("Trident/7.0")>=0};n.isMacOS=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return e.indexOf("Mac OS")>=0}},{}],82:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var r={};function o(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=n.join();i in r||((e=console).warn.apply(e,n),r[i]=!0)}o.reset=function(){r={}}},{}],83:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=d(e("prop-types")),i=d(e("../ui-constants")),a=d(e("../store/use-store")),u=e("../util/annotation-sharing"),c=e("../util/permissions"),s=e("../util/service-context"),l=d(e("./annotation-share-control")),f=d(e("./button"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){var t=e.annotation,n=e.annotationsService,o=e.onReply,s=e.settings,d=e.toastMessenger,p=(0,a.default)((function(e){return e.profile()})),m=(0,a.default)((function(e){return e.getGroup(t.group)})),h=(0,a.default)((function(e){return e.isLoggedIn()})),y=(0,a.default)((function(e){return e.openSidebarPanel})),v=function(e){return(0,c.permits)(t.permissions,e,p.userid)},g=v("delete"),b=v("update"),_=p.userid!==t.user,w=(0,u.isShareable)(t,s),O=(0,a.default)((function(e){return e.createDraft}));return(0,r.createElement)("div",{className:"annotation-action-bar u-layout-row"},b&&(0,r.createElement)(f.default,{icon:"edit",title:"Edit",onClick:function(){O(t,{tags:t.tags,text:t.text,isPrivate:(0,c.isPrivate)(t.permissions)})}}),g&&(0,r.createElement)(f.default,{icon:"trash",title:"Delete",onClick:function(){window.confirm("Are you sure you want to delete this annotation?")&&n.delete(t).catch((function(e){d.error(e.message)}))}}),(0,r.createElement)(f.default,{icon:"reply",title:"Reply",onClick:function(){h?o():y(i.default.PANEL_LOGIN_PROMPT)}}),w&&(0,r.createElement)(l.default,{annotation:t,group:m,shareUri:(0,u.shareURI)(t)}),_&&!t.flagged&&(0,r.createElement)(f.default,{icon:"flag",title:"Report this annotation to moderators",onClick:function(){p.userid?n.flag(t).catch((function(){return d.error("Flagging annotation failed")})):d.error("You must be logged in to report an annotation")}}),_&&t.flagged&&(0,r.createElement)(f.default,{isPressed:!0,icon:"flag--active",title:"Annotation has been reported to the moderators"}))}p.propTypes={annotation:o.default.object.isRequired,onReply:o.default.func.isRequired,annotationsService:o.default.object.isRequired,settings:o.default.object.isRequired,toastMessenger:o.default.object.isRequired},p.injectedProps=["annotationsService","settings","toastMessenger"];var m=(0,s.withServices)(p);n.default=m},{"../store/use-store":188,"../ui-constants":190,"../util/annotation-sharing":193,"../util/permissions":209,"../util/service-context":215,"./annotation-share-control":90,"./button":96,preact:7,"prop-types":10}],84:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=h(e("prop-types")),a=e("../util/annotation-metadata"),u=e("../util/service-context"),c=e("../util/theme"),s=h(e("./button")),l=h(e("./excerpt")),f=h(e("./markdown-editor")),d=h(e("./markdown-view")),p=h(e("./tag-editor")),m=h(e("./tag-list"));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=e.annotation,n=e.isEditing,i=e.onEditTags,u=e.onEditText,h=e.tags,v=e.text,g=e.settings,b=y((0,o.useState)(!0),2),_=b[0],w=b[1],O=y((0,o.useState)(!1),2),E=O[0],S=O[1],A=_?"More":"Less",j=!n&&v.length>0,k=!n&&h.length>0,T=(0,c.applyTheme)(["annotationFontFamily"],g);return(0,r.createElement)("div",{className:"annotation-body"},j&&(0,r.createElement)(l.default,{collapse:_,collapsedHeight:400,inlineControls:!1,onCollapsibleChanged:S,onToggleCollapsed:w,overflowThreshold:20},(0,r.createElement)(d.default,{textStyle:T,markdown:v,textClass:{"annotation-body__text":!0,"is-hidden":(0,a.isHidden)(t)}})),n&&(0,r.createElement)(f.default,{textStyle:T,label:"Annotation body",text:v,onEditText:u}),E&&!n&&(0,r.createElement)("div",{className:"annotation-body__collapse-toggle"},(0,r.createElement)(s.default,{buttonText:A,className:"annotation-body__collapse-toggle-button",isExpanded:!_,onClick:function(){w(!_)},"aria-label":"Toggle visibility of full annotation text",title:"Toggle visibility of full annotation text"})),k&&(0,r.createElement)(m.default,{annotation:t,tags:h}),n&&(0,r.createElement)(p.default,{onEditTags:i,tagList:h}))}g.propTypes={annotation:i.default.object.isRequired,isEditing:i.default.bool,onEditTags:i.default.func,onEditText:i.default.func,tags:i.default.array.isRequired,text:i.default.string,settings:i.default.object},g.injectedProps=["settings"];var b=(0,u.withServices)(g);n.default=b},{"../util/annotation-metadata":192,"../util/service-context":215,"../util/theme":219,"./button":96,"./excerpt":97,"./markdown-editor":108,"./markdown-view":109,"./tag-editor":128,"./tag-list":129,preact:7,"preact/hooks":8,"prop-types":10}],85:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var o,i=e("preact"),a=(o=e("prop-types"))&&o.__esModule?o:{default:o},u=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util/annotation-metadata"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e){var t=e.annotation,n=u.domainAndTitle(t);return n.titleText?(0,i.createElement)("div",{className:"annotation-document-info u-layout-row u-horizontal-rhythm"},(0,i.createElement)("div",{className:"annotation-document-info__title u-color-text--muted"},'on "',n.titleLink?(0,i.createElement)("a",{href:n.titleLink},n.titleText):(0,i.createElement)("span",null,n.titleText),'"'),n.domain&&(0,i.createElement)("div",{className:"annotation-document-info__domain u-color-text--muted"},"(",n.domain,")")):null}s.propTypes={annotation:a.default.object.isRequired}},{"../util/annotation-metadata":192,preact:7,"prop-types":10}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var r=e("preact"),o=m(e("prop-types")),i=m(e("../store/use-store")),a=e("../util/annotation-metadata"),u=e("../util/permissions"),c=m(e("./annotation-document-info")),s=m(e("./annotation-share-info")),l=m(e("./annotation-user")),f=m(e("./button")),d=m(e("../../shared/components/svg-icon")),p=m(e("./timestamp"));function m(e){return e&&e.__esModule?e:{default:e}}function h(e){var t=e.annotation,n=e.isEditing,o=e.replyCount,m=e.showDocumentInfo,h=e.threadIsCollapsed,y=(0,a.isReply)(t)&&h,v=(0,i.default)((function(e){return e.setExpanded})),g=(0,u.isPrivate)(t.permissions),b=t.links?t.links.html:"",_=t.updated&&t.created!==t.updated,w=!n&&t.created,O=_&&!y,E=o>1?"replies":"reply",S="".concat(o," ").concat(E),A=o>0&&y,j=!(0,a.isReply)(t);return(0,r.createElement)("header",{className:"annotation-header"},(0,r.createElement)("div",{className:"annotation-header__row"},g&&!n&&(0,r.createElement)(d.default,{className:"annotation-header__icon",name:"lock",title:"This annotation is visible only to you"}),(0,r.createElement)(l.default,{annotation:t}),A&&(0,r.createElement)(f.default,{className:"annotation-header__reply-toggle",buttonText:S,onClick:function(){return v(t.id,!0)},title:"Expand replies"}),w&&(0,r.createElement)("div",{className:"annotation-header__timestamp"},O&&(0,r.createElement)("span",{className:"annotation-header__timestamp-edited"},"(edited"," ",(0,r.createElement)(p.default,{className:"annotation-header__timestamp-edited-link",timestamp:t.updated}),")"," "),(0,r.createElement)("span",{className:"annotation-header__timestamp-created"},(0,r.createElement)(p.default,{className:"annotation-header__timestamp-created-link u-color-text--muted",href:b,timestamp:t.created})))),j&&(0,r.createElement)("div",{className:"annotation-header__row"},(0,r.createElement)(s.default,{annotation:t}),!n&&(0,a.isHighlight)(t)&&(0,r.createElement)("div",{className:"annotation-header__highlight"},(0,r.createElement)(d.default,{name:"highlight",title:"This is a highlight. Click 'edit' to add a note or tag.",inline:!0,className:"annotation-header__highlight-icon"})),m&&(0,r.createElement)(c.default,{annotation:t})))}h.propTypes={annotation:o.default.object.isRequired,isEditing:o.default.bool,replyCount:o.default.number,showDocumentInfo:o.default.bool,threadIsCollapsed:o.default.bool.isRequired}},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../util/annotation-metadata":192,"../util/permissions":209,"./annotation-document-info":85,"./annotation-share-info":91,"./annotation-user":92,"./button":96,"./timestamp":133,preact:7,"prop-types":10}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var r,o=e("preact"),i=(r=e("../../shared/components/svg-icon"))&&r.__esModule?r:{default:r};function a(){return(0,o.createElement)("div",{className:"annotation-license"},(0,o.createElement)("a",{className:"u-layout-row u-color-text--muted",href:"http://creativecommons.org/publicdomain/zero/1.0/",title:"View more information about the Creative Commons Public Domain dedication",target:"_blank",rel:"noopener noreferrer"},(0,o.createElement)("div",{className:"annotation-license__icons"},(0,o.createElement)(i.default,{name:"cc-std",inline:!0,className:"u-icon--xsmall"}),(0,o.createElement)(i.default,{name:"cc-zero",inline:!0,className:"u-icon--xsmall"})),"Annotations can be freely reused by anyone for any purpose."))}a.propTypes={}},{"../../shared/components/svg-icon":73,preact:7}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=m(e("prop-types")),i=m(e("../store/use-store")),a=e("../util/annotation-metadata"),u=e("../util/permissions"),c=e("../util/service-context"),s=e("../util/theme"),l=m(e("./button")),f=m(e("./menu")),d=m(e("./menu-item")),p=m(e("../../shared/components/svg-icon"));function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){var t=e.annotation,n=e.isDisabled,o=e.onSave,c=e.settings,m=(0,i.default)((function(e){return e.getDraft(t)})),h=(0,i.default)((function(e){return e.getGroup(t.group)})),v=(0,i.default)((function(e){return e.createDraft})),g=(0,i.default)((function(e){return e.removeDraft})),b=(0,i.default)((function(e){return e.setDefault})),_=(0,i.default)((function(e){return e.removeAnnotations}));if(!h)return null;var w=m?m.isPrivate:!(0,u.isShared)(t.permissions),O=w?"Only Me":h.name,E=function(e){v(t,y(y({},m),{},{isPrivate:"private"===e})),(0,a.isReply)(t)||b("annotationPrivacy",e)},S=(0,s.applyTheme)(["ctaTextColor","ctaBackgroundColor"],c),A=(0,r.createElement)("div",{className:"annotation-publish-button__menu-label",style:S},(0,r.createElement)(p.default,{name:"expand-menu",className:"u-icon--small"}));return(0,r.createElement)("div",{className:"annotation-publish-control"},(0,r.createElement)("div",{className:"annotation-publish-button"},(0,r.createElement)(l.default,{className:"annotation-publish-button__primary",style:S,onClick:o,disabled:n,title:"Publish this annotation to ".concat(O),buttonText:"Post to ".concat(O)}),(0,r.createElement)("div",{className:"annotation-publish-button__menu-wrapper",style:S},(0,r.createElement)(f.default,{arrowClass:"annotation-publish-button__menu-arrow",containerPositioned:!1,contentClass:"annotation-publish-button__menu-content",label:A,menuIndicator:!1,title:"Change annotation sharing setting",align:"left"},(0,r.createElement)(d.default,{icon:"open"===h.type?"public":"groups",label:h.name,isSelected:!w,onClick:function(){return E("shared")}}),(0,r.createElement)(d.default,{icon:"lock",label:"Only Me",isSelected:w,onClick:function(){return E("private")}})))),(0,r.createElement)("div",null,(0,r.createElement)(l.default,{icon:"cancel",className:"annotation-publish-control__cancel-button",buttonText:"Cancel",onClick:function(){g(t),(0,a.isNew)(t)&&_([t])}})))}g.propTypes={annotation:o.default.object.isRequired,isDisabled:o.default.bool,onSave:o.default.func.isRequired,settings:o.default.object.isRequired},g.injectedProps=["settings"];var b=(0,c.withServices)(g);n.default=b},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../util/annotation-metadata":192,"../util/permissions":209,"../util/service-context":215,"../util/theme":219,"./button":96,"./menu":113,"./menu-item":110,preact:7,"prop-types":10}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("classnames")),o=e("preact"),i=l(e("prop-types")),a=e("../util/annotation-metadata"),u=e("../util/service-context"),c=e("../util/theme"),s=l(e("./excerpt"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){var t=e.annotation,n=e.isFocused,i=e.settings,u=void 0===i?{}:i;return(0,o.createElement)("div",{className:(0,r.default)("annotation-quote",{"is-orphan":(0,a.isOrphan)(t),"is-focused":n})},(0,o.createElement)(s.default,{collapsedHeight:35,inlineControls:!0,overflowThreshold:20},(0,o.createElement)("blockquote",{className:"annotation-quote__quote",dir:"auto",lang:"",style:(0,c.applyTheme)(["selectionFontFamily"],u)},(0,a.quote)(t))))}f.propTypes={annotation:i.default.object.isRequired,isFocused:i.default.bool,settings:i.default.object},f.injectedProps=["settings"];var d=(0,u.withServices)(f);n.default=d},{"../util/annotation-metadata":192,"../util/service-context":215,"../util/theme":219,"./excerpt":97,classnames:1,preact:7,"prop-types":10}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=p(e("prop-types")),a=e("../util/copy-to-clipboard"),u=e("../util/permissions"),c=e("../util/service-context"),s=p(e("./button")),l=p(e("./hooks/use-element-should-close")),f=p(e("./share-links")),d=p(e("../../shared/components/svg-icon"));function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=e.annotation,n=e.analytics,i=e.toastMessenger,c=e.group,p=e.shareUri,h=(0,u.isPrivate)(t.permissions),y=(0,o.useRef)(null),v=(0,o.useRef)(null),g=m((0,o.useState)(!1),2),b=g[0],_=g[1],w=(0,o.useRef)(b);if((0,l.default)(y,b,(function(){return _(!1)})),(0,o.useEffect)((function(){w.current!==b&&(w.current=b,b&&(v.current.focus(),v.current.select()))}),[b]),!c)return null;var O="private"===c.type?(0,r.createElement)("span",null,"Only members of the group ",(0,r.createElement)("em",null,c.name)," may view this annotation."):(0,r.createElement)("span",null,"Anyone using this link may view this annotation."),E=h?(0,r.createElement)("span",null,"Only you may view this annotation."):O;return(0,r.createElement)("div",{className:"annotation-share-control",ref:y},(0,r.createElement)(s.default,{icon:"share",title:"Share",onClick:function(){return _(!b)},isExpanded:b}),b&&(0,r.createElement)("div",{className:"annotation-share-panel"},(0,r.createElement)("div",{className:"annotation-share-panel__header"},(0,r.createElement)("div",{className:"annotation-share-panel__title"},"Share this annotation")),(0,r.createElement)("div",{className:"annotation-share-panel__content"},(0,r.createElement)("div",{className:"u-layout-row"},(0,r.createElement)("input",{"aria-label":"Use this URL to share this annotation",className:"annotation-share-panel__form-input",type:"text",value:p,readOnly:!0,ref:v}),(0,r.createElement)(s.default,{icon:"copy",title:"Copy share link to clipboard",onClick:function(){try{(0,a.copyText)(p),i.success("Copied share link to clipboard")}catch(e){i.error("Unable to copy link")}},className:"annotation-share-panel__icon-button"})),(0,r.createElement)("div",{className:"annotation-share-panel__permissions"},E),(0,r.createElement)(f.default,{shareURI:p,analyticsEventName:n.events.ANNOTATION_SHARED,className:"annotation-share-control__links"})),(0,r.createElement)(d.default,{name:"pointer",inline:!0,className:"annotation-share-panel__arrow"})))}y.propTypes={annotation:i.default.object.isRequired,group:i.default.object,shareUri:i.default.string.isRequired,analytics:i.default.object.isRequired,toastMessenger:i.default.object.isRequired},y.injectedProps=["analytics","toastMessenger"];var v=(0,c.withServices)(y);n.default=v},{"../../shared/components/svg-icon":73,"../util/copy-to-clipboard":196,"../util/permissions":209,"../util/service-context":215,"./button":96,"./hooks/use-element-should-close":103,"./share-links":119,preact:7,"preact/hooks":8,"prop-types":10}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=c(e("prop-types")),i=c(e("../store/use-store")),a=e("../util/permissions"),u=c(e("../../shared/components/svg-icon"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.annotation,n=(0,i.default)((function(e){return e.getGroup(t.group)})),o=null==n?void 0:n.links.html,c=(0,a.isPrivate)(t.permissions);return(0,r.createElement)("div",{className:"annotation-share-info u-layout-row--align-baseline"},n&&o&&(0,r.createElement)("a",{className:"u-layout-row--align-baseline u-color-text--muted",href:n.links.html,target:"_blank",rel:"noopener noreferrer"},"open"===n.type?(0,r.createElement)(u.default,{className:"annotation-share-info__icon",name:"public"}):(0,r.createElement)(u.default,{className:"annotation-share-info__icon",name:"groups"}),(0,r.createElement)("span",{className:"annotation-share-info__group-info"},n.name)),c&&!o&&(0,r.createElement)("span",{className:"u-layout-row--align-baseline u-color-text--muted"},(0,r.createElement)("span",{className:"annotation-share-info__private-info"},"Only me")))}s.propTypes={annotation:o.default.object.isRequired};var l=s;n.default=l},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../util/permissions":209,preact:7,"prop-types":10}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("preact"),i=(r=e("prop-types"))&&r.__esModule?r:{default:r},a=e("../util/account-id"),u=e("../util/service-context");function c(e){var t=e.annotation,n=e.features,r=e.serviceUrl,i=e.settings,u=t.user,c=!(0,a.isThirdPartyUser)(u,i.authDomain),s=(0,a.username)(u),l=c&&!n.flagEnabled("client_display_names")?s:t.user_info&&t.user_info.display_name?t.user_info.display_name:s;return c||i.usernameUrl?(0,o.createElement)("div",{className:"annotation-user"},(0,o.createElement)("a",{className:"annotation-user__link",href:c?r("user",{user:u}):"".concat(i.usernameUrl).concat(s),target:"_blank",rel:"noopener noreferrer"},(0,o.createElement)("h3",{className:"annotation-user__user-name"},l))):(0,o.createElement)("div",{className:"annotation-user"},(0,o.createElement)("h3",{className:"annotation-user__user-name"},l))}c.propTypes={annotation:i.default.object.isRequired,features:i.default.object.isRequired,serviceUrl:i.default.func.isRequired,settings:i.default.object.isRequired},c.injectedProps=["features","serviceUrl","settings"];var s=(0,u.withServices)(c);n.default=s},{"../util/account-id":191,"../util/service-context":215,preact:7,"prop-types":10}],93:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=f(e("prop-types")),a=f(e("../store/use-store")),u=e("../util/service-context"),c=f(e("./hooks/use-root-thread")),s=f(e("./thread-list")),l=f(e("./sidebar-content-error"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){var t=e.loadAnnotationsService,n=e.onLogin,i=(0,a.default)((function(e){return e.routeParams().id})),u=(0,a.default)((function(e){return e.clearAnnotations})),f=(0,a.default)((function(e){return e.highlightAnnotations})),p=(0,c.default)(),m=(0,a.default)((function(e){return e.setExpanded})),h=(0,a.default)((function(e){return e.profile().userid})),y=d((0,o.useState)(!1),2),v=y[0],g=y[1];return(0,o.useEffect)((function(){g(!1),u(),t.loadThread(i).then((function(e){var t=e.filter((function(e){return 0===(e.references||[]).length}))[0];t&&(e.forEach((function(e){return m(e.id,!0)})),t.id!==i&&f([i]))})).catch((function(){g(!0)}))}),[i,h,u,f,t,m]),(0,r.createElement)(r.Fragment,null,v&&(0,r.createElement)(l.default,{errorType:"annotation",onLoginRequest:n}),(0,r.createElement)(s.default,{thread:p}))}m.propTypes={onLogin:i.default.func.isRequired,loadAnnotationsService:i.default.object},m.injectedProps=["loadAnnotationsService"];var h=(0,u.withServices)(m);n.default=h},{"../store/use-store":188,"../util/service-context":215,"./hooks/use-root-thread":104,"./sidebar-content-error":120,"./thread-list":131,preact:7,"preact/hooks":8,"prop-types":10}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=g(e("classnames")),o=e("preact"),i=g(e("prop-types")),a=e("../../shared/browser-compatibility-utils"),u=g(e("../store/use-store")),c=e("../util/annotation-metadata"),s=e("../util/permissions"),l=e("../util/service-context"),f=g(e("./annotation-action-bar")),d=g(e("./annotation-body")),p=g(e("./annotation-header")),m=g(e("./annotation-license")),h=g(e("./annotation-publish-control")),y=g(e("./annotation-quote")),v=g(e("./button"));function g(e){return e&&e.__esModule?e:{default:e}}function b(){}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){var t=e.annotation,n=e.annotationsService,i=e.replyCount,l=e.showDocumentInfo,g=e.threadIsCollapsed,_=e.toastMessenger,O=(0,u.default)((function(e){return e.createDraft})),E=(0,u.default)((function(e){return e.isAnnotationFocused(t.$tag)})),S=(0,u.default)((function(e){return e.setExpanded})),A=(0,u.default)((function(e){return e.getDraft(t)})),j=(0,u.default)((function(e){return e.getGroup(t.group)})),k=(0,u.default)((function(e){return e.profile().userid})),T=(0,u.default)((function(e){return e.isSavingAnnotation(t)})),P=(0,c.isReply)(t)&&g,x=A?A.isPrivate:!(0,s.isShared)(t.permissions),N=A?A.tags:t.tags,C=A?A.text:t.text,M=!!(0,c.quote)(t),D=!C&&!N.length,I=!!A&&!T,L="".concat(g?"Show replies":"Hide replies"," (").concat(i,")"),R=!T&&!I,F=I&&!x&&j&&"private"!==j.type,U=i>0&&!(0,c.isReply)(t),q=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(){return function(e){if(e&&e.then)return e.then(b)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return function(e,t){if(!t)return e&&e.then?e.then(b):Promise.resolve()}(n.save(t))}),(function(){_.error("Saving annotation failed")})))}));return(0,o.createElement)("article",{className:(0,r.default)("annotation",{"annotation--reply":(0,c.isReply)(t),"is-collapsed":g,"is-focused":E}),onKeyDown:function(e){var t=(0,a.normalizeKeyName)(e.key);!D&&I&&(e.metaKey||e.ctrlKey)&&"Enter"===t&&(e.stopPropagation(),e.preventDefault(),q())}},(0,o.createElement)(p.default,{annotation:t,isEditing:I,replyCount:i,showDocumentInfo:l,threadIsCollapsed:g}),M&&(0,o.createElement)(y.default,{annotation:t,isFocused:E}),!P&&(0,o.createElement)(d.default,{annotation:t,isEditing:I,onEditTags:function(e){var n=e.tags;O(t,w(w({},A),{},{tags:n}))},onEditText:function(e){var n=e.text;O(t,w(w({},A),{},{text:n}))},tags:N,text:C}),I&&(0,o.createElement)("div",{className:"annotation__form-actions u-layout-row"},(0,o.createElement)(h.default,{annotation:t,isDisabled:D,onSave:q})),F&&(0,o.createElement)(m.default,null),!P&&(0,o.createElement)("footer",{className:"annotation__footer"},(0,o.createElement)("div",{className:"annotation__controls u-layout-row"},U&&(0,o.createElement)(v.default,{className:"annotation__reply-toggle",onClick:function(){return S(t.id,!!g)},buttonText:L}),T&&(0,o.createElement)("div",{className:"annotation__actions"},"Saving..."),R&&(0,o.createElement)("div",{className:"annotation__actions"},(0,o.createElement)(f.default,{annotation:t,onReply:function(){return n.reply(t,k)}})))))}E.propTypes={annotation:i.default.object.isRequired,replyCount:i.default.number.isRequired,showDocumentInfo:i.default.bool.isRequired,threadIsCollapsed:i.default.bool.isRequired,annotationsService:i.default.object.isRequired,toastMessenger:i.default.object.isRequired},E.injectedProps=["annotationsService","toastMessenger"];var S=(0,l.withServices)(E);n.default=S},{"../../shared/browser-compatibility-utils":72,"../store/use-store":188,"../util/annotation-metadata":192,"../util/permissions":209,"../util/service-context":215,"./annotation-action-bar":83,"./annotation-body":84,"./annotation-header":86,"./annotation-license":87,"./annotation-publish-control":88,"./annotation-quote":89,"./button":96,classnames:1,preact:7,"prop-types":10}],95:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var r=e("preact"),o=u(e("classnames")),i=e("preact/hooks"),a=u(e("prop-types"));function u(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=function(e){return e};function l(e){var t=e.activeItem,n=void 0===t?-1:t,a=e.id,u=e.itemPrefixId,l=e.list,f=e.listFormatter,d=void 0===f?s:f,p=e.onSelectItem,m=e.open,h=void 0!==m&&m,y=(0,i.useMemo)((function(){return l.map((function(e,t){var i=u?{id:"".concat(u).concat(t)}:{};return(0,r.createElement)("li",c({key:"autocomplete-list-".concat(t),role:"option","aria-selected":(n===t).toString(),className:(0,o.default)({"is-selected":n===t},"autocomplete-list__li"),onClick:function(){p(e)}},i),d(e,t))}))}),[n,u,l,d,p]),v=a?{id:a}:{},g=0===l.length||!h;return(0,r.createElement)("div",{className:(0,o.default)({"is-hidden":g},"autocomplete-list")},(0,r.createElement)("ul",c({className:"autocomplete-list__items",tabIndex:-1,"aria-label":"Suggestions",role:"listbox"},v),y))}l.propTypes={activeItem:a.default.number,id:a.default.string,itemPrefixId:a.default.string,list:a.default.array.isRequired,listFormatter:a.default.func,onSelectItem:a.default.func.isRequired,open:a.default.bool}},{classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],96:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=c;var r=e("preact"),o=a(e("prop-types")),i=a(e("../../shared/components/svg-icon"));function a(e){return e&&e.__esModule?e:{default:e}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e){var t=e.buttonText,n=void 0===t?"":t,o=e.className,a=void 0===o?"":o,c=e.disabled,s=void 0!==c&&c,l=e.icon,f=void 0===l?"":l,d=e.isExpanded,p=e.isPressed,m=e.onClick,h=void 0===m?function(){}:m,y=e.style,v=void 0===y?{}:y,g=e.title;g=g||n;var b=a||"button--".concat(n?"labeled":"icon-only"),_={};return n&&g===n||(_.title=g,_["aria-label"]=g),"boolean"==typeof p&&(_["aria-pressed"]=p),"boolean"==typeof d&&(_["aria-expanded"]=d),(0,r.createElement)("button",u({className:b,onClick:h,style:v,disabled:s},_),f&&(0,r.createElement)(i.default,{name:f}),n)}function s(e,t,n){if("string"!=typeof e.buttonText&&"string"!=typeof e[t])return new Error("string property '".concat(t,"' must be supplied to component '").concat(n,"'if string property 'buttonText' omitted"))}c.propTypes={buttonText:o.default.string,className:o.default.string,icon:s,isExpanded:o.default.bool,isPressed:o.default.bool,onClick:o.default.func,disabled:o.default.bool,style:o.default.object,title:s}},{"../../shared/components/svg-icon":73,preact:7,"prop-types":10}],97:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=l(e("prop-types")),u=l(e("../util/observe-element-size")),c=e("../util/service-context"),s=e("../util/theme");function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=e.isCollapsed,n=e.setCollapsed,r=e.linkStyle,i=void 0===r?{}:r,a=t?"More":"Less";return(0,o.createElement)("div",{className:"excerpt__inline-controls"},(0,o.createElement)("span",{className:"excerpt__toggle-link"},(0,o.createElement)("button",{className:"excerpt__toggle-button",onClick:function(){return n(!t)},"aria-expanded":!t,"aria-label":"Toggle visibility of full excerpt text",style:i},a)))}p.propTypes={isCollapsed:a.default.bool,setCollapsed:a.default.func,linkStyle:a.default.object};var m=function(){};function h(e){var t=e.children,n=e.collapse,a=void 0!==n&&n,c=e.collapsedHeight,l=e.inlineControls,d=void 0===l||l,h=e.onCollapsibleChanged,y=void 0===h?m:h,v=e.onToggleCollapsed,g=void 0===v?m:v,b=e.overflowThreshold,_=void 0===b?0:b,w=e.settings,O=void 0===w?{}:w,E=f((0,i.useState)(!0),2),S=E[0],A=E[1],j=(0,i.useRef)(null),k=f((0,i.useState)(0),2),T=k[0],P=k[1],x=(0,i.useCallback)((function(){var e=j.current.clientHeight;P(e),y(e>c+_)}),[c,y,_]);(0,i.useLayoutEffect)((function(){var e=(0,u.default)(j.current,x);return x(),e}),[x]);var N=T>c+_,C=N&&(d?S:a),M={};0!==T&&(M["max-height"]=C?c:T);var D=function(e){return d?A(e):g(e)};return(0,o.createElement)("div",{className:"excerpt",style:M},(0,o.createElement)("div",{className:"excerpt__content",ref:j},t),(0,o.createElement)("div",{role:"presentation",onClick:function(){return D(!1)},className:(0,r.default)({excerpt__shadow:!0,"excerpt__shadow--transparent":d,"is-hidden":!C}),title:"Show the full excerpt"}),N&&d&&(0,o.createElement)(p,{isCollapsed:S,setCollapsed:D,linkStyle:(0,s.applyTheme)(["selectionFontFamily"],O)}))}h.propTypes={children:a.default.object,inlineControls:a.default.bool,collapse:a.default.bool,collapsedHeight:a.default.number,overflowThreshold:a.default.number,onCollapsibleChanged:a.default.func,onToggleCollapsed:a.default.func,settings:a.default.object},h.injectedProps=["settings"];var y=(0,c.withServices)(h);n.default=y},{"../util/observe-element-size":208,"../util/service-context":215,"../util/theme":219,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var r=e("preact"),o=s(e("prop-types")),i=e("../util/thread"),a=s(e("./button")),u=s(e("./hooks/use-root-thread")),c=s(e("../store/use-store"));function s(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e){var t=e.actionButton,n=e.additionalCount,o=void 0===n?0:n,i=e.entitySingular,a=void 0===i?"annotation":i,u=e.entityPlural,c=void 0===u?"annotations":u,s=e.filterQuery,l=e.focusDisplayName,f=e.resultCount;return(0,r.createElement)("div",{className:"filter-status"},(0,r.createElement)("div",{className:"u-layout-row--align-center"},(0,r.createElement)("div",{className:"filter-status__text"},f>0&&(0,r.createElement)("span",null,"Showing "),(0,r.createElement)("span",{className:"filter-facet"},f>0?f:"No"," ",1===f?a:c),s&&(0,r.createElement)("span",null," ","for"," ",(0,r.createElement)("span",{className:"filter-facet--pre"},"'",s,"'")),l&&(0,r.createElement)("span",null," ","by ",(0,r.createElement)("span",{className:"filter-facet"},l)),o>0&&(0,r.createElement)("span",{className:"filter-facet--muted"}," ","(and ",o," more)")),(0,r.createElement)("div",null,t)))}function d(e){var t=e.filterState,n=e.rootThread,o=(0,c.default)((function(e){return e.clearSelection})),i=(0,c.default)((function(e){return e.annotationCount()})),u=(n.children||[]).filter((function(e){return e.annotation&&e.visible})).length-t.selectedCount,s=t.focusConfigured?"Show all":"Show all (".concat(i,")"),l=(0,r.createElement)(a.default,{buttonText:s,className:"button--primary",onClick:function(){return o()},icon:"cancel"});return(0,r.createElement)(f,{resultCount:t.selectedCount,additionalCount:u,actionButton:l})}function p(e){var t=e.filterState,n=e.rootThread,o=(0,c.default)((function(e){return e.clearSelection})),u=(0,i.countVisible)(n)-t.forcedVisibleCount,s=(0,r.createElement)(a.default,{icon:"cancel",className:"button--primary",buttonText:"Clear search",onClick:function(){return o()}});return(0,r.createElement)(f,{actionButton:s,additionalCount:t.forcedVisibleCount,entitySingular:"result",entityPlural:"results",filterQuery:t.filterQuery,focusDisplayName:t.focusDisplayName,resultCount:u})}function m(e){var t=e.filterState,n=e.rootThread,o=(0,c.default)((function(e){return e.clearSelection})),u=(0,c.default)((function(e){return e.toggleFocusMode})),s=(0,i.countVisible)(n)-t.forcedVisibleCount,d={};t.forcedVisibleCount>0?(d.onClick=function(){return o()},d.buttonText="Reset filters"):(d.onClick=function(){return u()},d.buttonText=t.focusActive?"Show all":"Show only ".concat(t.focusDisplayName));var p=t.focusActive?t.focusDisplayName:"",m=(0,r.createElement)(a.default,l({className:"button--primary"},d));return(0,r.createElement)(f,{resultCount:s,actionButton:m,additionalCount:t.forcedVisibleCount,filterQuery:t.filterQuery,focusDisplayName:p})}function h(){var e=(0,u.default)(),t=(0,c.default)((function(e){return e.filterState()}));return t.selectedCount>0?(0,r.createElement)(d,{filterState:t,rootThread:e}):t.filterQuery?(0,r.createElement)(p,{filterState:t,rootThread:e}):t.focusConfigured?(0,r.createElement)(m,{filterState:t,rootThread:e}):null}f.propTypes={resultCount:o.default.number.isRequired,actionButton:o.default.object.isRequired,additionalCount:o.default.number,entitySingular:o.default.string,entityPlural:o.default.string,filterQuery:o.default.string,focusDisplayName:o.default.string},d.propTypes={filterState:o.default.object.isRequired,rootThread:o.default.object.isRequired},p.propTypes={filterState:o.default.object.isRequired,rootThread:o.default.object.isRequired},m.propTypes={filterState:o.default.object.isRequired,rootThread:o.default.object.isRequired},h.propTypes={}},{"../store/use-store":188,"../util/thread":221,"./button":96,"./hooks/use-root-thread":104,preact:7,"prop-types":10}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=l(e("prop-types")),i=l(e("../store/use-store")),a=e("../util/copy-to-clipboard"),u=e("../util/group-list-item-common"),c=e("../util/service-context"),s=l(e("./menu-item"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){var t=e.analytics,n=e.isExpanded,o=e.group,c=e.groups,l=e.onExpand,f=e.toastMessenger,d=o.links.html,p=d||o.canLeave,m=o.scopes&&!o.scopes.enforced||o.isScopedToUri,h=(0,i.default)((function(e){return e.focusedGroupId()})),y=o.id===h,v=(0,i.default)((function(e){return{clearDirectLinkedGroupFetchFailed:e.clearDirectLinkedGroupFetchFailed,clearDirectLinkedIds:e.clearDirectLinkedIds}})),g=function(e){e.stopPropagation(),e.preventDefault(),l(!n)},b="private"===o.type?"Copy invite link":"Copy activity link";return(0,r.createElement)(s.default,{icon:o.logo||"blank",iconAlt:(0,u.orgName)(o),isDisabled:!m,isExpanded:!!p&&n,isSelected:y,isSubmenuVisible:p?n:void 0,label:o.name,onClick:m?function(){t.track(t.events.GROUP_SWITCH),v.clearDirectLinkedGroupFetchFailed(),v.clearDirectLinkedIds(),c.focus(o.id)}:g,onToggleSubmenu:g,submenu:(0,r.createElement)(r.Fragment,null,(0,r.createElement)("ul",null,d&&(0,r.createElement)("li",null,(0,r.createElement)(s.default,{href:d,icon:"external",isSubmenuItem:!0,label:"View group activity"})),d&&(0,r.createElement)("li",null,(0,r.createElement)(s.default,{onClick:function(){try{(0,a.copyText)(d),f.success('Copied link for "'.concat(o.name,'"'))}catch(e){f.error("Unable to copy link")}},icon:"copy",isSubmenuItem:!0,label:b})),o.canLeave&&(0,r.createElement)("li",null,(0,r.createElement)(s.default,{icon:"leave",isSubmenuItem:!0,label:"Leave group",onClick:function(){var e='Are you sure you want to leave the group "'.concat(o.name,'"?');window.confirm(e)&&(t.track(t.events.GROUP_LEAVE),c.leave(o.id))}}))),!m&&(0,r.createElement)("p",{className:"group-list-item__footer"},"This group is restricted to specific URLs."))})}f.propTypes={group:o.default.object.isRequired,isExpanded:o.default.bool,onExpand:o.default.func,analytics:o.default.object.isRequired,groups:o.default.object.isRequired,toastMessenger:o.default.object.isRequired},f.injectedProps=["analytics","groups","toastMessenger"];var d=(0,c.withServices)(f);n.default=d},{"../store/use-store":188,"../util/copy-to-clipboard":196,"../util/group-list-item-common":201,"../util/service-context":215,"./menu-item":110,preact:7,"prop-types":10}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=c;var r=e("preact"),o=u(e("prop-types")),i=u(e("./group-list-item")),a=u(e("./menu-section"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=e.expandedGroup,n=e.onExpandGroup,o=e.groups,u=e.heading;return(0,r.createElement)(a.default,{heading:u},o.map((function(e){return(0,r.createElement)(i.default,{key:e.id,isExpanded:e===t,onExpand:function(t){return n(t?e:null)},group:e})})))}c.propTypes={expandedGroup:o.default.object,groups:o.default.arrayOf(o.default.object),heading:o.default.string,onExpandGroup:o.default.func}},{"./group-list-item":99,"./menu-section":112,preact:7,"prop-types":10}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=y(e("prop-types")),a=y(e("../service-config")),u=y(e("../store/use-store")),c=e("../util/account-id"),s=e("../util/group-list-item-common"),l=y(e("../util/group-organizations")),f=y(e("../util/is-third-party-service")),d=e("../util/service-context"),p=y(e("./group-list-section")),m=y(e("./menu")),h=y(e("./menu-item"));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){var t,n=e.serviceUrl,i=e.settings,d=(0,u.default)((function(e){return e.getCurrentlyViewingGroups()})),y=(0,u.default)((function(e){return e.getFeaturedGroups()})),g=(0,u.default)((function(e){return e.getMyGroups()})),b=(0,u.default)((function(e){return e.focusedGroup()})),_=(0,u.default)((function(e){return e.profile().userid})),w=(0,o.useMemo)((function(){return(0,l.default)(g)}),[g]),O=(0,o.useMemo)((function(){return(0,l.default)(y)}),[y]),E=(0,o.useMemo)((function(){return(0,l.default)(d)}),[d]),S=i.authDomain,A=_&&!(0,c.isThirdPartyUser)(_,S),j=n("groups.new"),k=v((0,o.useState)(null),2),T=k[0],P=k[1];if(b){var x=b.organization.logo||function(e){var t=(0,a.default)(e);return t&&t.icon?t.icon:null}(i)||"",N=(0,s.orgName)(b)?(0,s.orgName)(b):"";t=(0,r.createElement)("span",{className:"group-list__menu-label"},x&&(0,r.createElement)("img",{className:"group-list__menu-icon",src:x,alt:N}),b.name)}else t=(0,r.createElement)("span",null,"");if((0,f.default)(i)&&d.length+y.length+g.length<2)return t;var C=b?"Select group (now viewing: ".concat(b.name,")"):"Select group";return(0,r.createElement)(m.default,{align:"left",contentClass:"group-list__content",label:t,onOpenChanged:function(){return P(null)},title:C},E.length>0&&(0,r.createElement)(p.default,{expandedGroup:T,onExpandGroup:P,heading:"Currently Viewing",groups:E}),O.length>0&&(0,r.createElement)(p.default,{expandedGroup:T,onExpandGroup:P,heading:"Featured Groups",groups:O}),w.length>0&&(0,r.createElement)(p.default,{expandedGroup:T,onExpandGroup:P,heading:"My Groups",groups:w}),A&&(0,r.createElement)(h.default,{icon:"add",href:j,label:"New private group"}))}b.propTypes={serviceUrl:i.default.func,settings:i.default.object},b.injectedProps=["serviceUrl","settings"];var _=(0,d.withServices)(b);n.default=_},{"../service-config":149,"../store/use-store":188,"../util/account-id":191,"../util/group-list-item-common":201,"../util/group-organizations":202,"../util/is-third-party-service":205,"../util/service-context":215,"./group-list-section":100,"./menu":113,"./menu-item":110,preact:7,"preact/hooks":8,"prop-types":10}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=m(e("prop-types")),a=m(e("../store/use-store")),u=m(e("../ui-constants")),c=e("../util/service-context"),s=m(e("../util/version-data")),l=m(e("./sidebar-panel")),f=m(e("../../shared/components/svg-icon")),d=m(e("./tutorial")),p=m(e("./version-info"));function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){var t=e.linkText,n=e.url;return(0,r.createElement)("div",{className:"help-panel-tabs__tab"},(0,r.createElement)("a",{href:n,className:"help-panel-tabs__link",target:"_blank",rel:"noopener noreferrer"},t," ",(0,r.createElement)(f.default,{name:"external",className:"help-panel-tabs__icon",inline:!0})))}function g(e){var t=e.auth,n=e.session,i=(0,a.default)((function(e){return e.mainFrame()})),c=(0,a.default)((function(e){return!!e.profile().preferences.show_sidebar_tutorial})),m=h((0,o.useState)("tutorial"),2),y=m[0],g=m[1],b=(0,o.useMemo)((function(){var e=t||{status:"logged-out"},n=i||{};return new s.default(e,n)}),[t,i]),_="https://web.hypothes.is/get-help/?sys_info=".concat(b.asEncodedURLString()),w=function(e,t){e.preventDefault(),g(t)},O=n.dismissSidebarTutorial,E=(0,o.useCallback)((function(e){!e&&c&&O()}),[O,c]);return(0,r.createElement)(l.default,{title:"Help",panelName:u.default.PANEL_HELP,onActiveChanged:E},(0,r.createElement)("div",{className:"help-panel__content u-vertical-rhythm"},(0,r.createElement)("div",{className:"u-layout-row--align-middle"},(0,r.createElement)("h3",{className:"help-panel__sub-panel-title"},{tutorial:"Getting started",versionInfo:"About this version"}[y]),(0,r.createElement)("div",null,"versionInfo"===y&&(0,r.createElement)("button",{className:"help-panel__sub-panel-navigation-button",onClick:function(e){return w(e,"tutorial")},"aria-label":"Show tutorial panel"},"Getting started",(0,r.createElement)(f.default,{name:"arrow-right",className:"help-panel__sub-panel-link-icon"})),"tutorial"===y&&(0,r.createElement)("button",{className:"help-panel__sub-panel-navigation-button",onClick:function(e){return w(e,"versionInfo")},"aria-label":"Show version information panel"},"About this version",(0,r.createElement)(f.default,{name:"arrow-right"})))),(0,r.createElement)("div",{className:"help-panel__subcontent"},"tutorial"===y&&(0,r.createElement)(d.default,null),"versionInfo"===y&&(0,r.createElement)(p.default,{versionData:b})),(0,r.createElement)("div",{className:"help-panel-tabs"},(0,r.createElement)(v,{linkText:"Help topics",url:"https://web.hypothes.is/help/"}),(0,r.createElement)(v,{linkText:"New support ticket",url:_}))))}v.propTypes={linkText:i.default.string.isRequired,url:i.default.string.isRequired},g.propTypes={auth:i.default.object.isRequired,session:i.default.object.isRequired},g.injectedProps=["session"];var b=(0,c.withServices)(g);n.default=b},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../ui-constants":190,"../util/service-context":215,"../util/version-data":225,"./sidebar-panel":122,"./tutorial":136,"./version-info":138,preact:7,"preact/hooks":8,"prop-types":10}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){var u=function(e){var t=e.current.base?e.current.base:e.current;if("object"!==a(t))throw new Error("useElementShouldClose can not find a node reference");return t};(0,r.useEffect)((function(){if(!t)return function(){};var r=(0,i.listen)(document.body,["keydown"],(function(e){"Escape"===(0,o.normalizeKeyName)(e.key)&&n()})),a=(0,i.listen)(document.body,"focus",(function(t){u(e).contains(t.target)||n()}),{useCapture:!0}),c=(0,i.listen)(document.body,["mousedown","click"],(function(t){u(e).contains(t.target)||n()}),{useCapture:!0});return function(){r(),c(),a()}}),[e,t,n])};var r=e("preact/hooks"),o=e("../../../shared/browser-compatibility-utils"),i=e("../../util/dom");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../../../shared/browser-compatibility-utils":72,"../../util/dom":199,"preact/hooks":8}],104:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return(0,r.default)((function(e){return(0,o.default)(e.threadState())}))};var r=i(e("../../store/use-store")),o=i(e("../../util/thread-annotations"));function i(e){return e&&e.__esModule?e:{default:e}}},{"../../store/use-store":188,"../../util/thread-annotations":220}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=O(e("prop-types")),a=O(e("../../shared/bridge-events")),u=e("../../shared/user-agent"),c=O(e("../service-config")),s=O(e("../store/use-store")),l=O(e("../ui-constants")),f=e("../util/account-id"),d=e("../util/session"),p=e("../util/theme"),m=e("../util/service-context"),h=O(e("./annotation-viewer-content")),y=O(e("./help-panel")),v=O(e("./share-annotations-panel")),g=O(e("./sidebar-content")),b=O(e("./stream-content")),_=O(e("./toast-messages")),w=O(e("./top-bar"));function O(e){return e&&e.__esModule?e:{default:e}}function E(){}function S(e){var t=e.auth,n=e.bridge,i=e.serviceUrl,m=e.settings,O=e.session,S=e.toastMessenger,A=(0,s.default)((function(e){return e.clearGroups})),j=(0,s.default)((function(e){return e.closeSidebarPanel})),k=(0,s.default)((function(e){return e.countDrafts})),T=(0,s.default)((function(e){return e.discardAllDrafts})),P=(0,s.default)((function(e){return e.hasFetchedProfile()})),x=(0,s.default)((function(e){return e.openSidebarPanel})),N=(0,s.default)((function(e){return e.profile()})),C=(0,s.default)((function(e){return e.removeAnnotations})),M=(0,s.default)((function(e){return e.route()})),D=(0,s.default)((function(e){return e.unsavedAnnotations})),I=(0,o.useMemo)((function(){return P?function(e){var t=(0,f.parseAccountID)(e.userid);if(t){var n=t.username;return e.user_info&&e.user_info.display_name&&(n=e.user_info.display_name),{status:"logged-in",displayName:n,userid:e.userid,username:t.username,provider:t.provider}}return{status:"logged-out"}}(N):{status:"unknown"}}),[P,N]),L=(0,o.useMemo)((function(){return(0,p.applyTheme)(["appBackgroundColor"],m)}),[m]),R="sidebar"===M;(0,o.useEffect)((function(){(0,d.shouldAutoDisplayTutorial)(R,N,m)&&x(l.default.PANEL_HELP)}),[R,N,x,m]),(0,o.useEffect)((function(){(0,u.isIE11)()&&S.notice("Hypothesis is ending support for this browser (Internet Explorer 11) on July 1, 2020.",{autoDismiss:!1,moreInfoURL:"https://web.hypothes.is/help/which-browsers-are-supported-by-hypothesis/"})}),[S]);var F=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(){if(!(0,c.default)(m))return function(e){if(e&&e.then)return e.then(E)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return function(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(t.login(),(function(){j(l.default.PANEL_LOGIN_PROMPT),A(),O.reload()}))}),(function(e){S.error(e.message)})));n.call(a.default.LOGIN_REQUESTED)})),U=function(){(0,c.default)(m)?n.call(a.default.SIGNUP_REQUESTED):window.open(i("signup"))};return(0,r.createElement)("div",{className:"hypothesis-app js-thread-list-scroll-root",style:L},(0,r.createElement)(w.default,{auth:I,onLogin:F,onSignUp:U,onLogout:function(){var e,t;e="",1===(t=k())?e="You have an unsaved annotation.\nDo you really want to discard this draft?":t>1&&(e="You have "+t+" unsaved annotations.\nDo you really want to discard these drafts?"),(0===t||window.confirm(e))&&(A(),C(D()),T(),(0,c.default)(m)?n.call(a.default.LOGOUT_REQUESTED):O.logout())},isSidebar:R}),(0,r.createElement)("div",{className:"hypothesis-app__content"},(0,r.createElement)(_.default,null),(0,r.createElement)(y.default,{auth:I}),(0,r.createElement)(v.default,null),M&&(0,r.createElement)("main",null,"annotation"===M&&(0,r.createElement)(h.default,{onLogin:F}),"stream"===M&&(0,r.createElement)(b.default,null),"sidebar"===M&&(0,r.createElement)(g.default,{onLogin:F,onSignUp:U}))))}S.propTypes={auth:i.default.object,bridge:i.default.object,serviceUrl:i.default.func,settings:i.default.object,session:i.default.object,toastMessenger:i.default.object},S.injectedProps=["auth","bridge","serviceUrl","session","settings","toastMessenger"];var A=(0,m.withServices)(S);n.default=A},{"../../shared/bridge-events":70,"../../shared/user-agent":81,"../service-config":149,"../store/use-store":188,"../ui-constants":190,"../util/account-id":191,"../util/service-context":215,"../util/session":216,"../util/theme":219,"./annotation-viewer-content":93,"./help-panel":102,"./share-annotations-panel":118,"./sidebar-content":121,"./stream-content":126,"./toast-messages":134,"./top-bar":135,preact:7,"preact/hooks":8,"prop-types":10}],106:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=c(e("prop-types")),i=e("../util/service-context"),a=c(e("./button")),u=c(e("../../shared/components/svg-icon"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.onLogin,n=e.serviceUrl;return(0,r.createElement)("div",{className:"logged-out-message"},(0,r.createElement)("span",null,"This is a public annotation created with Hypothesis. ",(0,r.createElement)("br",null),"To reply or make your own annotations on this document,"," ",(0,r.createElement)("a",{className:"logged-out-message__link",href:n("signup"),target:"_blank",rel:"noopener noreferrer"},"create a free account")," ","or"," ",(0,r.createElement)(a.default,{className:"logged-out-message__link",onClick:t,buttonText:"log in"}),"."),(0,r.createElement)("div",{className:"logged-out-message__logo"},(0,r.createElement)("a",{href:"https://hypothes.is","aria-label":"Hypothesis homepage",title:"Hypothesis homepage"},(0,r.createElement)(u.default,{name:"logo",className:"logged-out-message__logo-icon"}))))}s.propTypes={onLogin:o.default.func.isRequired,serviceUrl:o.default.func.isRequired},s.injectedProps=["serviceUrl"];var l=(0,i.withServices)(s);n.default=l},{"../../shared/components/svg-icon":73,"../util/service-context":215,"./button":96,preact:7,"prop-types":10}],107:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var r=e("preact"),o=s(e("prop-types")),i=s(e("../store/use-store")),a=s(e("../ui-constants")),u=s(e("./button")),c=s(e("./sidebar-panel"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.onLogin,n=e.onSignUp;return(0,i.default)((function(e){return e.isLoggedIn()}))?null:(0,r.createElement)(c.default,{icon:"restricted",title:"Login needed",panelName:a.default.PANEL_LOGIN_PROMPT},(0,r.createElement)("p",null,"Please log in to create annotations or highlights."),(0,r.createElement)("div",{className:"sidebar-panel__actions"},(0,r.createElement)(u.default,{buttonText:"Sign up",className:"sidebar-panel__button",onClick:n}),(0,r.createElement)(u.default,{buttonText:"Log in",className:"sidebar-panel__button--primary",onClick:t})))}l.propTypes={onLogin:o.default.func.isRequired,onSignUp:o.default.func.isRequired}},{"../store/use-store":188,"../ui-constants":190,"./button":96,"./sidebar-panel":122,preact:7,"prop-types":10}],108:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=g;var r=d(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=d(e("prop-types")),u=e("../markdown-commands"),c=e("../../shared/browser-compatibility-utils"),s=e("../../shared/user-agent"),l=d(e("./markdown-view")),f=d(e("../../shared/components/svg-icon"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h={bold:"b",italic:"i",link:"l",quote:"q",image:"g",numlist:"o",list:"u"};function y(e){var t=e.buttonRef,n=e.disabled,a=void 0!==n&&n,u=e.iconName,c=e.label,l=e.onClick,d=e.shortcutKey,p=e.tabIndex,m=e.title,h=void 0===m?"":m,y=(0,i.useMemo)((function(){return(0,s.isMacOS)()?"Cmd":"Ctrl"}),[]),v=h;return d&&(v+=" (".concat(y,"-").concat(d.toUpperCase(),")")),(0,o.createElement)("button",{className:(0,r.default)("markdown-editor__toolbar-button",c&&"is-text"),disabled:a,onClick:l,"aria-label":v,title:v,tabIndex:p,ref:t},u&&(0,o.createElement)(f.default,{name:u,className:"markdown-editor__toolbar-button-icon"}),c)}function v(e){var t=e.isPreviewing,n=e.onCommand,r=e.onTogglePreview,a=p((0,i.useState)(0),2),u=a[0],s=a[1],l=(0,i.useRef)([]).current;if(0===l.length)for(var d=0;d<=10;d++)l.push((0,o.createRef)());var m=function(e){return u===e?0:-1};return(0,o.createElement)("div",{className:"markdown-editor__toolbar",role:"toolbar","aria-label":"Markdown editor toolbar",onKeyDown:function(e){var n=0;t&&(n=8);var r,o=null;switch((0,c.normalizeKeyName)(e.key)){case"ArrowLeft":o=u<=n?9:u-1;break;case"ArrowRight":o=u>=9?n:u+1;break;case"Home":o=n;break;case"End":o=9}null!==o&&(s(r=o),l[r].current.focus(),e.preventDefault())}},(0,o.createElement)(y,{disabled:t,iconName:"format-bold",onClick:function(){return n("bold")},shortcutKey:h.bold,buttonRef:l[0],tabIndex:m(0),title:"Bold"}),(0,o.createElement)(y,{disabled:t,iconName:"format-italic",onClick:function(){return n("italic")},shortcutKey:h.italic,buttonRef:l[1],tabIndex:m(1),title:"Italic"}),(0,o.createElement)(y,{disabled:t,iconName:"format-quote",onClick:function(){return n("quote")},shortcutKey:h.quote,buttonRef:l[2],tabIndex:m(2),title:"Quote"}),(0,o.createElement)(y,{disabled:t,iconName:"link",onClick:function(){return n("link")},shortcutKey:h.link,buttonRef:l[3],tabIndex:m(3),title:"Insert link"}),(0,o.createElement)(y,{disabled:t,iconName:"image",onClick:function(){return n("image")},shortcutKey:h.image,buttonRef:l[4],tabIndex:m(4),title:"Insert image"}),(0,o.createElement)(y,{disabled:t,iconName:"format-functions",onClick:function(){return n("math")},buttonRef:l[5],tabIndex:m(5),title:"Insert math (LaTeX is supported)"}),(0,o.createElement)(y,{disabled:t,iconName:"format-list-numbered",onClick:function(){return n("numlist")},shortcutKey:h.numlist,buttonRef:l[6],tabIndex:m(6),title:"Numbered list"}),(0,o.createElement)(y,{disabled:t,iconName:"format-list-unordered",onClick:function(){return n("list")},shortcutKey:h.list,buttonRef:l[7],tabIndex:m(7),title:"Bulleted list"}),(0,o.createElement)("span",{className:"u-stretch"}),(0,o.createElement)("div",{className:"markdown-editor__toolbar-help-link"},(0,o.createElement)("a",{href:"https://web.hypothes.is/help/formatting-annotations-with-markdown/",target:"_blank",rel:"noopener noreferrer",className:"markdown-editor__toolbar-button",ref:l[8],tabIndex:m(8),title:"Formatting help","aria-label":"Formatting help"},(0,o.createElement)(f.default,{name:"help",className:"markdown-editor__toolbar-button-icon"}))),(0,o.createElement)(y,{label:t?"Write":"Preview",onClick:r,buttonRef:l[9],tabIndex:m(9)}))}function g(e){var t=e.label,n=void 0===t?"":t,r=e.onEditText,a=void 0===r?function(){}:r,s=e.text,f=void 0===s?"":s,d=e.textStyle,m=void 0===d?{}:d,y=p((0,i.useState)(!1),2),g=y[0],b=y[1],_=(0,i.useRef)(null);(0,i.useEffect)((function(){g||_.current.focus()}),[g]);var w=function(e){var t=_.current;(function(e,t){var n=function(e){var n=e({text:t.value,selectionStart:t.selectionStart,selectionEnd:t.selectionEnd});t.value=n.text,t.selectionStart=n.selectionStart,t.selectionEnd=n.selectionEnd,t.focus()};switch(e){case"bold":n((function(e){return(0,u.toggleSpanStyle)(e,"**","**","Bold")}));break;case"italic":n((function(e){return(0,u.toggleSpanStyle)(e,"*","*","Italic")}));break;case"quote":n((function(e){return(0,u.toggleBlockStyle)(e,"> ")}));break;case"link":n((function(e){return(0,u.convertSelectionToLink)(e)}));break;case"image":n((function(e){return(0,u.convertSelectionToLink)(e,u.LinkType.IMAGE_LINK)}));break;case"math":n((function(e){var t=e.text.slice(0,e.selectionStart);return 0===t.length||"\n"===t.slice(-1)||"$$"===t.slice(-2)?(0,u.toggleSpanStyle)(e,"$$","$$","Insert LaTeX"):(0,u.toggleSpanStyle)(e,"\\(","\\)","Insert LaTeX")}));break;case"numlist":n((function(e){return(0,u.toggleBlockStyle)(e,"1. ")}));break;case"list":n((function(e){return(0,u.toggleBlockStyle)(e,"* ")}));break;default:throw new Error('Unknown toolbar command "'.concat(e,'"'))}})(e,t),a({text:t.value})};return(0,o.createElement)("div",null,(0,o.createElement)(v,{onCommand:w,isPreviewing:g,onTogglePreview:function(){return b(!g)}}),g?(0,o.createElement)(l.default,{markdown:f,textClass:{"markdown-editor__preview":!0},textStyle:m}):(0,o.createElement)("textarea",{"aria-label":n,className:"markdown-editor__input",dir:"auto",ref:_,onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){if(e.ctrlKey||e.metaKey)for(var t=0,n=Object.entries(h);t<n.length;t++){var r=p(n[t],2),o=r[0];r[1]===(0,c.normalizeKeyName)(e.key)&&(e.stopPropagation(),e.preventDefault(),w(o))}},onInput:function(e){a({text:e.target.value})},value:f,style:m}))}y.propTypes={buttonRef:a.default.object.isRequired,disabled:a.default.bool,iconName:a.default.string,label:a.default.string,onClick:a.default.func.isRequired,shortcutKey:a.default.string,tabIndex:a.default.number.isRequired,title:a.default.string},v.propTypes={isPreviewing:a.default.bool,onCommand:a.default.func,onTogglePreview:a.default.func},g.propTypes={textStyle:a.default.object,label:a.default.string.isRequired,text:a.default.string,onEditText:a.default.func}},{"../../shared/browser-compatibility-utils":72,"../../shared/components/svg-icon":73,"../../shared/user-agent":81,"../markdown-commands":145,"./markdown-view":109,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],109:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var r=s(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=s(e("prop-types")),u=e("../media-embedder"),c=s(e("../render-markdown"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.markdown,n=void 0===t?"":t,a=e.textClass,s=void 0===a?{}:a,l=e.textStyle,f=void 0===l?{}:l,d=(0,i.useMemo)((function(){return n?(0,c.default)(n):""}),[n]),p=(0,i.useRef)(null);return(0,i.useEffect)((function(){(0,u.replaceLinksWithEmbeds)(p.current,{className:"markdown-view__embed"})}),[n]),(0,o.createElement)("div",{className:(0,r.default)("markdown-view",s),dir:"auto",lang:"",ref:p,dangerouslySetInnerHTML:{__html:d},style:f})}l.propTypes={markdown:a.default.string,textClass:a.default.object,textStyle:a.default.object}},{"../media-embedder":146,"../render-markdown":147,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;var r=f(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=f(e("prop-types")),u=e("../../shared/browser-compatibility-utils"),c=f(e("../../shared/components/svg-icon")),s=f(e("./menu-keyboard-navigation")),l=f(e("./slider"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=e.href,n=e.icon,a=e.iconAlt,f=e.isDisabled,d=e.isExpanded,p=e.isSelected,m=e.isSubmenuItem,h=e.isSubmenuVisible,y=e.label,v=e.onClick,g=e.onToggleSubmenu,b=e.submenu,_=n&&-1!==n.indexOf("/"),w=n||m,O=n&&m,E=(0,i.useRef)(null),S=null,A=null;"blank"!==n&&(A=_?(0,o.createElement)("img",{className:"menu-item__icon",alt:a,src:n}):(0,o.createElement)(c.default,{name:n,className:"menu-item__icon"}));var j,k=m?null:A,T=m?A:null,P="boolean"==typeof h,x="boolean"==typeof p;(0,i.useEffect)((function(){return function(){clearTimeout(S)}}),[]);var N=function(e){switch((0,u.normalizeKeyName)(e.key)){case"ArrowRight":g&&(e.stopPropagation(),e.preventDefault(),g(e));break;case"Enter":case" ":v&&v(e)}};return j=t?(0,o.createElement)("a",{ref:E,className:(0,r.default)("menu-item",{"is-submenu":m,"is-disabled":f}),href:t,target:"_blank",tabIndex:-1,rel:"noopener noreferrer",role:"menuitem",onKeyDown:N},w&&(0,o.createElement)("div",{className:"menu-item__icon-container"},k),(0,o.createElement)("span",{className:"menu-item__label"},y),O&&(0,o.createElement)("div",{className:"menu-item__icon-container"},T)):(0,o.createElement)("div",{ref:E,className:(0,r.default)("menu-item",{"is-submenu":m,"is-disabled":f,"is-expanded":d,"is-selected":p}),tabIndex:-1,onKeyDown:N,onClick:v,role:x?"menuitemradio":"menuitem","aria-checked":x?p:void 0,"aria-haspopup":P,"aria-expanded":P?h:void 0},w&&(0,o.createElement)("div",{className:"menu-item__icon-container"},k),(0,o.createElement)("span",{className:"menu-item__label"},y),O&&(0,o.createElement)("div",{className:"menu-item__icon-container"},T),P&&(0,o.createElement)("div",{role:"none",icon:h?"collapse-menu":"expand-menu",className:"menu-item__toggle",onClick:g,title:"Show actions for ".concat(y)},(0,o.createElement)(c.default,{name:h?"collapse-menu":"expand-menu",className:"menu-item__toggle-icon"}))),(0,o.createElement)(o.Fragment,null,j,P&&(0,o.createElement)(l.default,{visible:h},(0,o.createElement)(s.default,{closeMenu:function(e){g&&g(e),S=setTimeout((function(){E.current.focus()}))},visible:h,className:"menu-item__submenu"},b)))}d.propTypes={href:a.default.string,iconAlt:a.default.string,icon:a.default.string,isDisabled:a.default.bool,isExpanded:a.default.bool,isSelected:a.default.bool,isSubmenuItem:a.default.bool,isSubmenuVisible:a.default.bool,label:a.default.string.isRequired,onClick:a.default.func,onToggleSubmenu:a.default.func,submenu:a.default.any}},{"../../shared/browser-compatibility-utils":72,"../../shared/components/svg-icon":73,"./menu-keyboard-navigation":111,"./slider":123,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var r,o=e("preact"),i=e("preact/hooks"),a=(r=e("prop-types"))&&r.__esModule?r:{default:r},u=e("../../shared/browser-compatibility-utils");function c(e){return null!==e.offsetParent}function s(e){var t=e.className,n=e.closeMenu,r=e.children,a=e.visible,s=(0,i.useRef)(null);return(0,i.useEffect)((function(){var e=null;return a&&(e=setTimeout((function(){var e=s.current.querySelector('[role^="menuitem"]');e&&e.focus()}))),function(){clearTimeout(e)}}),[a]),(0,o.createElement)("div",{role:"menu",className:t,ref:s,onKeyDown:function(e){var t=Array.from(s.current.querySelectorAll('[role^="menuitem"]')).filter(c),r=t.findIndex((function(e){return e.contains(document.activeElement)})),o=!1;switch((0,u.normalizeKeyName)(e.key)){case"ArrowLeft":case"Escape":n&&(n(e),o=!0);break;case"ArrowUp":(r-=1)<0&&(r=t.length-1),o=!0;break;case"ArrowDown":(r+=1)===t.length&&(r=0),o=!0;break;case"Home":r=0,o=!0;break;case"End":r=t.length-1,o=!0}o&&r>=0&&(e.stopPropagation(),e.preventDefault(),t[r].focus())}},r)}s.propTypes={className:a.default.string,closeMenu:a.default.func,visible:a.default.bool,children:a.default.any.isRequired}},{"../../shared/browser-compatibility-utils":72,preact:7,"preact/hooks":8,"prop-types":10}],112:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var r,o=e("preact"),i=(r=e("prop-types"))&&r.__esModule?r:{default:r};function a(e){var t=e.heading,n=e.children;return(0,o.createElement)(o.Fragment,null,t&&(0,o.createElement)("h2",{className:"menu-section__heading"},t),(0,o.createElement)("ul",{className:"menu-section__content"},(0,o.toChildArray)(n).map((function(e){return(0,o.createElement)("li",{key:e.key},e)}))))}a.propTypes={heading:i.default.string,children:i.default.any.isRequired}},{preact:7,"prop-types":10}],113:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var r=f(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=f(e("prop-types")),u=f(e("./hooks/use-element-should-close")),c=e("../../shared/browser-compatibility-utils"),s=f(e("../../shared/components/svg-icon")),l=f(e("./menu-keyboard-navigation"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=!1;function h(e){var t=e.align,n=void 0===t?"left":t,a=e.arrowClass,f=void 0===a?"":a,p=e.children,h=e.containerPositioned,y=void 0===h||h,v=e.contentClass,g=e.defaultOpen,b=void 0!==g&&g,_=e.label,w=e.onOpenChanged,O=e.menuIndicator,E=void 0===O||O,S=e.title,A=d((0,i.useState)(b),2),j=A[0],k=A[1],T=(0,i.useRef)(j);(0,i.useEffect)((function(){"function"==typeof w&&T.current!==j&&(T.current=j,w(j))}),[j,w]);var P=function(e){if("mousedown"===e.type)m=!0;else if("click"===e.type&&m)return m=!1,e.stopPropagation(),void e.preventDefault();k(!j)},x=(0,i.useCallback)((function(){return k(!1)}),[k]),N=(0,i.useRef)(null);(0,u.default)(N,j,x);var C=function(e){return e.stopPropagation()},M={position:y?"relative":"static"};return(0,o.createElement)("div",{className:"menu",ref:N,style:M,onClick:C,onMouseDown:C},(0,o.createElement)("button",{"aria-expanded":j?"true":"false","aria-haspopup":!0,className:"menu__toggle",onMouseDown:P,onClick:P,"aria-label":S,title:S},(0,o.createElement)("span",{className:"menu__toggle-wrapper"},_,E&&(0,o.createElement)("span",{className:(0,r.default)("menu__toggle-arrow",j&&"is-open")},(0,o.createElement)(s.default,{name:"expand-menu",className:"menu__toggle-icon"})))),j&&(0,o.createElement)(o.Fragment,null,function(e){return(0,o.createElement)("svg",{className:(0,r.default)("menu__arrow",e),width:15,height:8},(0,o.createElement)("path",{d:"M0 8 L7 0 L15 8",stroke:"currentColor",strokeWidth:"2"}))}(f),(0,o.createElement)("div",{className:(0,r.default)("menu__content","menu__content--align-".concat(n),v),role:"menu",tabIndex:-1,onClick:x,onKeyDown:function(e){var t=(0,c.normalizeKeyName)(e.key);"Enter"!==t&&" "!==t||setTimeout((function(){x()}))}},(0,o.createElement)(l.default,{visible:!0},p))))}h.propTypes={align:a.default.oneOf(["left","right"]),arrowClass:a.default.string,label:a.default.oneOfType([a.default.object.isRequired,a.default.string.isRequired]),children:a.default.any,containerPositioned:a.default.bool,contentClass:a.default.string,defaultOpen:a.default.bool,onOpenChanged:a.default.func,title:a.default.string.isRequired,menuIndicator:a.default.bool}},{"../../shared/browser-compatibility-utils":72,"../../shared/components/svg-icon":73,"./hooks/use-element-should-close":103,"./menu-keyboard-navigation":111,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],114:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=f(e("classnames")),i=e("preact"),a=f(e("prop-types")),u=f(e("../store/use-store")),c=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util/annotation-metadata")),s=e("../util/service-context");function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e){return e&&e.__esModule?e:{default:e}}function d(e){var t,n=e.annotation,r=e.api,a=e.toastMessenger,s=(0,u.default)((function(e){return{hide:e.hideAnnotation,unhide:e.unhideAnnotation}})),l=c.flagCount(n),f=null!==l&&(l>0||n.hidden),d=(t={},n.hidden?(t.onClick=function(){r.annotation.unhide({id:n.id}).then((function(){s.unhide(n.id)})).catch((function(){a.error("Failed to unhide annotation")}))},t.title="Make this annotation visible to everyone"):(t.onClick=function(){r.annotation.hide({id:n.id}).then((function(){s.hide(n.id)})).catch((function(){a.error("Failed to hide annotation")}))},t.title="Hide this annotation from non-moderators"),t["aria-label"]=t.title,t),p=(0,o.default)("moderation-banner",{"is-flagged":null!==l&&l>0,"is-hidden":n.hidden,"is-reply":c.isReply(n)});return f?(0,i.createElement)("div",{className:p},!!l&&!n.hidden&&(0,i.createElement)("span",null,"Flagged for review x",l),n.hidden&&(0,i.createElement)("span",null,"Hidden from users. Flagged x",l),(0,i.createElement)("span",{className:"u-stretch"}),(0,i.createElement)("button",d,n.hidden?"Unhide":"Hide")):null}d.propTypes={annotation:a.default.object.isRequired,api:a.default.object.isRequired,toastMessenger:a.default.object.isRequired},d.injectedProps=["api","toastMessenger"];var p=(0,s.withServices)(d);n.default=p},{"../store/use-store":188,"../util/annotation-metadata":192,"../util/service-context":215,classnames:1,preact:7,"prop-types":10}],115:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=l(e("prop-types")),i=l(e("../ui-constants")),a=l(e("../store/use-store")),u=e("../util/service-context"),c=e("../util/theme"),s=l(e("./button"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){var t=e.annotationsService,n=e.settings,o=(0,a.default)((function(e){return e.mainFrame()})),u=(0,a.default)((function(e){return e.isLoggedIn()})),l=(0,a.default)((function(e){return e.openSidebarPanel}));return(0,r.createElement)("div",{className:"u-layout-row--justify-right"},(0,r.createElement)(s.default,{buttonText:"New note",className:"button--primary",icon:"add",onClick:function(){if(u){if(o){var e={target:[],uri:o.uri};t.create(e)}}else l(i.default.PANEL_LOGIN_PROMPT)},style:(0,c.applyTheme)(["ctaBackgroundColor"],n)}))}f.propTypes={annotationsService:o.default.object.isRequired,settings:o.default.object.isRequired},f.injectedProps=["annotationsService","settings"];var d=(0,u.withServices)(f);n.default=d},{"../store/use-store":188,"../ui-constants":190,"../util/service-context":215,"../util/theme":219,"./button":96,preact:7,"prop-types":10}],116:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;var r=l(e("classnames")),o=e("preact"),i=e("preact/hooks"),a=l(e("prop-types")),u=l(e("../store/use-store")),c=l(e("./button")),s=l(e("./spinner"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=e.alwaysExpanded,n=e.query,a=e.onSearch,l=(0,u.default)((function(e){return e.isLoading()})),d=(0,i.useRef)(null),p=f((0,i.useState)(n),2),m=p[0],h=p[1],y=f((0,i.useState)(n),2),v=y[0],g=y[1];return n!==m&&(g(n),h(n)),(0,o.createElement)("form",{action:"#",className:"search-input__form",name:"searchForm",onSubmit:function(e){e.preventDefault(),(d.current.value||m)&&a(d.current.value)}},(0,o.createElement)("input",{"aria-label":"Search",className:(0,r.default)("search-input__input",{"is-expanded":t||n}),dir:"auto",type:"text",name:"query",placeholder:l?"Loading":"Search",disabled:l,ref:d,value:v||"",onInput:function(e){return g(e.target.value)}}),!l&&(0,o.createElement)(c.default,{className:"search-input__icon-button top-bar__icon-button",icon:"search",onClick:function(){return d.current.focus()},title:"Search annotations"}),l&&(0,o.createElement)(s.default,null))}p.propTypes={alwaysExpanded:a.default.bool,query:a.default.string,onSearch:a.default.func}},{"../store/use-store":188,"./button":96,"./spinner":125,classnames:1,preact:7,"preact/hooks":8,"prop-types":10}],117:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=f(e("classnames")),o=e("preact"),i=f(e("prop-types")),a=f(e("../store/use-store")),u=f(e("../ui-constants")),c=e("../util/service-context"),s=f(e("./new-note-btn")),l=f(e("../../shared/components/svg-icon"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=e.children,n=e.count,i=e.isWaitingToAnchor,a=e.isSelected,u=e.label,c=e.onSelect,s=function(){a||c()},l=n>0?"".concat(u," (").concat(n," available)"):u;return(0,o.createElement)("div",null,(0,o.createElement)("button",{className:(0,r.default)("selection-tabs__type",{"is-selected":a}),onClick:s,onMouseDown:s,role:"tab",tabIndex:0,title:l,"aria-label":l,"aria-selected":a.toString()},t,n>0&&!i&&(0,o.createElement)("span",{className:"selection-tabs__count"}," ",n)))}function p(e){var t=e.isLoading,n=e.settings,i=(0,a.default)((function(e){return e.getState().selection.selectedTab})),c=(0,a.default)((function(e){return e.noteCount()})),f=(0,a.default)((function(e){return e.annotationCount()})),p=(0,a.default)((function(e){return e.orphanCount()})),m=(0,a.default)((function(e){return e.isWaitingToAnchorAnnotations()})),h=(0,a.default)((function(e){return{clearSelection:e.clearSelection,selectTab:e.selectTab}})),y="clean"===n.theme,v=function(e){h.clearSelection(),h.selectTab(e)},g=i===u.default.TAB_ANNOTATIONS&&0===f&&!m,b=i===u.default.TAB_NOTES&&0===c;return(0,o.createElement)("div",{className:"selection-tabs-container"},(0,o.createElement)("div",{className:(0,r.default)("selection-tabs",{"selection-tabs--theme-clean":y}),role:"tablist"},(0,o.createElement)(d,{count:f,isWaitingToAnchor:m,isSelected:i===u.default.TAB_ANNOTATIONS,label:"Annotations",onSelect:function(){return v(u.default.TAB_ANNOTATIONS)}},"Annotations"),(0,o.createElement)(d,{count:c,isWaitingToAnchor:m,isSelected:i===u.default.TAB_NOTES,label:"Page notes",onSelect:function(){return v(u.default.TAB_NOTES)}},"Page Notes"),p>0&&(0,o.createElement)(d,{count:p,isWaitingToAnchor:m,isSelected:i===u.default.TAB_ORPHANS,label:"Orphans",onSelect:function(){return v(u.default.TAB_ORPHANS)}},"Orphans")),i===u.default.TAB_NOTES&&n.enableExperimentalNewNoteButton&&(0,o.createElement)(s.default,null),!t&&b&&(0,o.createElement)("div",{className:"selection-tabs__message"},"There are no page notes in this group."),!t&&g&&(0,o.createElement)("div",{className:"selection-tabs__message"},"There are no annotations in this group.",(0,o.createElement)("br",null),"Create one by selecting some text and clicking the"," ",(0,o.createElement)(l.default,{name:"annotate",inline:!0,className:"selection-tabs__icon"})," ","button."))}d.propTypes={children:i.default.node.isRequired,count:i.default.number.isRequired,isSelected:i.default.bool.isRequired,isWaitingToAnchor:i.default.bool.isRequired,label:i.default.string.isRequired,onSelect:i.default.func.isRequired},p.propTypes={isLoading:i.default.bool.isRequired,settings:i.default.object.isRequired},p.injectedProps=["settings"];var m=(0,c.withServices)(p);n.default=m},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../ui-constants":190,"../util/service-context":215,"./new-note-btn":115,classnames:1,preact:7,"prop-types":10}],118:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=p(e("prop-types")),i=p(e("../store/use-store")),a=p(e("../ui-constants")),u=e("../util/copy-to-clipboard"),c=e("../util/service-context"),s=p(e("./button")),l=p(e("./share-links")),f=p(e("./sidebar-panel")),d=p(e("../../shared/components/svg-icon"));function p(e){return e&&e.__esModule?e:{default:e}}function m(e){var t,n,o=e.analytics,c=e.toastMessenger,p=(0,i.default)((function(e){return e.mainFrame()})),m=(0,i.default)((function(e){return e.focusedGroup()})),h=m&&m.name||"...",y="Share Annotations in ".concat(h),v=(t=p,(n=m)&&t?"https://hyp.is/go?url=".concat(encodeURIComponent(t.uri),"&group=").concat(n.id):"");return(0,r.createElement)(f.default,{title:y,panelName:a.default.PANEL_SHARE_ANNOTATIONS},m&&p&&(0,r.createElement)("div",{className:"share-annotations-panel"},(0,r.createElement)("div",{className:"share-annotations-panel__intro"},"private"===m.type?(0,r.createElement)("p",null,"Use this link to share these annotations with other group members:"):(0,r.createElement)("p",null,"Use this link to share these annotations with anyone:")),(0,r.createElement)("div",{className:"u-layout-row"},(0,r.createElement)("input",{"aria-label":"Use this URL to share these annotations",className:"share-annotations-panel__form-input",type:"text",value:v,readOnly:!0}),(0,r.createElement)(s.default,{icon:"copy",onClick:function(){try{(0,u.copyText)(v),c.success("Copied share link to clipboard")}catch(e){c.error("Unable to copy link")}},title:"Copy share link",className:"share-annotations-panel__icon-button"})),(0,r.createElement)("p",null,"private"===m.type?(0,r.createElement)("span",null,"Annotations in the private group ",(0,r.createElement)("em",null,m.name)," ","are only visible to group members."):(0,r.createElement)("span",null,"Anyone using this link may view the annotations in the group"," ",(0,r.createElement)("em",null,m.name),".")," ",(0,r.createElement)("span",null,"Private (",(0,r.createElement)(d.default,{name:"lock",inline:!0,className:"u-icon--inline"})," ",(0,r.createElement)("em",null,"Only Me"),") annotations are only visible to you.")),(0,r.createElement)(l.default,{shareURI:v,analyticsEventName:o.events.DOCUMENT_SHARED})))}m.propTypes={analytics:o.default.object.isRequired,toastMessenger:o.default.object.isRequired},m.injectedProps=["analytics","toastMessenger"];var h=(0,c.withServices)(m);n.default=h},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../ui-constants":190,"../util/copy-to-clipboard":196,"../util/service-context":215,"./button":96,"./share-links":119,"./sidebar-panel":122,preact:7,"prop-types":10}],119:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=u(e("prop-types")),i=e("../util/service-context"),a=u(e("../../shared/components/svg-icon"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=e.label,n=e.iconName,o=e.uri,i=e.onClick;return(0,r.createElement)("li",{className:"share-links__link"},(0,r.createElement)("a",{"aria-label":t,href:o,title:t,onClick:i,target:"_blank",rel:"noopener noreferrer"},(0,r.createElement)(a.default,{name:n,className:"share-links__icon"})))}function s(e){var t=e.analytics,n=e.analyticsEventName,o=e.shareURI,i=function(e){return function(){t.track(n,e)}},a=encodeURIComponent(o);return(0,r.createElement)("ul",{className:"share-links"},(0,r.createElement)(c,{iconName:"twitter",label:"Tweet share link",uri:"https://twitter.com/intent/tweet?url=".concat(a,"&hashtags=annotated"),onClick:i("twitter")}),(0,r.createElement)(c,{iconName:"facebook",label:"Share on Facebook",uri:"https://www.facebook.com/sharer/sharer.php?u=".concat(a),onClick:i("facebook")}),(0,r.createElement)(c,{iconName:"email",label:"Share via email",uri:"mailto:?subject=".concat(encodeURIComponent("Let's Annotate"),"&body=").concat(a),onClick:i("email")}))}c.propTypes={iconName:o.default.string.isRequired,label:o.default.string.isRequired,uri:o.default.string.isRequired,onClick:o.default.func.isRequired},s.propTypes={analyticsEventName:o.default.string.isRequired,shareURI:o.default.string.isRequired,analytics:o.default.object.isRequired},s.injectedProps=["analytics"];var l=(0,i.withServices)(s);n.default=l},{"../../shared/components/svg-icon":73,"../util/service-context":215,preact:7,"prop-types":10}],120:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var r=e("preact"),o=s(e("classnames")),i=s(e("prop-types")),a=s(e("../store/use-store")),u=s(e("./button")),c=s(e("../../shared/components/svg-icon"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.errorType,n=e.onLoginRequest,i=e.showClearSelection,s=void 0!==i&&i,l=(0,a.default)((function(e){return e.clearSelection})),f=(0,a.default)((function(e){return e.isLoggedIn()})),d="annotation"===t?"Annotation unavailable":"Group unavailable",p=f?"group"===t?"The current URL links to a group, but that group cannot be found,\n        or you do not have permission to view the annotations in that group.":"The current URL links to an annotation, but that annotation\n      cannot be found, or you do not have permission to view it.":"The ".concat(t," associated with the current URL is unavailable.\n        You may need to log in to see it.");return(0,r.createElement)("div",{className:"sidebar-content-error"},(0,r.createElement)("div",{className:"sidebar-content-error__header"},(0,r.createElement)("div",{className:"sidebar-content-error__header-icon"},(0,r.createElement)(c.default,{name:"restricted",title:d})),(0,r.createElement)("div",{className:"sidebar-content-error__title u-stretch"},d)),(0,r.createElement)("div",{className:"sidebar-content-error__content"},(0,r.createElement)("p",null,p),(0,r.createElement)("div",{className:"sidebar-content-error__actions"},s&&(0,r.createElement)(u.default,{buttonText:"Show all annotations",className:(0,o.default)({"sidebar-content-error__button":!f,"sidebar-content-error__button--primary":f}),onClick:l}),!f&&(0,r.createElement)(u.default,{buttonText:"Log in",className:"sidebar-content-error__button--primary",onClick:n}))))}l.propTypes={errorType:i.default.oneOf(["annotation","group"]).isRequired,showClearSelection:i.default.bool,onLoginRequest:i.default.func.isRequired}},{"../../shared/components/svg-icon":73,"../store/use-store":188,"./button":96,classnames:1,preact:7,"prop-types":10}],121:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=y(e("prop-types")),i=e("preact/hooks"),a=y(e("./hooks/use-root-thread")),u=e("../util/service-context"),c=y(e("../store/use-store")),s=e("../util/tabs"),l=y(e("./filter-status")),f=y(e("./logged-out-message")),d=y(e("./login-prompt-panel")),p=y(e("./selection-tabs")),m=y(e("./sidebar-content-error")),h=y(e("./thread-list"));function y(e){return e&&e.__esModule?e:{default:e}}function v(e){var t=e.frameSync,n=e.onLogin,o=e.onSignUp,u=e.loadAnnotationsService,y=e.streamer,v=(0,a.default)(),g=(0,c.default)((function(e){return e.focusedGroupId()})),b=(0,c.default)((function(e){return e.hasAppliedFilter()})),_=(0,c.default)((function(e){return e.isLoading()})),w=(0,c.default)((function(e){return e.isLoggedIn()})),O=(0,c.default)((function(e){return e.directLinkedAnnotationId()})),E=(0,c.default)((function(e){return O?e.findAnnotationByID(O):void 0})),S=E?(0,s.tabForAnnotation)(E):"annotation",A=(0,c.default)((function(e){return e.searchUris()})),j=(0,c.default)((function(e){return e.hasSidebarOpened()})),k=(0,c.default)((function(e){return e.profile().userid})),T=E&&!1===E.$orphan?E.$tag:null,P=(0,c.default)((function(e){return e.clearSelection})),x=(0,c.default)((function(e){return e.selectTab})),N=!(_||!O||E),C=(0,c.default)((function(e){return e.directLinkedGroupFetchFailed()})),M=N||C,D=!M,I=!M&&!b,L=O&&!w&&!N&&!_,R=(0,i.useRef)(g);return(0,i.useEffect)((function(){R.current&&R.current===g||(P(),R.current=g),g&&A.length&&u.load(A,g)}),[P,u,g,k,A]),(0,i.useEffect)((function(){T&&(t.focusAnnotations([T]),t.scrollToAnnotation(T),x(S))}),[S,t,T,x]),(0,i.useEffect)((function(){(j||w)&&y.connect()}),[y,j,w]),(0,r.createElement)("div",null,(0,r.createElement)("h2",{className:"u-screen-reader-only"},"Annotations"),D&&(0,r.createElement)(l.default,null),(0,r.createElement)(d.default,{onLogin:n,onSignUp:o}),N&&(0,r.createElement)(m.default,{errorType:"annotation",onLoginRequest:n,showClearSelection:!0}),C&&(0,r.createElement)(m.default,{errorType:"group",onLoginRequest:n}),I&&(0,r.createElement)(p.default,{isLoading:_}),(0,r.createElement)(h.default,{thread:v}),L&&(0,r.createElement)(f.default,{onLogin:n}))}v.propTypes={onLogin:o.default.func.isRequired,onSignUp:o.default.func.isRequired,frameSync:o.default.object,loadAnnotationsService:o.default.object,streamer:o.default.object},v.injectedProps=["frameSync","loadAnnotationsService","streamer"];var g=(0,u.withServices)(v);n.default=g},{"../store/use-store":188,"../util/service-context":215,"../util/tabs":218,"./filter-status":98,"./hooks/use-root-thread":104,"./logged-out-message":106,"./login-prompt-panel":107,"./selection-tabs":117,"./sidebar-content-error":120,"./thread-list":131,preact:7,"preact/hooks":8,"prop-types":10}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;var r=e("preact"),o=e("preact/hooks"),i=f(e("prop-types")),a=f(e("scroll-into-view")),u=f(e("../store/use-store")),c=f(e("./button")),s=f(e("./slider")),l=f(e("../../shared/components/svg-icon"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=e.children,n=e.icon,i=void 0===n?"":n,f=e.panelName,d=e.title,p=e.onActiveChanged,m=(0,u.default)((function(e){return e.isSidebarPanelOpen(f)})),h=(0,u.default)((function(e){return e.toggleSidebarPanel})),y=(0,o.useRef)(null),v=(0,o.useRef)(m);return(0,o.useEffect)((function(){v.current!==m&&(v.current=m,m&&(0,a.default)(y.current),"function"==typeof p&&p(m))}),[m,p]),(0,r.createElement)(s.default,{visible:m},(0,r.createElement)("div",{className:"sidebar-panel",ref:y},(0,r.createElement)("div",{className:"sidebar-panel__header"},i&&(0,r.createElement)("div",{className:"sidebar-panel__header-icon"},(0,r.createElement)(l.default,{name:i,title:d})),(0,r.createElement)("h2",{className:"sidebar-panel__title u-stretch"},d),(0,r.createElement)("div",null,(0,r.createElement)(c.default,{icon:"cancel",buttonText:"Close",onClick:function(){h(f,!1)}}))),(0,r.createElement)("div",{className:"sidebar-panel__content"},t)))}d.propTypes={children:i.default.any,icon:i.default.string,panelName:i.default.string.isRequired,title:i.default.string.isRequired,onActiveChanged:i.default.func}},{"../../shared/components/svg-icon":73,"../store/use-store":188,"./button":96,"./slider":123,preact:7,"preact/hooks":8,"prop-types":10,"scroll-into-view":19}],123:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var r,o=e("preact"),i=e("preact/hooks"),a=(r=e("prop-types"))&&r.__esModule?r:{default:r};function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){var t=e.children,n=e.visible,r=(0,i.useRef)(null),a=u((0,i.useState)(n?"auto":0),2),c=a[0],s=a[1],l=u((0,i.useState)(n),2),f=l[0],d=l[1];(0,i.useEffect)((function(){if(n!==(0!==c)){var e=r.current;n?(e.style.display="",d(!0),s(e.scrollHeight)):(e.style.height="".concat(e.scrollHeight,"px"),e.getBoundingClientRect(),s(0))}}),[c,n]);var p=(0,i.useCallback)((function(){n?s("auto"):d(!1)}),[s,n]),m="auto"===c;return(0,o.createElement)("div",{ontransitionend:p,ref:r,style:{display:f?"":"none",height:c,overflow:m?"visible":"hidden",transition:"height 0.15s ease-in"}},t)}s.propTypes={children:a.default.any,visible:a.default.bool}},{preact:7,"preact/hooks":8,"prop-types":10}],124:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var r=e("preact"),o=c(e("../store/use-store")),i=c(e("./menu")),a=c(e("./menu-item")),u=c(e("../../shared/components/svg-icon"));function c(e){return e&&e.__esModule?e:{default:e}}function s(){var e=(0,o.default)((function(e){return{setSortKey:e.setSortKey}})),t=(0,o.default)((function(e){return e.sortKey()})),n=(0,o.default)((function(e){return e.sortKeys()})).map((function(n){return(0,r.createElement)(a.default,{key:n,label:n,onClick:function(){return e.setSortKey(n)},isSelected:n===t})})),c=(0,r.createElement)("span",{className:"top-bar__menu-label"},(0,r.createElement)(u.default,{name:"sort",className:"top-bar__menu-icon"}));return(0,r.createElement)("div",{className:"sort-menu"},(0,r.createElement)(i.default,{label:c,title:"Sort by ".concat(t),align:"right",menuIndicator:!1},n))}s.propTypes={}},{"../../shared/components/svg-icon":73,"../store/use-store":188,"./menu":113,"./menu-item":110,preact:7}],125:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var r=e("preact");function o(){return(0,r.createElement)("div",{className:"spinner__container"},(0,r.createElement)("span",{className:"spinner"},(0,r.createElement)("span",null,(0,r.createElement)("span",null))))}o.propTypes={}},{preact:7}],126:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("preact"),i=e("preact/hooks"),a=p(e("prop-types")),u=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util/search-filter")),c=e("../util/service-context"),s=p(e("./hooks/use-root-thread")),l=p(e("../store/use-store")),f=p(e("./thread-list"));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function p(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(){}function b(e){var t=e.api,n=e.toastMessenger,r=(0,l.default)((function(e){return e.addAnnotations})),a=(0,l.default)((function(e){return e.annotationFetchStarted})),c=(0,l.default)((function(e){return e.annotationFetchFinished})),d=(0,l.default)((function(e){return e.clearAnnotations})),p=(0,l.default)((function(e){return e.routeParams().q})),h=(0,l.default)((function(e){return e.setSortKey})),b=(0,i.useCallback)(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({_separate_replies:!0,offset:0,limit:20},u.toObject(e));return function(e){if(e&&e.then)return e.then(g)}(function(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}((function(){return a(),function(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(t.search(n),(function(e){r([].concat(m(e.rows),m(e.replies)))}))}),(function(e,t){return c(),function(e,t){if(e)throw t;return t}(e,t)})))})),[r,a,c,t]);(0,i.useEffect)((function(){h("Newest"),d(),b(p).catch((function(e){n.error("Unable to fetch annotations: ".concat(e.message))}))}),[d,p,b,h,n]);var _=(0,s.default)();return(0,o.createElement)(f.default,{thread:_})}b.propTypes={api:a.default.object,toastMessenger:a.default.object},b.injectedProps=["api","toastMessenger"];var _=(0,c.withServices)(b);n.default=_},{"../store/use-store":188,"../util/search-filter":213,"../util/service-context":215,"./hooks/use-root-thread":104,"./thread-list":131,preact:7,"preact/hooks":8,"prop-types":10}],127:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=c(e("prop-types")),i=c(e("../store/use-store")),a=e("../util/service-context"),u=c(e("./search-input"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.router,n=(0,i.default)((function(e){return e.routeParams().q}));return(0,r.createElement)(u.default,{query:n,onSearch:function(e){t.navigate("stream",{q:e})},alwaysExpanded:!0})}s.propTypes={router:o.default.object},s.injectedProps=["router"];var l=(0,a.withServices)(s);n.default=l},{"../store/use-store":188,"../util/service-context":215,"./search-input":116,preact:7,"prop-types":10}],128:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=d(e("prop-types")),a=e("../util/service-context"),u=e("../../shared/user-agent"),c=d(e("./autocomplete-list")),s=e("../../shared/browser-compatibility-utils"),l=d(e("../../shared/components/svg-icon")),f=d(e("./hooks/use-element-should-close"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=0;function g(e){var t=e.onEditTags,n=e.tags,i=e.tagList,a=(0,o.useRef)(null),d=m((0,o.useState)([]),2),h=d[0],y=d[1],g=m((0,o.useState)(-1),2),b=g[0],_=g[1],w=m((0,o.useState)(!1),2),O=w[0],E=w[1],S=m((0,o.useState)((function(){return++v,"tag-editor-".concat(v)})),1)[0],A=(0,o.useRef)(null);(0,f.default)(A,O,(function(){E(!1)}));var j=(0,o.useMemo)((function(){return(0,u.isIE11)()}),[]),k=function(e){n.store(e.map((function(e){return{text:e}}))),t({tags:e})},T=function(e){var t=e.trim();if(0!==t.length&&!(i.indexOf(t)>=0)){k([].concat(p(i),[t])),E(!1),_(-1);var n=a.current;n.value="",n.focus()}},P=function(e){var t=b+e;t<-1?t=h.length-1:t>=h.length&&(t=-1),_(t)},x=b>=0?"".concat(S,"-autocomplete-list-item-").concat(b):"";return(0,r.createElement)("section",{className:"tag-editor"},(0,r.createElement)("ul",{className:"tag-editor__tags","aria-label":"Suggested tags for annotation"},i.map((function(e){return(0,r.createElement)("li",{key:"".concat(e),className:"tag-editor__item","aria-label":"Tag: ".concat(e)},(0,r.createElement)("span",{lang:"",className:"tag-editor__edit"},e),(0,r.createElement)("button",{onClick:function(){!function(e){var t=p(i),n=t.indexOf(e);t.splice(n,1),k(t)}(e)},"aria-label":"Remove Tag: ".concat(e),title:"Remove Tag: ".concat(e),className:"tag-editor__delete"},(0,r.createElement)(l.default,{name:"cancel"})))}))),(0,r.createElement)("span",{id:S,className:"tag-editor__combobox-wrapper",ref:A,role:"combobox","aria-expanded":O.toString(),"aria-owns":"".concat(S,"-autocomplete-list"),"aria-haspopup":"listbox"},(0,r.createElement)("input",{onInput:function(e){("insertText"===e.inputType||"deleteContentBackward"===e.inputType||j)&&function(){var e=a.current.value.trim();if(""===e)E(!1);else{var t=n.filter(e);y(function(e,t){var n=[];return e.forEach((function(e){t.indexOf(e)<0&&n.push(e)})),n.sort()}(t,i)),E(t.length>0)}_(-1)}()},onKeyDown:function(e){switch((0,s.normalizeKeyName)(e.key)){case"ArrowUp":P(-1),e.preventDefault();break;case"ArrowDown":P(1),e.preventDefault();break;case"Enter":case",":T(-1===b?a.current.value:h[b]),e.preventDefault();break;case"Tab":-1!==b?(T(h[b]),e.preventDefault()):O&&(T(h[0]),e.preventDefault())}},onFocus:function(){a.current.value.trim().length&&E(!0)},ref:a,placeholder:"Add new tags",className:"tag-editor__input",type:"text",autoComplete:"off","aria-label":"Add tag field","aria-autocomplete":"list","aria-activedescendant":x,"aria-controls":"".concat(S,"-autocomplete-list"),dir:"auto"}),(0,r.createElement)(c.default,{id:"".concat(S,"-autocomplete-list"),list:h,open:O,onSelectItem:function(e){e&&T(e)},itemPrefixId:"".concat(S,"-autocomplete-list-item-"),activeItem:b})))}g.propTypes={onEditTags:i.default.func.isRequired,tagList:i.default.array.isRequired,tags:i.default.object.isRequired},g.injectedProps=["tags"];var b=(0,a.withServices)(g);n.default=b},{"../../shared/browser-compatibility-utils":72,"../../shared/components/svg-icon":73,"../../shared/user-agent":81,"../util/service-context":215,"./autocomplete-list":95,"./hooks/use-element-should-close":103,preact:7,"preact/hooks":8,"prop-types":10}],129:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("preact"),i=e("preact/hooks"),a=(r=e("prop-types"))&&r.__esModule?r:{default:r},u=e("../util/account-id"),c=e("../util/service-context");function s(e){var t=e.annotation,n=e.serviceUrl,r=e.settings,a=e.tags,c=(0,i.useMemo)((function(){return!(0,u.isThirdPartyUser)(t.user,r.authDomain)}),[t,r]),s=function(e){return n("search.tag",{tag:e})};return(0,o.createElement)("ul",{className:"tag-list","aria-label":"Annotation tags"},a.map((function(e){return(0,o.createElement)("li",{key:e,className:"tag-list__item"},c&&(0,o.createElement)("a",{className:"tag-list__link",href:s(e),lang:"",target:"_blank",rel:"noopener noreferrer","aria-label":"Tag: ".concat(e),title:"View annotations with tag: ".concat(e)},e),!c&&(0,o.createElement)("span",{className:"tag-list__text","aria-label":"Tag: ".concat(e),lang:""},e))})))}s.propTypes={annotation:a.default.object.isRequired,tags:a.default.array.isRequired,serviceUrl:a.default.func,settings:a.default.object},s.injectedProps=["serviceUrl","settings"];var l=(0,c.withServices)(s);n.default=l},{"../util/account-id":191,"../util/service-context":215,preact:7,"preact/hooks":8,"prop-types":10}],130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=d(e("classnames")),o=d(e("lodash.debounce")),i=e("preact"),a=e("preact/hooks"),u=d(e("prop-types")),c=e("../../shared/dom-element"),s=d(e("../store/use-store")),l=e("../util/service-context"),f=d(e("./thread"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){var t=e.frameSync,n=e.settings,u=e.thread,l=u.annotation&&u.annotation.$tag,d=(0,s.default)((function(e){return e.isAnnotationFocused(l)})),p=(0,s.default)((function(e){return"sidebar"!==e.route()})),m=(0,a.useMemo)((function(){return(0,o.default)((function(e){var n=e?[e]:[];t.focusAnnotations(n)}),10)}),[t]),h=(0,a.useCallback)((function(e){t.scrollToAnnotation(e)}),[t]);return(0,i.createElement)("div",{onClick:function(e){var t;t=e.target,(0,c.closest)(t,"button")||(0,c.closest)(t,"a")||h(l)},onMouseEnter:function(){return m(l)},onMouseLeave:function(){return m(null)},key:u.id,className:(0,r.default)("thread-card",{"is-focused":d,"thread-card--theme-clean":"clean"===n.theme})},(0,i.createElement)(f.default,{thread:u,showDocumentInfo:p}))}p.propTypes={thread:u.default.object.isRequired,frameSync:u.default.object.isRequired,settings:u.default.object},p.injectedProps=["frameSync","settings"];var m=(0,l.withServices)(p);n.default=m},{"../../shared/dom-element":75,"../store/use-store":188,"../util/service-context":215,"./thread":132,classnames:1,"lodash.debounce":6,preact:7,"preact/hooks":8,"prop-types":10}],131:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=e("preact/hooks"),i=d(e("prop-types")),a=d(e("lodash.debounce")),u=d(e("../store/use-store")),c=e("../util/annotation-metadata"),s=e("../util/dom"),l=e("../util/visible-threads"),f=d(e("./thread-card"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(){var e=document.querySelector(".js-thread-list-scroll-root");if(!e)throw new Error("Scroll container is missing");return e}function _(e){var t=e.thread,n=(0,u.default)((function(e){return e.setForcedVisible})),i=y((0,o.useState)(b().clientHeight),2),d=i[0],p=i[1],h=y((0,o.useState)(b().scrollTop),2),g=h[0],_=h[1],w=y((0,o.useState)({}),2),O=w[0],E=w[1],S=y((0,o.useState)(null),2),A=S[0],j=S[1],k=t.children,T=(0,o.useMemo)((function(){return(0,l.calculateVisibleThreads)(k,O,g,d)}),[k,O,g,d]),P=T.offscreenLowerHeight,x=T.offscreenUpperHeight,N=T.visibleThreads,C=(0,u.default)((function(e){var t=e.unsavedAnnotations().filter((function(e){return!e.id&&!(0,c.isHighlight)(e)}));return t.length?t[t.length-1].$tag:null}));return(0,o.useEffect)((function(){C&&(n(C,!0),j(C))}),[n,C]),(0,o.useEffect)((function(){if(A){var e=k.findIndex((function(e){return e.id===A}));if(-1!==e){j(null);var t=k.slice(0,e).reduce((function(e,t){return e+function(e){return O[e.id]||l.THREAD_DIMENSION_DEFAULTS.defaultHeight}(t)}),0);b().scrollTop=t}}}),[A,k,O]),(0,o.useEffect)((function(){var e=b(),t=(0,a.default)((function(){var t=e.scrollTop,n=Math.max(t-t%50,0);p(e.clientHeight),_(n)}),10,{maxWait:100});return e.addEventListener("scroll",t),window.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),window.removeEventListener("resize",t),t.cancel()}}),[]),(0,o.useEffect)((function(){E((function(e){var t,n={},r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(N);try{for(r.s();!(t=r.n()).done;){var o=t.value.id,i=document.getElementById(o),a=(0,s.getElementHeightWithMargins)(i);a!==e[o]&&(n[o]=a)}}catch(e){r.e(e)}finally{r.f()}return 0===Object.keys(n).length?e:m(m({},e),n)}))}),[N]),(0,r.createElement)("div",null,(0,r.createElement)("div",{style:{height:x}}),N.map((function(e){return(0,r.createElement)("div",{className:"thread-list__card",id:e.id,key:e.id},(0,r.createElement)(f.default,{thread:e}))})),(0,r.createElement)("div",{style:{height:P}}))}_.propTypes={thread:i.default.object.isRequired};var w=_;n.default=w},{"../store/use-store":188,"../util/annotation-metadata":192,"../util/dom":199,"../util/visible-threads":227,"./thread-card":130,"lodash.debounce":6,preact:7,"preact/hooks":8,"prop-types":10}],132:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=d(e("classnames")),o=e("preact"),i=d(e("prop-types")),a=d(e("../store/use-store")),u=e("../util/service-context"),c=e("../util/thread"),s=d(e("./annotation")),l=d(e("./button")),f=d(e("./moderation-banner"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){var t=e.showDocumentInfo,n=void 0!==t&&t,i=e.thread,u=e.threadsService,d=(0,a.default)((function(e){return e.setExpanded})),m=i.annotation&&i.visible,h=!i.collapsed,y=(0,c.countHidden)(i)>0,v=!!i.parent,g=i.collapsed?"collapsed":"expand-menu",b=i.collapsed?"Expand replies":"Collapse replies",_=i.children.filter((function(e){return(0,c.countVisible)(e)>0}));return(0,o.createElement)("section",{className:(0,r.default)("thread",{"thread--reply":i.depth>0,"is-collapsed":i.collapsed})},v&&(0,o.createElement)("div",{className:"thread__collapse"},(0,o.createElement)(l.default,{className:"thread__collapse-button",icon:g,title:b,onClick:function(){return d(i.id,!!i.collapsed)}})),(0,o.createElement)("div",{className:"thread__content"},m&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(f.default,{annotation:i.annotation}),(0,o.createElement)(s.default,{annotation:i.annotation,replyCount:i.replyCount,showDocumentInfo:n,threadIsCollapsed:i.collapsed})),!i.annotation&&(0,o.createElement)("div",{className:"thread__unavailable-message"},(0,o.createElement)("em",null,"Message not available.")),y&&(0,o.createElement)(l.default,{buttonText:"Show ".concat((0,c.countHidden)(i)," more in conversation"),className:"thread__hidden-toggle-button",onClick:function(){return u.forceVisible(i)}}),h&&(0,o.createElement)("ul",{className:"thread__children"},_.map((function(e){return(0,o.createElement)("li",{key:e.id},(0,o.createElement)(p,{thread:e,threadsService:u}))})))))}p.propTypes={showDocumentInfo:i.default.bool,thread:i.default.object.isRequired,threadsService:i.default.object.isRequired},p.injectedProps=["threadsService"];var m=(0,u.withServices)(p);n.default=m},{"../store/use-store":188,"../util/service-context":215,"../util/thread":221,"./annotation":94,"./button":96,"./moderation-banner":114,classnames:1,preact:7,"prop-types":10}],133:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=f;var r,o=e("preact"),i=e("preact/hooks"),a=(r=e("prop-types"))&&r.__esModule?r:{default:r},u=e("../util/date"),c=e("../util/time");function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=e.className,n=e.href,r=e.timestamp,a=s((0,i.useState)(new Date),2),l=a[0],f=a[1],d=(0,i.useMemo)((function(){return(0,c.toFuzzyString)(r?new Date(r):null,l)}),[r,l]),p=(0,i.useMemo)((function(){return(0,u.format)(new Date(r))}),[r]);return(0,i.useEffect)((function(){return(0,c.decayingInterval)(r,(function(){return f(new Date)}))}),[r]),n?(0,o.createElement)("a",{className:t,target:"_blank",rel:"noopener noreferrer",title:p,href:n},d):(0,o.createElement)("span",{className:t,title:p},d)}f.propTypes={className:a.default.string,href:a.default.string,timestamp:a.default.string.isRequired}},{"../util/date":197,"../util/time":222,preact:7,"preact/hooks":8,"prop-types":10}],134:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(e("classnames")),o=e("preact"),i=s(e("prop-types")),a=s(e("../store/use-store")),u=e("../util/service-context"),c=s(e("../../shared/components/svg-icon"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.message,n=e.onDismiss,i=t.type.charAt(0).toUpperCase()+t.type.slice(1),a="notice"===t.type?"cancel":t.type;return(0,o.createElement)("li",{className:(0,r.default)("toast-message-container",{"is-dismissed":t.isDismissed}),onClick:function(){return n(t.id)}},(0,o.createElement)("div",{className:(0,r.default)("toast-message","toast-message--".concat(t.type))},(0,o.createElement)("div",{className:"toast-message__type"},(0,o.createElement)(c.default,{name:a,className:"toast-message__icon"})),(0,o.createElement)("div",{className:"toast-message__message"},(0,o.createElement)("strong",null,i,": "),t.message,t.moreInfoURL&&(0,o.createElement)("div",{className:"toast-message__link"},(0,o.createElement)("a",{href:t.moreInfoURL,onClick:function(e){return e.stopPropagation()},target:"_new"},"More info")))))}function f(e){var t=e.toastMessenger,n=(0,a.default)((function(e){return e.getToastMessages()}));return(0,o.createElement)("div",null,(0,o.createElement)("ul",{"aria-live":"polite","aria-relevant":"additions",className:"toast-messages"},n.map((function(e){return(0,o.createElement)(l,{message:e,key:e.id,onDismiss:t.dismiss})}))))}l.propTypes={message:i.default.object.isRequired,onDismiss:i.default.func},f.propTypes={toastMessenger:i.default.object.isRequired},f.injectedProps=["toastMessenger"];var d=(0,u.withServices)(f);n.default=d},{"../../shared/components/svg-icon":73,"../store/use-store":188,"../util/service-context":215,classnames:1,preact:7,"prop-types":10}],135:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=b(e("classnames")),o=e("preact"),i=b(e("prop-types")),a=b(e("../../shared/bridge-events")),u=b(e("../service-config")),c=b(e("../store/use-store")),s=b(e("../ui-constants")),l=b(e("../util/is-third-party-service")),f=e("../util/service-context"),d=e("../util/theme"),p=b(e("./button")),m=b(e("./group-list")),h=b(e("./search-input")),y=b(e("./sort-menu")),v=b(e("./stream-search-input")),g=b(e("./user-menu"));function b(e){return e&&e.__esModule?e:{default:e}}function _(e){var t=e.auth,n=e.bridge,i=e.isSidebar,f=e.onLogin,b=e.onLogout,_=e.onSignUp,w=e.settings,O=e.streamer,E="clean"===w.theme,S=!(0,l.default)(w),A=(0,d.applyTheme)(["accentColor"],w),j=(0,c.default)((function(e){return e.filterQuery()})),k=(0,c.default)((function(e){return e.setFilterQuery})),T=(0,c.default)((function(e){return e.pendingUpdateCount()})),P=(0,c.default)((function(e){return e.toggleSidebarPanel})),x=(0,c.default)((function(e){return e.getState().sidebarPanels.activePanelName})),N=function(){var e=(0,u.default)(w);e&&e.onHelpRequestProvided?n.call(a.default.HELP_REQUESTED):P(s.default.PANEL_HELP)},C=(0,o.createElement)(o.Fragment,null,"unknown"===t.status&&(0,o.createElement)("span",{className:"top-bar__login-links"},""),"logged-out"===t.status&&(0,o.createElement)("span",{className:"top-bar__login-links"},(0,o.createElement)(p.default,{className:"top-bar__login-button",buttonText:"Sign up",onClick:_,style:A})," ","/",(0,o.createElement)(p.default,{className:"top-bar__login-button",buttonText:"Log in",onClick:f,style:A})),"logged-in"===t.status&&(0,o.createElement)(g.default,{auth:t,onLogout:b}));return(0,o.createElement)("div",{className:(0,r.default)("top-bar",E&&"top-bar--theme-clean")},!i&&(0,o.createElement)("div",{className:"top-bar__inner content"},(0,o.createElement)(v.default,null),(0,o.createElement)("div",{className:"u-stretch"}),(0,o.createElement)(p.default,{className:"top-bar__icon-button",icon:"help",isExpanded:x===s.default.PANEL_HELP,onClick:N,title:"Help"}),C),i&&(0,o.createElement)("div",{className:"top-bar__inner content"},(0,o.createElement)(m.default,{className:"GroupList",auth:t}),(0,o.createElement)("div",{className:"u-stretch"}),T>0&&(0,o.createElement)(p.default,{className:"top-bar__icon-button top-bar__icon-button--refresh",icon:"refresh",onClick:function(){return O.applyPendingUpdates()},title:"Show ".concat(T," new/updated ").concat(1===T?"annotation":"annotations")}),(0,o.createElement)(h.default,{query:j||null,onSearch:k}),(0,o.createElement)(y.default,null),S&&(0,o.createElement)(p.default,{className:"top-bar__icon-button",icon:"share",isExpanded:x===s.default.PANEL_SHARE_ANNOTATIONS,onClick:function(){P(s.default.PANEL_SHARE_ANNOTATIONS)},title:"Share annotations on this page"}),(0,o.createElement)(p.default,{className:"top-bar__icon-button",icon:"help",isExpanded:x===s.default.PANEL_HELP,onClick:N,title:"Help"}),C))}_.propTypes={auth:i.default.shape({status:i.default.string.isRequired,displayName:i.default.string,userid:i.default.string,username:i.default.string}),bridge:i.default.object.isRequired,isSidebar:i.default.bool,onLogin:i.default.func,onLogout:i.default.func,onSignUp:i.default.func,settings:i.default.object,streamer:i.default.object},_.injectedProps=["bridge","settings","streamer"];var w=(0,f.withServices)(_);n.default=w},{"../../shared/bridge-events":70,"../service-config":149,"../store/use-store":188,"../ui-constants":190,"../util/is-third-party-service":205,"../util/service-context":215,"../util/theme":219,"./button":96,"./group-list":101,"./search-input":116,"./sort-menu":124,"./stream-search-input":127,"./user-menu":137,classnames:1,preact:7,"prop-types":10}],136:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=c(e("prop-types")),i=c(e("../util/is-third-party-service")),a=e("../util/service-context"),u=c(e("../../shared/components/svg-icon"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.commandName,n=e.iconName;return(0,r.createElement)("span",{className:"tutorial__instruction"},(0,r.createElement)(u.default,{name:n,inline:!0,className:"tutorial__icon"}),(0,r.createElement)("em",null,t))}function l(e){var t=e.settings,n=!(0,i.default)(t);return(0,r.createElement)("ol",{className:"tutorial__list"},(0,r.createElement)("li",{className:"tutorial__item"},"To create an annotation, select text and then select the"," ",(0,r.createElement)(s,{iconName:"annotate",commandName:"Annotate"})," ","button."),(0,r.createElement)("li",{className:"tutorial__item"},"To create a highlight (",(0,r.createElement)("a",{href:"https://web.hypothes.is/help/why-are-highlights-private-by-default/",target:"_blank",rel:"noopener noreferrer"},"visible only to you"),"), select text and then select the"," ",(0,r.createElement)(s,{iconName:"highlight",commandName:"Highlight"})," ","button."),n&&(0,r.createElement)("li",{className:"tutorial__item"},"To annotate in a private group, select the group from the groups dropdown. Don't see your group? Ask the group creator to send a"," ",(0,r.createElement)("a",{href:"https://web.hypothes.is/help/how-to-join-a-private-group/",target:"_blank",rel:"noopener noreferrer"},"join link"),")."),(0,r.createElement)("li",{className:"tutorial__item"},"To reply to an annotation, select the"," ",(0,r.createElement)(s,{iconName:"reply",commandName:"Reply"})," button."))}s.propTypes={commandName:o.default.string.isRequired,iconName:o.default.string.isRequired},l.propTypes={settings:o.default.object.isRequired},l.injectedProps=["settings"];var f=(0,a.withServices)(l);n.default=f},{"../../shared/components/svg-icon":73,"../util/is-third-party-service":205,"../util/service-context":215,preact:7,"prop-types":10}],137:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=p(e("prop-types")),i=p(e("../../shared/bridge-events")),a=p(e("../service-config")),u=e("../util/account-id"),c=e("../util/service-context"),s=p(e("./menu")),l=p(e("./menu-item")),f=p(e("./menu-section")),d=p(e("../../shared/components/svg-icon"));function p(e){return e&&e.__esModule?e:{default:e}}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e){var t,n=e.auth,o=e.bridge,c=e.onLogout,p=e.serviceUrl,h=e.settings,y=(0,u.isThirdPartyUser)(n.userid,h.authDomain),v=(0,a.default)(h),g=function(e){return v&&!!v[e]},b=!y||g("onProfileRequestProvided"),_=!y||g("onLogoutRequestProvided"),w=(t={},b&&(y||(t.href=p("user",{user:n.username})),t.onClick=function(){return y&&o.call(i.default.PROFILE_REQUESTED)}),t),O=(0,r.createElement)("span",{className:"top-bar__menu-label"},(0,r.createElement)(d.default,{name:"profile",className:"top-bar__menu-icon"}));return(0,r.createElement)("div",{className:"user-menu"},(0,r.createElement)(s.default,{label:O,title:n.displayName,align:"right"},(0,r.createElement)(f.default,null,(0,r.createElement)(l.default,m({label:n.displayName,isDisabled:!b},w)),!y&&(0,r.createElement)(l.default,{label:"Account settings",href:p("account.settings")})),_&&(0,r.createElement)(f.default,null,(0,r.createElement)(l.default,{label:"Log out",onClick:c}))))}h.propTypes={auth:o.default.object.isRequired,onLogout:o.default.func.isRequired,bridge:o.default.object.isRequired,serviceUrl:o.default.func.isRequired,settings:o.default.object.isRequired},h.injectedProps=["bridge","serviceUrl","settings"];var y=(0,c.withServices)(h);n.default=y},{"../../shared/bridge-events":70,"../../shared/components/svg-icon":73,"../service-config":149,"../util/account-id":191,"../util/service-context":215,"./menu":113,"./menu-item":110,"./menu-section":112,preact:7,"prop-types":10}],138:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact"),o=c(e("prop-types")),i=e("../util/copy-to-clipboard"),a=e("../util/service-context"),u=c(e("./button"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.toastMessenger,n=e.versionData;return(0,r.createElement)("div",{className:"u-vertical-rhythm"},(0,r.createElement)("dl",{className:"version-info"},(0,r.createElement)("dt",{className:"version-info__key"},"Version"),(0,r.createElement)("dd",{className:"version-info__value"},n.version),(0,r.createElement)("dt",{className:"version-info__key"},"User Agent"),(0,r.createElement)("dd",{className:"version-info__value"},n.userAgent),(0,r.createElement)("dt",{className:"version-info__key"},"URL"),(0,r.createElement)("dd",{className:"version-info__value"},n.url),(0,r.createElement)("dt",{className:"version-info__key"},"Fingerprint"),(0,r.createElement)("dd",{className:"version-info__value"},n.fingerprint),(0,r.createElement)("dt",{className:"version-info__key"},"Account"),(0,r.createElement)("dd",{className:"version-info__value"},n.account),(0,r.createElement)("dt",{className:"version-info__key"},"Date"),(0,r.createElement)("dd",{className:"version-info__value"},n.timestamp)),(0,r.createElement)("div",{className:"u-layout-row--justify-center"},(0,r.createElement)(u.default,{buttonText:"Copy version details",onClick:function(){try{(0,i.copyText)(n.asFormattedString()),t.success("Copied version info to clipboard")}catch(e){t.error("Unable to copy version info")}},icon:"copy"})))}s.propTypes={versionData:o.default.object.isRequired,toastMessenger:o.default.object.isRequired},s.injectedProps=["toastMessenger"];var l=(0,a.withServices)(s);n.default=l},{"../util/copy-to-clipboard":196,"../util/service-context":215,"./button":96,preact:7,"prop-types":10}],139:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.startServer=s,n.preStartServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.addEventListener("message",l)};var r,o=(r=e("../shared/warn-once"))&&r.__esModule?r:{default:r};function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}s.$inject=["store","settings","$window"];var c=[];function s(e,t,n){var r=function(e){return{changeFocusModeUser:e.changeFocusModeUser}}(e);function a(e){var n=t.rpcAllowedOrigins||[];if(function(e){return null!=e&&"object"===u(e)&&"2.0"===e.jsonrpc}(e.data))if(n.includes(e.origin)){var a=e.data;e.source.postMessage(function(e){var t=r[e.method];return void 0===t?{jsonrpc:"2.0",id:e.id,error:{code:-32601,message:"Method not found"}}:(e.params?t.apply(void 0,i(e.params)):t(),{jsonrpc:"2.0",result:"ok",id:e.id})}(a),e.origin)}else(0,o.default)("Ignoring JSON-RPC request from non-whitelisted origin ".concat(e.origin))}c.forEach((function(e){a(e)})),c=[],window.removeEventListener("message",l),n.addEventListener("message",a)}function l(e){c.push(e)}},{"../shared/warn-once":82}],140:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t,n,o,i,a;r||(r=!0,t=window,n=document,o="script","ga",t.GoogleAnalyticsObject="ga",t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,i=n.createElement(o),a=n.getElementsByTagName(o)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",a.parentNode.insertBefore(i,a),ga("create",e,"auto"),ga("set","checkProtocolTask",null),ga("set","anonymizeIp",!0))};var r=!1},{}],141:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=(0,o.default)(e);if(t){if(t.apiUrl)return t.apiUrl;throw new Error("Service should contain an apiUrl value.")}return e.apiUrl};var r,o=(r=e("./service-config"))&&r.__esModule?r:{default:r}},{"./service-config":149}],142:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=e.location.hash.slice(1),n=o.parse(t).config,r=JSON.parse(n||"{}"),a=["annotations","group","query","appType","openSidebar","showHighlights","services","branding","enableExperimentalNewNoteButton","focus","requestConfigFromFrame","theme","usernameUrl"],u={openSidebar:i.toBoolean,requestConfigFromFrame:function(e){if("string"==typeof e)return e;var t=(0,i.toObject)(e);return{origin:(0,i.toString)(t.origin),ancestorLevel:(0,i.toInteger)(t.ancestorLevel)}}};return Object.keys(r).reduce((function(e,t){return-1!==a.indexOf(t)&&null!==r[t]&&(u[t]?e[t]=u[t](r[t]):e[t]=r[t]),e}),{})};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("query-string")),i=e("../shared/type-coercions");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}},{"../shared/type-coercions":80,"query-string":12}],143:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={add:e("../images/icons/add.svg"),annotate:e("../images/icons/annotate.svg"),"arrow-left":e("../images/icons/arrow-left.svg"),"arrow-right":e("../images/icons/arrow-right.svg"),cancel:e("../images/icons/cancel.svg"),"caret-right":e("../images/icons/caret-right.svg"),"cc-std":e("../images/icons/cc-std.svg"),"cc-zero":e("../images/icons/cc-zero.svg"),"collapse-menu":e("../images/icons/collapse-menu.svg"),collapsed:e("../images/icons/collapsed.svg"),copy:e("../images/icons/copy.svg"),cursor:e("../images/icons/cursor.svg"),edit:e("../images/icons/edit.svg"),email:e("../images/icons/email.svg"),"expand-menu":e("../images/icons/expand-menu.svg"),error:e("../images/icons/cancel.svg"),external:e("../images/icons/external.svg"),facebook:e("../images/icons/facebook.svg"),flag:e("../images/icons/flag.svg"),"flag--active":e("../images/icons/flag--active.svg"),"format-bold":e("../images/icons/format-bold.svg"),"format-functions":e("../images/icons/format-functions.svg"),"format-italic":e("../images/icons/format-italic.svg"),"format-list-numbered":e("../images/icons/format-list-numbered.svg"),"format-list-unordered":e("../images/icons/format-list-unordered.svg"),"format-quote":e("../images/icons/format-quote.svg"),groups:e("../images/icons/groups.svg"),help:e("../images/icons/help.svg"),highlight:e("../images/icons/highlight.svg"),image:e("../images/icons/image.svg"),leave:e("../images/icons/leave.svg"),link:e("../images/icons/link.svg"),lock:e("../images/icons/lock.svg"),logo:e("../images/icons/logo.svg"),pointer:e("../images/icons/pointer.svg"),profile:e("../images/icons/profile.svg"),public:e("../images/icons/public.svg"),refresh:e("../images/icons/refresh.svg"),restricted:e("../images/icons/restricted.svg"),reply:e("../images/icons/reply.svg"),search:e("../images/icons/search.svg"),share:e("../images/icons/share.svg"),success:e("../images/icons/check.svg"),sort:e("../images/icons/sort.svg"),trash:e("../images/icons/trash.svg"),twitter:e("../images/icons/twitter.svg")};n.default=r},{"../images/icons/add.svg":25,"../images/icons/annotate.svg":26,"../images/icons/arrow-left.svg":27,"../images/icons/arrow-right.svg":28,"../images/icons/cancel.svg":29,"../images/icons/caret-right.svg":30,"../images/icons/cc-std.svg":31,"../images/icons/cc-zero.svg":32,"../images/icons/check.svg":33,"../images/icons/collapse-menu.svg":34,"../images/icons/collapsed.svg":35,"../images/icons/copy.svg":36,"../images/icons/cursor.svg":37,"../images/icons/edit.svg":38,"../images/icons/email.svg":39,"../images/icons/expand-menu.svg":40,"../images/icons/external.svg":41,"../images/icons/facebook.svg":42,"../images/icons/flag--active.svg":43,"../images/icons/flag.svg":44,"../images/icons/format-bold.svg":45,"../images/icons/format-functions.svg":46,"../images/icons/format-italic.svg":47,"../images/icons/format-list-numbered.svg":48,"../images/icons/format-list-unordered.svg":49,"../images/icons/format-quote.svg":50,"../images/icons/groups.svg":51,"../images/icons/help.svg":52,"../images/icons/highlight.svg":53,"../images/icons/image.svg":54,"../images/icons/leave.svg":55,"../images/icons/link.svg":56,"../images/icons/lock.svg":57,"../images/icons/logo.svg":58,"../images/icons/pointer.svg":59,"../images/icons/profile.svg":60,"../images/icons/public.svg":61,"../images/icons/refresh.svg":62,"../images/icons/reply.svg":63,"../images/icons/restricted.svg":64,"../images/icons/search.svg":65,"../images/icons/share.svg":66,"../images/icons/sort.svg":67,"../images/icons/trash.svg":68,"../images/icons/twitter.svg":69}],144:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=e("../shared/settings"),i=H(e("../shared/renderer-options")),a=e("./cross-origin-rpc.js"),u=U(e("./ga")),c=U(e("./util/disable-opener-for-external-links")),s=e("./util/fetch-config"),l=H(e("./util/sentry"));e("focus-visible");var f=e("../shared/components/svg-icon"),d=U(e("./icons")),p=e("preact"),m=U(e("./components/hypothesis-app")),h=e("./util/service-context"),y=U(e("../shared/bridge")),v=U(e("./services/analytics")),g=U(e("./services/annotations")),b=U(e("./services/api")),_=U(e("./services/api-routes")),w=U(e("./services/oauth-auth")),O=U(e("./services/autosave")),E=U(e("./services/features")),S=U(e("./services/frame-sync")),A=U(e("./services/groups")),j=U(e("./services/load-annotations")),k=U(e("./services/local-storage")),T=U(e("./services/persisted-defaults")),P=U(e("./services/router")),x=U(e("./services/service-url")),N=U(e("./services/session")),C=U(e("./services/stream-filter")),M=U(e("./services/streamer")),D=U(e("./services/tags")),I=U(e("./services/threads")),L=U(e("./services/toast-messenger")),R=U(e("./store")),F=e("../shared/injector");function U(e){return e&&e.__esModule?e:{default:e}}function q(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return q=function(){return e},e}function H(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=q();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}Q.$inject=["frameSync"],K.$inject=["autosaveService"],V.$inject=["persistedDefaults"],W.$inject=["analytics"],$.$inject=["groups","session","router"],z.$inject=["api","streamer"];var B=(0,o.jsonConfigsFrom)(document);B.sentry&&l.init(B.sentry),(0,c.default)(document.body),B.googleAnalytics&&(0,u.default)(B.googleAnalytics);var G=!(window.location.pathname.startsWith("/stream")||window.location.pathname.startsWith("/a/"));function z(e,t){e.setClientId(t.clientId)}function $(e,t,n){Promise.all([e.load(),t.load()]).finally((function(){n.sync()}))}function W(e){e.sendPageView()}function V(e){e.init()}function K(e){e.init()}function Q(e){G&&e.connect()}i.setupIE11Fixes(),(0,f.registerIcons)(d.default),(0,a.preStartServer)(),(0,s.fetchConfig)(B).then((function(e){!function(e){var t=new F.Injector;t.register("analytics",v.default).register("annotationsService",g.default).register("api",b.default).register("apiRoutes",_.default).register("auth",w.default).register("autosaveService",O.default).register("bridge",y.default).register("features",E.default).register("frameSync",S.default).register("groups",A.default).register("loadAnnotationsService",j.default).register("localStorage",k.default).register("persistedDefaults",T.default).register("router",P.default).register("serviceUrl",x.default).register("session",N.default).register("streamer",M.default).register("streamFilter",C.default).register("tags",D.default).register("threadsService",I.default).register("toastMessenger",L.default).register("store",R.default),t.register("$window",{value:window}).register("isSidebar",{value:G}).register("settings",{value:e}),t.run(V),t.run(K),t.run(W),t.run(z),t.run($),t.run(a.startServer),t.run(Q);var n=document.querySelector("hypothesis-app");(0,p.render)((0,p.createElement)(h.ServiceContext.Provider,{value:t},(0,p.createElement)(m.default,null)),n)}(e)})).catch((function(e){console.error("Failed to start Hypothesis client: ",e)}))},{"../shared/bridge":71,"../shared/components/svg-icon":73,"../shared/injector":77,"../shared/renderer-options":78,"../shared/settings":79,"./components/hypothesis-app":105,"./cross-origin-rpc.js":139,"./ga":140,"./icons":143,"./services/analytics":150,"./services/annotations":151,"./services/api":153,"./services/api-routes":152,"./services/autosave":154,"./services/features":155,"./services/frame-sync":156,"./services/groups":157,"./services/load-annotations":158,"./services/local-storage":159,"./services/oauth-auth":160,"./services/persisted-defaults":161,"./services/router":162,"./services/service-url":163,"./services/session":164,"./services/stream-filter":165,"./services/streamer":166,"./services/tags":167,"./services/threads":168,"./services/toast-messenger":169,"./store":172,"./util/disable-opener-for-external-links":198,"./util/fetch-config":200,"./util/sentry":214,"./util/service-context":215,"focus-visible":5,preact:7}],145:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.convertSelectionToLink=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ANCHOR_LINK,i=e.text.slice(e.selectionStart,e.selectionEnd),a="";if(n===r.IMAGE_LINK&&(a="!"),i.match(/[a-z]+:\/\/.*/)){var u="Description";return(t=o(e,e.selectionStart,i.length,a+"["+u+"]("+i+")")).selectionStart=e.selectionStart+a.length+1,t.selectionEnd=t.selectionStart+u.length,t}var c=a+"["+i+"](",s="http://insert-your-link-here.com";return(t=o(e,e.selectionStart,i.length,c+s+")")).selectionStart=e.selectionStart+c.length,t.selectionEnd=t.selectionStart+s.length,t},n.toggleSpanStyle=function(e,t,n,r){void 0===n&&(n=t);var i=e.text.slice(e.selectionStart-t.length,e.selectionStart),a=e.text.slice(e.selectionEnd,e.selectionEnd+t.length),u=e;return e.selectionStart===e.selectionEnd&&r&&((u=o(e,e.selectionStart,0,r)).selectionStart=u.selectionEnd-r.length),i===t&&a===n?(u=o(u,u.selectionStart-t.length,t.length,""),u=o(u,u.selectionEnd,n.length,"")):(u=o(u,u.selectionStart,0,t),u=o(u,u.selectionEnd,0,n)),u},n.toggleBlockStyle=function(e,t){var n=e.selectionStart,r=e.selectionEnd,i=!0;return a(e,n,r,(function(e,n){return e.text.slice(n,n+t.length)!==t&&(i=!1),e})),a(e,n,r,i?function(e,n){return o(e,n,t.length,"")}:function(e,n){return e.text.slice(n,n+t.length)===t?e:o(e,n,0,t)})},n.LinkType=void 0;var r={ANCHOR_LINK:0,IMAGE_LINK:1};function o(e,t,n,r){var o=e.selectionStart,i=e.selectionEnd;return o>=t+n?(o+=r.length-n,i+=r.length-n):i<=t||(o<=t&&i>=t+n?i+=r.length-n:o<t&&i<t+n?o=t:o<t+n&&i>t+n?i+=r.length-n:t<o&&t+n>i&&(o=t,i=t+n)),{text:e.text.slice(0,t)+r+e.text.slice(t+n),selectionStart:o,selectionEnd:i}}function i(e,t){var n=e.indexOf("\n",t);return n<0?e.length:n}function a(e,t,n,r){for(var o=function(e,t){var n=e.lastIndexOf("\n",t);return n<0?0:n+1}(e.text,t),a=i(e.text,t);a<=i(e.text,n);){var u=a===e.text.length,c=a-o,s=i((e=r(e,o,a)).text,o)-o;if(n+=s-c,u)break;o=o+s+1,a=i(e.text,o)}return e}n.LinkType=r},{}],146:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.replaceLinksWithEmbeds=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.className,o=e.getElementsByTagName("a");for(o=Array.prototype.slice.call(o,0),t=0;t<o.length;t++){var i=d(o[t]);i&&(r?i.className=r:i.style.width="350px")}};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("query-string"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e,t){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%";var n=document.createElement("div");return n.style.paddingBottom="".concat(1/t*100,"%"),n.style.position="relative",n.appendChild(e),n}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16/9,n=document.createElement("iframe");return n.src=e,n.setAttribute("frameborder","0"),n.setAttribute("allowfullscreen",""),a(n,t)}function c(e){var t,n=["end","start","t"],r=o.parse(e.search),i={};return Object.keys(r).filter((function(e){return n.includes(e)})).forEach((function(e){"t"===e?i.start=function(e){for(var t,n=/(\d+)([hms]?)/g,r={h:3600,m:60,s:1},o=0;null!==(t=n.exec(e));)t[2]?o+=Number(t[1])*r[t[2]]:o+=+t[1];return o.toString()}(r[e]):i[e]=r[e]})),(t=o.stringify(i))&&(t="?".concat(t)),t}function s(e,t){var n=c(t);return u("https://www.youtube.com/embed/".concat(e).concat(n))}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.aspectRatio,i=function(r){if(r.hostname!==e)return null;var i=t.exec(r.pathname);if(!i)return null;var a=i[1];return u(n(a),o)};return i}var f=[function(e){if("www.youtube.com"!==e.hostname)return null;if(!/\/watch\/?/.test(e.pathname))return null;var t=/[&?]v=([^&#]+)/.exec(e.search);return t?s(t[1],e):null},function(e){if("youtu.be"!==e.hostname)return null;var t=/^\/([^/]+)\/?$/.exec(e.pathname);return t?s(t[1],e):null},l("vimeo.com",/^\/([^/?#]+)\/?$/,(function(e){return"https://player.vimeo.com/video/".concat(e)})),l("vimeo.com",/^\/channels\/[^/]+\/([^/?#]+)\/?$/,(function(e){return"https://player.vimeo.com/video/".concat(e)})),l("flipgrid.com",/^\/s\/([^/]+)$/,(function(e){return"https://flipgrid.com/s/".concat(e,"?embed=true")})),function(e){if("archive.org"!==e.hostname)return null;var t=/^\/(embed|details)\/(.+)/.exec(e.pathname);if(!t)return null;var n=t[2],r=o.parse(e.search),i=r.start,a=r.end;if(!i){var c=n.match(/\/start\/([^/]+)/);c&&(i=c[1],n=n.replace(c[0],""))}if(!a){var s=n.match(/\/end\/([^/]+)/);s&&(a=s[1],n=n.replace(s[0],""))}var l=new URL("https://archive.org/embed/".concat(n));return i&&l.searchParams.append("start",i),a&&l.searchParams.append("end",a),u(l.href)},function(e){return e.pathname.endsWith(".mp3")||e.pathname.endsWith(".ogg")||e.pathname.endsWith(".wav")?function(e){var t=document.createElement("audio");return t.controls=!0,t.src=e,t}(e.href):null}];function d(e){if(e.href!==e.textContent&&decodeURI(e.href)!==e.textContent)return null;var t=function(e){var t,n;for(n=0;n<f.length;n++)if(t=f[n](e))return t;return null}(e);return t&&e.parentElement.replaceChild(t,e),t}},{"query-string":12}],147:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=function(e){for(var t=[],n=0,r=e;;){var o=r.indexOf("$$",n),i=r.indexOf("\\(",n);if(-1===o&&-1===i)break;var a=void 0,u=void 0;if(-1!==o&&(-1===i||o<i)?(a=o,u=r.indexOf("$$",a+2)):(a=i,u=r.indexOf("\\)",a+2)),-1===u)break;u+=2;var c=t.length+1,s=p(c);t.push({id:c,expression:r.slice(a+2,u-2),inline:-1!==i});var l=void 0;l=-1!==i?s:"\n\n"+s+"\n\n",r=r.slice(0,a)+l+r.slice(u),n=a+l.length}return{mathBlocks:t,content:r}}(e);return function(e,t){return t.reduce((function(e,t){var n;try{n=t.inline?a.renderToString(t.expression):a.renderToString(t.expression,{displayMode:!0})}catch(e){n=(0,i.default)(t.expression)}return e.replace(p(t.id),n)}),e)}(f.sanitize(function(e){return l||(l=new u.default.Converter({extensions:[d],simplifiedAutoLink:!0,literalMidWordUnderscores:!0})),l.makeHtml(e)}(t.content)),t.mathBlocks)};var o=s(e("dompurify")),i=s(e("escape-html")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("katex")),u=s(e("showdown"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e){return e&&e.__esModule?e:{default:e}}var l,f=(0,o.default)(window);function d(){return[{type:"output",filter:function(e){return e.replace(/<a href=/g,'<a target="_blank" href=')}}]}function p(e){return"{math:"+e.toString()+"}"}f.addHook("afterSanitizeAttributes",(function(e){"target"in e&&e.setAttribute("target","_blank")}))},{dompurify:2,"escape-html":3,katex:"katex",showdown:"showdown"}],148:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("tiny-emitter");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){u(n,r.TinyEmitter);var t=s(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.chunkSize,u=void 0===a?200:a,c=o.separateReplies,s=void 0===c||c,l=o.incremental,f=void 0===l||l;return i(this,n),(r=t.call(this))._searchFn=e,r._chunkSize=u,r._separateReplies=s,r._incremental=f,r._canceled=!1,r._results=[],r}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(n,[{key:"_getBatch",value:function(e,t){var n=Object.assign({limit:this._chunkSize,offset:t,sort:"created",order:"asc",_separate_replies:this._separateReplies,user:"acct:caslonkahle@hypothes.is"},e),r=this;this._searchFn(n).then((function(n){if(!r._canceled){var o=n.rows.concat(n.replies||[]);r._incremental?r.emit("results",o):r._results=r._results.concat(o);var i=t+n.rows.length;n.total>i&&o.length>0?r._getBatch(e,i):(r._incremental||r.emit("results",r._results),r.emit("end"))}})).catch((function(e){r._canceled||(r.emit("error",e),r.emit("end"))}))}},{key:"get",value:function(e){this._results=[],this._getBatch(e,0)}},{key:"cancel",value:function(){this._canceled=!0,this.emit("end")}}]),n}();n.default=d},{"tiny-emitter":24}],149:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return Array.isArray(e.services)&&0!==e.services.length?e.services[0]:null}},{}],150:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i,n.events=void 0,i.$inject=["$window","settings"];var r=/^https:\/\/(qa-)?via.hypothes.is\//,o={ANNOTATION_CREATED:"annotationCreated",ANNOTATION_DELETED:"annotationDeleted",ANNOTATION_FLAGGED:"annotationFlagged",ANNOTATION_SHARED:"annotationShared",ANNOTATION_UPDATED:"annotationUpdated",DOCUMENT_SHARED:"documentShared",GROUP_LEAVE:"groupLeave",GROUP_SWITCH:"groupSwitch",GROUP_VIEW_ACTIVITY:"groupViewActivity",HIGHLIGHT_CREATED:"highlightCreated",HIGHLIGHT_UPDATED:"highlightUpdated",HIGHLIGHT_DELETED:"highlightDeleted",LOGIN_FAILURE:"loginFailure",LOGIN_SUCCESS:"loginSuccessful",LOGOUT_FAILURE:"logoutFailure",LOGOUT_SUCCESS:"logoutSuccessful",PAGE_NOTE_CREATED:"pageNoteCreated",PAGE_NOTE_UPDATED:"pageNoteUpdated",PAGE_NOTE_DELETED:"pageNoteDeleted",REPLY_CREATED:"replyCreated",REPLY_UPDATED:"replyUpdated",REPLY_DELETED:"replyDeleted",SIDEBAR_OPENED:"sidebarOpened",SIGN_UP_REQUESTED:"signUpRequested"};function i(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["chrome-extension","firefox-extension","embed","bookmarklet","via"].indexOf((t.appType||"").toLowerCase())>-1?t.appType.toLowerCase():"chrome-extension:"===e.location.protocol?"chrome-extension":r.test(e.document.referrer)?"via":"embed"}(e,t),i=function(){},a=function(){return e.ga||i};return{sendPageView:function(){a()("send","pageview")},track:function(e,t,r){a()("send","event",n,e,t,r)},events:o}}n.events=o},{}],151:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=h;var o,i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util/annotation-metadata")),a=e("../util/permissions"),u=e("../util/random"),c=(o=e("../ui-constants"))&&o.__esModule?o:{default:o};function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function f(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){function n(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=t.getDefault("annotationPrivacy"),o=t.focusedGroupId(),c=t.profile(),s=c.userid,l=c.user_info,f=(0,u.generateHexString)(8),d=Object.assign({created:n.toISOString(),group:o,permissions:(0,a.defaultPermissions)(s,o,r),tags:[],text:"",updated:n.toISOString(),user:s,user_info:l,$tag:f,hidden:!1,links:{}},e);return i.isHighlight(d)&&(d.permissions=(0,a.privatePermissions)(s)),d}function r(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,o=n(e,r);t.addAnnotations([o]),t.deleteNewAndEmptyDrafts(),i.isHighlight(o)||t.createDraft(o,{tags:o.tags,text:o.text,isPrivate:!i.isPublic(o)}),i.isPageNote(o)?t.selectTab(c.default.TAB_NOTES):i.isAnnotation(o)&&t.selectTab(c.default.TAB_ANNOTATIONS),(o.references||[]).forEach((function(e){t.setExpanded(e,!0)}))}var o=f((function(n){var r,o,u=function(e){var n={},r=t.getDraft(e);return r&&(n.tags=r.tags,n.text=r.text,n.permissions=r.isPrivate?(0,a.privatePermissions)(e.user):(0,a.sharedPermissions)(e.user,e.group)),p(p({},e),n)}(n);return r=i.isNew(n)?e.annotation.create({},u):e.annotation.update({id:n.id},u),t.annotationSaveStarted(n),function(e,t){return e&&e.then?e.then(t):t(e)}(function(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}((function(){return l(r,(function(e){o=e}))}),(function(e,r){return t.annotationSaveFinished(n),function(e,t){if(e)throw t;return t}(e,r)})),(function(){return Object.keys(n).forEach((function(e){"$"===e[0]&&(o[e]=n[e])})),t.removeDraft(n),t.addAnnotations([o]),o}))})),s=f((function(n){return l(e.annotation.flag({id:n.id}),(function(){t.updateFlagStatus(n.id,!0)}))}));return{create:r,delete:f((function(n){return l(e.annotation.delete({id:n.id}),(function(){t.removeAnnotations([n])}))})),flag:s,reply:function(e,t){r({group:e.group,permissions:i.isPublic(e)?(0,a.sharedPermissions)(t,e.group):(0,a.privatePermissions)(t),references:(e.references||[]).concat(e.id),target:[{source:e.target[0].source}],uri:e.uri})},save:o}}h.$inject=["api","store"]},{"../ui-constants":190,"../util/annotation-metadata":192,"../util/permissions":209,"../util/random":211}],152:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var r=e("../util/retry");function o(e){var t,n;function o(e){return fetch(e).then((function(t){if(200!==t.status)throw new Error("Fetching ".concat(e," failed"));return t.json()}))}function i(){return t||(t=(0,r.retryPromiseOperation)((function(){return o(e.apiUrl)})).then((function(e){return e.links}))),t}return{routes:i,links:function(){return n||(n=i().then((function(e){return o(e.links.url)}))),n}}}o.$inject=["settings"]},{"../util/retry":212}],153:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("query-string")),i=e("../util/url");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=e.status+" "+e.statusText;return t&&t.reason&&(n=n+": "+t.reason),new Error(n)}function l(e){var t={};for(var n in e)e.hasOwnProperty(n)&&"$"!==n[0]&&(t[n]=e[n]);return t}p.$inject=["apiRoutes","auth","store"];var f=function(){return null};function d(e,t){var n=e;return t.split(".").forEach((function(e){n=n[e]})),n}function p(e,t,n){var r=e.routes(),a=null,c=function(){return a};function p(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.getAccessToken,a=void 0===r?f:r,c=n.getClientId,p=void 0===c?f:c,m=n.onRequestStarted,h=void 0===m?f:m,y=n.onRequestFinished,v=void 0===y?f:y;return function(n,r){var c,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return h(),Promise.all([e,a()]).then((function(e){var a=u(e,2),s=a[0],f=a[1],m=d(s,t),h={"Content-Type":"application/json","Hypothesis-Client-Version":"1.0.0-dummy-version"};c=f,f&&(h.Authorization="Bearer "+f);var y=p();y&&(h["X-Client-Id"]=y);var v=(0,i.replaceURLParams)(m.url,n),g=v.url,b=v.params,_=new URL(g);return _.search=o.stringify(b),fetch(_.toString(),{body:r?JSON.stringify(l(r)):null,headers:h,method:m.method}).catch((function(){throw new Error("Fetch operation failed for URL '".concat(g,"'"))}))})).then((function(e){var t,n=e.status;return t=n>=200&&204!==n&&n<500?e.json():e.text(),Promise.all([e,t])})).then((function(e){var t=u(e,2),n=t[0],r=t[1];if(v(),n.status>=400)throw s(n,r);return f.includeMetadata?{data:r,token:c}:r}),(function(e){throw v(),e}))}}(r,e,{getAccessToken:t.tokenGetter,getClientId:c,onRequestStarted:n.apiRequestStarted,onRequestFinished:n.apiRequestFinished})}return{setClientId:function(e){a=e},search:p("search"),annotation:{create:p("annotation.create"),delete:p("annotation.delete"),get:p("annotation.read"),update:p("annotation.update"),flag:p("annotation.flag"),hide:p("annotation.hide"),unhide:p("annotation.unhide")},group:{member:{delete:p("group.member.delete")},read:p("group.read")},groups:{list:p("groups.read")},profile:{groups:{read:p("profile.groups.read")},read:p("profile.read"),update:p("profile.update")}}}},{"../util/url":224,"query-string":12}],154:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var r=e("../util/retry");function o(e,t){var n=new Set,o=new Set,i=function(){t.newHighlights().forEach((function(t){var i=t.$tag;(function(e){return!n.has(e)&&!o.has(e)})(i)&&(n.add(i),(0,r.retryPromiseOperation)((function(){return e.save(t)})).catch((function(){o.add(i)})).finally((function(){n.delete(i)})))}))};return{init:function(){t.subscribe(i)},isSaving:function(){return n.size>0}}}o.$inject=["annotationsService","store"]},{"../util/retry":212}],155:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var r=a(e("../../shared/bridge-events")),o=a(e("../../shared/warn-once")),i=e("../util/watch");function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){var a=function(){return n.profile().features};return(0,i.watch)(n.subscribe,[a,function(){return n.frames()}],(function(){e.call(r.default.FEATURE_FLAGS_UPDATED,a()||{})})),{flagEnabled:function(e){t.load();var n=a();return!!n&&(e in n?n[e]:((0,o.default)("looked up unknown feature",e),!1))}}}u.$inject=["bridge","session","store"]},{"../../shared/bridge-events":70,"../../shared/warn-once":82,"../util/watch":228}],156:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.formatAnnot=m,n.default=h;var o=f(e("lodash.debounce")),i=f(e("../../shared/bridge-events")),a=f(e("../../shared/discovery")),u=f(e("../ui-constants")),c=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util/annotation-metadata")),s=e("../util/watch");function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){return{tag:e.$tag,msg:{document:e.document,target:e.target,uri:e.uri,links:e.links,text:e.text}}}function h(e,t,n){var r=new Set;function l(){t.on("beforeCreateAnnotation",(function(o){var i=Object.assign({},o.msg,{$tag:o.tag});if(!n.isLoggedIn())return t.call("showSidebar"),n.openSidebarPanel(u.default.PANEL_LOGIN_PROMPT),void t.call("deleteAnnotation",m(i));r.add(o.tag),e.create(i)})),t.on("destroyFrame",p.bind(this));var i={},a=(0,o.default)((function(){n.updateAnchorStatus(i),i={}}),10);t.on("sync",(function(e){e.forEach((function(e){r.add(e.tag),i[e.tag]=e.msg.$orphan?"orphan":"anchored",a()}))})),t.on("showAnnotations",(function(e){n.selectAnnotations(n.findIDsForTags(e)),n.selectTab(u.default.TAB_ANNOTATIONS)})),t.on("focusAnnotations",(function(e){n.focusAnnotations(e||[])})),t.on("toggleAnnotationSelection",(function(e){n.toggleSelectedAnnotations(n.findIDsForTags(e))})),t.on("sidebarOpened",(function(){n.setSidebarOpened(!0)})),t.on("showSidebar",(function(){t.call("showSidebar")})),t.on("hideSidebar",(function(){t.call("hideSidebar")})),t.on("setVisibleHighlights",(function(e){t.call("setVisibleHighlights",e)}))}function f(e){e.call("getDocumentInfo",(function(t,r){t?e.destroy():n.connectFrame({id:r.frameIdentifier,metadata:r.metadata,uri:r.uri})}))}function p(e){var t=n.frames().find((function(t){return t.id===e}));t&&n.destroyFrame(t)}this.connect=function(){var e;new a.default(window,{server:!0}).startDiscovery(t.createChannel.bind(t)),t.onConnect(f),e=0,(0,s.watch)(n.subscribe,[function(){return n.getState().annotations.annotations},function(){return n.frames()}],(function(n,o){var a=d(n,2),u=a[0],s=a[1],l=d(o,1)[0],f=0,p=new Set,h=[];u.forEach((function(e){c.isReply(e)||(c.isPublic(e)&&++f,p.add(e.$tag),r.has(e.$tag)||h.push(e))}));var y=l.filter((function(e){return!p.has(e.$tag)}));h.length>0&&(t.call("loadAnnotations",h.map(m)),h.forEach((function(e){r.add(e.$tag)}))),y.forEach((function(e){t.call("deleteAnnotation",m(e)),r.delete(e.$tag)})),s.length>0&&s.every((function(e){return e.isAnnotationFetchComplete}))&&(0!==f&&f===e||(t.call(i.default.PUBLIC_ANNOTATION_COUNT_CHANGED,f),e=f))})),l()},this.focusAnnotations=function(e){n.focusAnnotations(e),t.call("focusAnnotations",e)},this.scrollToAnnotation=function(e){t.call("scrollToAnnotation",e)}}h.$inject=["annotationsService","bridge","store"]},{"../../shared/bridge-events":70,"../../shared/discovery":74,"../ui-constants":190,"../util/annotation-metadata":192,"../util/watch":228,"lodash.debounce":6}],157:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=b;var r,o=(r=e("../service-config"))&&r.__esModule?r:{default:r},i=e("../util/annotation-metadata"),a=e("../util/groups"),u=e("../util/state"),c=e("../util/watch");function s(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function l(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}function f(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function d(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function p(){}function m(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}b.$inject=["store","api","isSidebar","serviceUrl","session","settings","toastMessenger","auth"];var g={id:"__default__",name:"__DEFAULT__",logo:"data:image/svg+xml;utf8,"+encodeURIComponent(e("../../images/icons/logo.svg"))};function b(e,t,n,r,y,b,_,w){var O=s((function(){var e;return m((function(){if(k&&k.groups){var t=[];return function(e,t){return e&&e.then?e.then(t):t(e)}(d((function(){return f(k.groups,(function(e){t=e}))}),(function(e){_.error("Unable to fetch group configuration: ".concat(e.message))})),(function(){return f(E(t),(function(t){e=t}))}))}return l(S,(function(t){e=t}))}),(function(){return e}))})),E=s((function(e){return f(t.profile.groups.read({expand:P}),(function(t){var n;return f(Promise.all(e.map((function(e){return t.find((function(t){return t.id===e||t.groupid===e}))||function(e){return f(d((function(){return f(A(e))}),(function(e){return n=e,null})))}(e)}))),(function(e){var t=e.filter((function(e){return null!==e}));return D(t),n&&_.error("Unable to fetch groups: ".concat(n.message),{autoDismiss:!1}),t}))}))})),S=s((function(){var r;return m((function(){if(n)return l(N,(function(e){r=e}))}),(function(){M||(M=!0,(0,c.watch)(e.subscribe,x,(function(){O()})),(0,c.watch)(e.subscribe,[function(){return e.hasFetchedProfile()},function(){return e.profile().userid}],(function(e,t){h(t,1)[0]&&O()})));var n=e.directLinkedAnnotationId(),o=null;n&&(o=t.annotation.get({id:n}).catch((function(){return null})));var i=e.directLinkedGroupId(),u=null;i&&(u=A(i).then((function(t){return e.clearDirectLinkedGroupFetchFailed(),t})).catch((function(){return e.setDirectLinkedGroupFetchFailed(),null})));var s={expand:P};return T&&(s.authority=T),r&&(s.document_uri=r),f(Promise.all([t.profile.groups.read({expand:P}),t.groups.list(s),w.tokenGetter(),o,u]),(function(e){var t=h(e,5),n=t[0],o=t[1],u=t[2],c=t[3],s=t[4];s&&!o.some((function(e){return e.id===s.id}))&&o.push(s);var l=null;return m((function(){if(c){l=c.group;var e=n.concat(o).find((function(e){return e.id===c.group}));return function(e){var t=e();if(t&&t.then)return t.then(p)}((function(){if(!e)return function(e){if(e&&e.then)return e.then(p)}(d((function(){return f(A(c.group),(function(e){o.push(e)}))}),(function(){_.error("Unable to fetch group for linked annotation")})))}))}}),(function(){var e=null!==u;return f(j((0,a.combineGroups)(n,o,r,b),e,l,i),(function(e){return D(e,l||i||null),e}))}))}))}))})),A=s((function(e){return t.group.read({id:e,expand:P})})),j=s((function(t,n,r,o){if(o){var i=t.find((function(e){return e.id===o}));i&&!i.isScopedToUri&&i.scopes&&i.scopes.enforced&&(t=t.filter((function(e){return e.id!==o})),e.setDirectLinkedGroupFetchFailed(),o=null)}return n?t:t.some((function(e){return"__world__"!==e.id&&e.isScopedToUri}))?"__world__"===o||"__world__"===r?t:t.filter((function(e){return"__world__"!==e.id})):t})),k=(0,o.default)(b),T=k?k.authority:null,P=["organization","scopes"];function x(){var t=e.mainFrame();return t?t.uri:null}function N(){return(0,u.awaitStateChange)(e,x)}function C(t){var n=e.focusedGroupId();e.focusGroup(t);var r=e.focusedGroupId();if(n!==r&&null!==n){var o=[];e.newAnnotations().forEach((function(e){(0,i.isReply)(e)||o.push(Object.assign({},e,{group:r}))})),o.length&&e.addAnnotations(o),e.setDefault("focusedGroup",r)}}var M=!1;function D(t,n){!function(e){e.forEach((function(e){e.organization&&"object"===v(e.organization)||(e.organization=g)}))}(t);var r=0===e.allGroups().length,o=e.getDefault("focusedGroup");e.loadGroups(t),r&&(t.some((function(e){return e.id===n}))?C(n):t.some((function(e){return e.id===o}))&&C(o))}return{all:function(){return e.allGroups()},get:function(t){return e.getGroup(t)},leave:function(e){return t.group.member.delete({pubid:e,userid:"me"})},load:O,focus:C}}},{"../../images/icons/logo.svg":58,"../service-config":149,"../util/annotation-metadata":192,"../util/groups":203,"../util/state":217,"../util/watch":228}],158:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var r,o=(r=e("../search-client"))&&r.__esModule?r:{default:r},i=e("../util/annotation-metadata");function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function s(e,t,n,r){var u=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(o){var u,s;return t.clearAnnotations(),function(e,t){return e&&e.then?e.then(t):t(e)}(function(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}((function(){return t.annotationFetchStarted(),c(e.annotation.get({id:o}),(function(t){return u=t,function(e,t){var n=e();return n&&n.then?n.then(t):t(n)}((function(){if((0,i.isReply)(u))return c(e.annotation.get({id:u.references[0]}),(function(e){u=e}))}),(function(){return c(e.search({references:u.id}),(function(e){s=e}))}))}))}),(function(e,n){return t.annotationFetchFinished(),function(e,t){if(e)throw t;return t}(e,n)})),(function(){var e=[u].concat(a(s.rows));return t.addAnnotations(e),(0,i.isReply)(u)||(r.addClause("/references","one_of",u.id,!0).addClause("/id","equals",u.id,!0),n.setConfig("filter",{filter:r.getFilter()}),n.connect()),e}))})),s=null;return{load:function(i,a){t.removeAnnotations(t.savedAnnotations()),s&&s.cancel(),i.length>0&&(function(n,r){(s=new o.default(e.search,{incremental:!0,separateReplies:!1})).on("results",(function(e){e.length&&t.addAnnotations(e)})),s.on("error",(function(e){console.error(e)})),s.on("end",(function(){s=null,t.frames().forEach((function(e){0<=n.indexOf(e.uri)&&t.updateFrameAnnotationFetchStatus(e.uri,!0)})),t.annotationFetchFinished()})),t.annotationFetchStarted(),s.get({uri:n,group:r})}(i,a),r.resetFilter().addClause("/uri","one_of",i),n.setConfig("filter",{filter:r.getFilter()}))},loadThread:u}}c.$inject=["value","then","direct"],s.$inject=["api","store","streamer","streamFilter"]},{"../search-client":148,"../util/annotation-metadata":192}],159:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=i,i.$inject=["$window"];var o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._store={}}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"getItem",value:function(e){return e in this._store?this._store[e]:null}},{key:"setItem",value:function(e,t){this._store[e]=t}},{key:"removeItem",value:function(e){delete this._store[e]}}]),e}();function i(e){var t,n="hypothesis.testKey";try{t=e.localStorage,e.localStorage.setItem(n,n),e.localStorage.getItem(n),e.localStorage.removeItem(n)}catch(e){t=new o}return{getItem:function(e){return t.getItem(e)},getObject:function(e){var n=t.getItem(e);return n?JSON.parse(n):null},setItem:function(e,n){t.setItem(e,n)},setObject:function(e,n){var r=JSON.stringify(n);t.setItem(e,r)},removeItem:function(e){t.removeItem(e)}}}},{}],160:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=f;var r=e("tiny-emitter"),o=u(e("../service-config")),i=u(e("../util/oauth-client")),a=e("../util/url");function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){}function f(e,t,n,u,s){var f,d,p,m=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(){return function(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(Promise.all([d,b()]),(function(e){var t=c(e,2),r=t[0],o=t[1];return function(e,t){var n=e();return n&&n.then?n.then(t):t(n)}((function(){if(r)return function(e,t){if(!t)return e&&e.then?e.then(l):Promise.resolve()}(o.revokeToken(r.accessToken))}),(function(){d=Promise.resolve(null),n.removeItem(y())}))}))})),h=(0,a.resolve)("token",u.apiUrl);function y(){var e=new URL(u.apiUrl).hostname;return e=e.replace(/\./g,"%2E"),"hypothesis.oauth.".concat(e,".token")}function v(e){n.setObject(y(),e)}var g=new r.TinyEmitter;function b(){return p?Promise.resolve(p):t.links().then((function(e){return p=new i.default({clientId:u.oauthClientId,authorizationEndpoint:e["oauth.authorize"],revokeEndpoint:e["oauth.revoke"],tokenEndpoint:h})}))}return e.addEventListener("storage",(function(e){e.key===y()&&(d=null,g.emit("oauthTokensChanged"))})),Object.assign(g,{login:function(){var t=i.default.openAuthPopupWindow(e);return b().then((function(n){return n.authorize(e,t)})).then((function(e){f=e,d=null}))},logout:m,tokenGetter:function e(){if(!d){var t=(0,o.default)(u);if(t&&void 0!==t.grantToken)d=t.grantToken?b().then((function(e){return e.exchangeGrantToken(t.grantToken)})).catch((function(e){throw"You must reload the page to annotate.",s.error("Hypothesis login lost: ".concat("You must reload the page to annotate."),{autoDismiss:!1}),e})):Promise.resolve(null);else if(f){var r=f;f=null,d=b().then((function(e){return e.exchangeAuthCode(r)})).then((function(e){return v(e),e}))}else d=Promise.resolve((i=n.getObject(y()))&&"string"==typeof i.accessToken&&"string"==typeof i.refreshToken&&"number"==typeof i.expiresAt?{accessToken:i.accessToken,refreshToken:i.refreshToken,expiresAt:i.expiresAt}:null)}var i,a=d;return d.then((function(t){if(!t)return null;if(a!==d)return e();if(Date.now()>t.expiresAt){var n=!0,r=(0,o.default)(u);return r&&void 0!==r.grantToken&&(n=!1),d=(i=t.refreshToken,c={persist:n},b().then((function(e){return e.refreshToken(i)})).then((function(e){return c.persist&&v(e),e}))).then((function(e){if(Date.now()>e.expiresAt)throw new Error("Refreshed token expired in the past");return e})).catch((function(){return null})),e()}return t.accessToken;var i,c}))}})}f.$inject=["$window","apiRoutes","localStorage","settings","toastMessenger"]},{"../service-config":149,"../util/oauth-client":207,"../util/url":224,"tiny-emitter":24}],161:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i;var r=e("../util/watch");i.$inject=["localStorage","store"];var o={annotationPrivacy:"hypothesis.privacy",focusedGroup:"hypothesis.groups.focus"};function i(e,t){function n(t,n){for(var r in t)n[r]!==t[r]&&r in o&&e.setItem(o[r],t[r])}return{init:function(){Object.keys(o).forEach((function(n){var r=e.getItem(o[n]);t.setDefault(n,r)})),(0,r.watch)(t.subscribe,(function(){return t.getDefaults()}),n)}}}},{"../util/watch":228}],162:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("query-string"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=!1;function r(){var i=function(){var t,n=e.location.pathname.slice(1).split("/"),r=o.parse(e.location.search);switch(n[0]){case"a":t="annotation",r.id=n[1]||"";break;case"stream":t="stream";break;default:t="sidebar"}return{route:t,params:r}}(),a=i.route,u=i.params;t.changeRoute(a,u),n||(e.addEventListener("popstate",(function(){r()})),n=!0)}return{sync:r,navigate:function(t,n){e.history.pushState({},"",function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=u({},n);switch(e){case"annotation":var i=n.id;delete r.id,t="/a/".concat(i);break;case"stream":t="/stream";break;default:throw new Error('Cannot generate URL for route "'.concat(e,'"'))}var a=o.stringify(r);return a.length>0&&(t+="?"+a),t}(t,n)),r()}}}s.$inject=["$window","store"]},{"query-string":12}],163:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util/url"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e,t){return t.links().then(e.updateLinks).catch((function(e){console.warn("The links API request was rejected: "+e.message)})),function(t,n){var r=e.getState().links;if(null===r)return"";var i=r[t];if(!i)throw new Error("Unknown link "+t);n=n||{};var a=o.replaceURLParams(i,n),u=Object.keys(a.params);if(u.length>0)throw new Error("Unknown link parameters: "+u.join(", "));return a.url}}a.$inject=["store","apiRoutes"]},{"../util/url":224}],164:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var o,i=(o=e("../service-config"))&&o.__esModule?o:{default:o},a=s(e("../util/retry")),u=s(e("../util/sentry"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}l.$inject=["analytics","store","api","auth","settings","toastMessenger"];function l(e,t,n,r,o,c){var s,l,f={};function d(){return(!l||Date.now()-l>3e5)&&(l=Date.now(),s=a.retryPromiseOperation((function(){var e,t=null===(e=(0,i.default)(o))?null:e.authority,r={};return t&&(r.authority=t),n.profile.read(r)}),f).then((function(e){return p(e),l=Date.now(),e})).catch((function(e){throw l=null,e}))),s}function p(e){var n=t.profile(),r=e.userid!==n.userid;return t.updateProfile(e),s=Promise.resolve(e),l=Date.now(),r&&(e.userid?u.setUserInfo({id:e.userid}):u.setUserInfo(null)),e}function m(){return s=null,l=null,d()}return r.on("oauthTokensChanged",(function(){m()})),{dismissSidebarTutorial:function(){return n.profile.update({},{preferences:{show_sidebar_tutorial:!1}}).then(p)},load:d,logout:function(){return r.logout().then((function(){return m()})).catch((function(t){throw c.error("Log out failed"),e.track(e.events.LOGOUT_FAILURE),new Error(t)})).then((function(){e.track(e.events.LOGOUT_SUCCESS)}))},reload:m,profileFetchRetryOpts:f,get state(){return t.profile()},update:p}}},{"../service-config":149,"../util/retry":212,"../util/sentry":214}],165:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.filter={match_policy:"include_any",clauses:[],actions:{create:!0,update:!0,delete:!0}}}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"addClause",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.filter.clauses.push({field:e,operator:t,value:n,case_sensitive:r}),this}},{key:"getFilter",value:function(){return this.filter}},{key:"resetFilter",value:function(){return this.filter={match_policy:"include_any",clauses:[],actions:{create:!0,update:!0,delete:!0}},this}}]),e}();n.default=o},{}],166:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=f;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("query-string")),i=s(e("../../shared/warn-once")),a=e("../util/random"),u=s(e("../websocket")),c=e("../util/watch");function s(e){return e&&e.__esModule?e:{default:e}}function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e,t,n,r,s){var l,f=(0,a.generateHexString)(32),d={};function p(e){(0,i.default)("Error connecting to H push notification service:",e);var t=new URL(s.websocketUrl).hostname;-1!==["localhost","127.0.0.1"].indexOf(t)&&(0,i.default)("Check that your H service is configured to allow WebSocket connections from "+window.location.origin)}function m(t){var o=JSON.parse(t.data);if(o)if("annotation-notification"===o.type)!function(t){var n=t.options.action,r=t.payload;switch(n){case"create":case"update":case"past":e.receiveRealTimeUpdates({updatedAnnotations:r});break;case"delete":e.receiveRealTimeUpdates({deletedAnnotations:r})}"sidebar"!==e.route()&&_()}(o);else if("session-change"===o.type)!function(e){r.update(e.model),n.load()}(o);else if("whoyouare"===o.type){var a=e.profile().userid;o.userid!==a&&console.warn('WebSocket user ID "%s" does not match logged-in ID "%s"',o.userid,a)}else(0,i.default)("received unsupported notification",o.type)}function h(){Object.keys(d).forEach((function(e){d[e]&&l.send(d[e])}))}function y(e,t){d[e]=t,l&&l.isConnected()&&l.send(t)}var v=function(){return s.websocketUrl?t.tokenGetter().then((function(e){var t;if(e){var n=new URL(s.websocketUrl),r=o.parse(n.search);r.access_token=e,n.search=o.stringify(r),t=n.toString()}else t=s.websocketUrl;(l=new u.default(t)).on("open",h),l.on("error",p),l.on("message",m),y("client-id",{messageType:"client_id",value:f}),y("auth-check",{type:"whoami",id:1})})).catch((function(e){console.error("Failed to fetch token for WebSocket authentication",e)})):Promise.resolve()},g=!1;function b(){return l&&l.close(),v()}function _(){var t=Object.values(e.pendingUpdates());t.length&&e.addAnnotations(t);var n=Object.keys(e.pendingDeletions()).map((function(e){return{id:e}}));n.length&&e.removeAnnotations(n),e.clearPendingUpdates()}this.applyPendingUpdates=_,this.clientId=f,this.configMessages=d,this.connect=function(){return g||(g=!0,(0,c.watch)(e.subscribe,(function(){return e.profile().userid}),(function(){b()}))),l?Promise.resolve():v()},this.reconnect=b,this.setConfig=y}f.$inject=["store","auth","groups","session","settings"]},{"../../shared/warn-once":82,"../util/random":211,"../util/watch":228,"../websocket":229,"query-string":12}],167:[function(e,t,n){"use strict";function r(e){var t="hypothesis.user.tags.list",n="hypothesis.user.tags.map";return{filter:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e.getObject(t)||[],i=0;return o.filter((function(e){return-1!==e.toLowerCase().indexOf(n.toLowerCase())&&(null===r||i<r)&&(++i,!0)}))},store:function(r){var o=e.getObject(n)||{};r.forEach((function(e){o[e.text]?(o[e.text].count+=1,o[e.text].updated=Date.now()):o[e.text]={text:e.text,count:1,updated:Date.now()}})),e.setObject(n,o);var i=Object.keys(o).sort((function(e,t){return o[e].count!==o[t].count?o[t].count-o[e].count:e.localeCompare(t)}));e.setObject(t,i)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r,r.$inject=["localStorage"]},{}],168:[function(e,t,n){"use strict";function r(e){return{forceVisible:function t(n){n.children.forEach((function(e){t(e)})),!n.visible&&n.annotation&&e.setForcedVisible(n.annotation.$tag,!0)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r,r.$inject=["store"]},{}],169:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var r=e("../util/random");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}u.$inject=["store"];function u(e){var t=function(t){var n=e.getToastMessage(t);n&&!n.isDismissed&&(e.updateToastMessage(i(i({},n),{},{isDismissed:!0})),setTimeout((function(){e.removeToastMessage(t)}),500))},n=function(n,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=a.autoDismiss,c=void 0===u||u,s=a.moreInfoURL,l=void 0===s?"":s;if(!e.hasToastMessage(n,o)){var f=(0,r.generateHexString)(10),d={type:n,id:f,message:o,moreInfoURL:l};e.addToastMessage(i({isDismissed:!1},d)),c&&setTimeout((function(){t(f)}),5e3)}};return{dismiss:t,error:function(e,t){n("error",e,t)},success:function(e,t){n("success",e,t)},notice:function(e,t){n("notice",e,t)}}}},{"../util/random":211}],170:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={},u={},c={};e.forEach((function(e){e.namespace?(r[e.namespace]=e.init.apply(e,s(t)),u[e.namespace]=(0,a.createReducer)(e.update),c[e.namespace]={selectors:e.selectors,rootSelectors:e.rootSelectors||{}}):console.warn("Store module does not specify a namespace",e)}));var l=[i.default],f=o.applyMiddleware.apply(o,l.concat(s(n))),d=o.combineReducers(u),p=o.createStore(d,r,f),m=Object.assign.apply(Object,[{}].concat(s(e.map((function(e){return e.actions}))))),h=o.bindActionCreators(m,p.dispatch),y=(0,a.bindSelectors)(c,p.getState);return Object.assign(p,h,y),p};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("redux")),i=u(e("redux-thunk")),a=(u(e("../util/immutable")),e("./util"));function u(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},{"../util/immutable":204,"./util":189,redux:14,"redux-thunk":13}],171:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=0;return function(n){return function(r){if(window.debug){++t;var o=r.type+" ("+t.toString()+")";console.group(o),console.log("Prev State:",e.getState()),console.log("Action:",r),n(r),console.log("Next State:",e.getState()),console.groupEnd()}else n(r)}}}},{}],172:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=w;var r=_(e("./create-store")),o=_(e("./debug-middleware")),i=_(e("./modules/activity")),a=_(e("./modules/annotations")),u=_(e("./modules/defaults")),c=_(e("./modules/direct-linked")),s=_(e("./modules/drafts")),l=_(e("./modules/frames")),f=_(e("./modules/groups")),d=_(e("./modules/links")),p=_(e("./modules/real-time-updates")),m=_(e("./modules/route")),h=_(e("./modules/selection")),y=_(e("./modules/session")),v=_(e("./modules/sidebar-panels")),g=_(e("./modules/toast-messages")),b=_(e("./modules/viewer"));function _(e){return e&&e.__esModule?e:{default:e}}function w(e){var t=[o.default],n=[i.default,a.default,u.default,c.default,s.default,l.default,d.default,f.default,p.default,m.default,h.default,y.default,v.default,g.default,b.default];return(0,r.default)(n,[e],t)}w.$inject=["settings"]},{"./create-store":170,"./debug-middleware":171,"./modules/activity":173,"./modules/annotations":174,"./modules/defaults":175,"./modules/direct-linked":176,"./modules/drafts":177,"./modules/frames":178,"./modules/groups":179,"./modules/links":180,"./modules/real-time-updates":181,"./modules/route":182,"./modules/selection":183,"./modules/session":184,"./modules/sidebar-panels":185,"./modules/toast-messages":186,"./modules/viewer":187}],173:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a={API_REQUEST_STARTED:function(e){return o(o({},e),{},{activeApiRequests:e.activeApiRequests+1})},API_REQUEST_FINISHED:function(e){if(0===e.activeApiRequests)throw new Error("API_REQUEST_FINISHED action when no requests were active");return o(o({},e),{},{activeApiRequests:e.activeApiRequests-1})},ANNOTATION_SAVE_STARTED:function(e,t){var n=[];t.annotation.$tag&&!e.activeAnnotationSaveRequests.includes(t.annotation.$tag)&&n.push(t.annotation.$tag);var r=e.activeAnnotationSaveRequests.concat(n);return o(o({},e),{},{activeAnnotationSaveRequests:r})},ANNOTATION_SAVE_FINISHED:function(e,t){var n=e.activeAnnotationSaveRequests.filter((function(e){return e!==t.annotation.$tag}));return o(o({},e),{},{activeAnnotationSaveRequests:n})},ANNOTATION_FETCH_STARTED:function(e){return o(o({},e),{},{activeAnnotationFetches:e.activeAnnotationFetches+1})},ANNOTATION_FETCH_FINISHED:function(e){if(0===e.activeAnnotationFetches)throw new Error("ANNOTATION_FETCH_FINISHED action when no annotation fetches were active");return o(o({},e),{},{hasFetchedAnnotations:!0,activeAnnotationFetches:e.activeAnnotationFetches-1})}},u=(0,e("../util").actionTypes)(a);var c={init:function(){return{activeAnnotationSaveRequests:[],activeApiRequests:0,activeAnnotationFetches:0,hasFetchedAnnotations:!1}},update:a,namespace:"activity",actions:{annotationFetchStarted:function(){return{type:u.ANNOTATION_FETCH_STARTED}},annotationFetchFinished:function(){return{type:u.ANNOTATION_FETCH_FINISHED}},annotationSaveStarted:function(e){return{type:u.ANNOTATION_SAVE_STARTED,annotation:e}},annotationSaveFinished:function(e){return{type:u.ANNOTATION_SAVE_FINISHED,annotation:e}},apiRequestStarted:function(){return{type:u.API_REQUEST_STARTED}},apiRequestFinished:function(){return{type:u.API_REQUEST_FINISHED}}},selectors:{hasFetchedAnnotations:function(e){return e.hasFetchedAnnotations},isLoading:function(e){return e.activeApiRequests>0||!e.hasFetchedAnnotations},isFetchingAnnotations:function(e){return e.activeAnnotationFetches>0},isSavingAnnotation:function(e,t){return!!t.$tag&&e.activeAnnotationSaveRequests.includes(t.$tag)}}};n.default=c},{"../util":189}],174:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=e("reselect"),a=f(e("../../util/annotation-metadata")),u=e("../../util/collections"),c=f(e("../util")),s=(o=e("./route"))&&o.__esModule?o:{default:o};function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function d(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return e.find((function(e){return e.id===t}))}function g(e,t){return e.find((function(e){return e.$tag===t}))}var b={ADD_ANNOTATIONS:function(e,t){var n={},r={},o=[],i=[],a=[],u=e.nextTag;return t.annotations.forEach((function(t){var i;t.id&&(i=v(e.annotations,t.id)),!i&&t.$tag&&(i=g(e.annotations,t.$tag)),i?(a.push(Object.assign({},i,t)),t.id&&(n[t.id]=!0),i.$tag&&(r[i.$tag]=!0)):(o.push(function(e,t){var n=e.$orphan;return e.id||(n=!1),Object.assign({},e,{$anchorTimeout:!1,$tag:e.$tag||t,$orphan:n})}(t,"t"+u)),++u)})),e.annotations.forEach((function(e){n[e.id]||r[e.$tag]||i.push(e)})),{annotations:o.concat(a).concat(i),nextTag:u}},CLEAR_ANNOTATIONS:function(){return{annotations:[],focused:{},highlighted:{}}},FOCUS_ANNOTATIONS:function(e,t){return{focused:(0,u.toTrueMap)(t.focusedTags)}},HIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((function(e){return e.id!==t.id?e:h(h({},e),{},{hidden:!0})}))}},HIGHLIGHT_ANNOTATIONS:function(e,t){return{highlighted:t.highlighted}},REMOVE_ANNOTATIONS:function(e,t){return{annotations:d(t.remainingAnnotations)}},UNHIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((function(e){return e.id!==t.id?e:Object.assign({},e,{hidden:!1})}))}},UPDATE_ANCHOR_STATUS:function(e,t){return{annotations:e.annotations.map((function(e){if(!t.statusUpdates.hasOwnProperty(e.$tag))return e;var n=t.statusUpdates[e.$tag];return"timeout"===n?Object.assign({},e,{$anchorTimeout:!0}):Object.assign({},e,{$orphan:"orphan"===n})}))}},UPDATE_FLAG_STATUS:function(e,t){return{annotations:e.annotations.map((function(e){if(e.id&&e.id===t.id){if(e.flagged===t.isFlagged)return e;var n=Object.assign({},e,{flagged:t.isFlagged});if(n.moderation){var r=t.isFlagged?1:-1;n.moderation=Object.assign({},e.moderation,{flagCount:e.moderation.flagCount+r})}return n}return e}))}}},_=c.actionTypes(b);function w(e){return{type:_.UPDATE_ANCHOR_STATUS,statusUpdates:e}}var O={init:function(){return{annotations:[],focused:{},highlighted:{},nextTag:1}},namespace:"annotations",update:b,actions:{addAnnotations:function(e){return function(t,n){var r=e.filter((function(e){return!v(n().annotations.annotations,e.id)}));if(t({type:_.ADD_ANNOTATIONS,annotations:e,currentAnnotationCount:n().annotations.annotations.length}),"sidebar"===s.default.selectors.route(n().route)){var o=r.filter(a.isWaitingToAnchor).map((function(e){return e.id}));o.length>0&&setTimeout((function(){var e=n().annotations.annotations,r=o.map((function(t){return v(e,t)})).filter((function(e){return e&&a.isWaitingToAnchor(e)})).reduce((function(e,t){return e[t.$tag]="timeout",e}),{});t(w(r))}),500)}}},clearAnnotations:function(){return{type:_.CLEAR_ANNOTATIONS}},focusAnnotations:function(e){return{type:_.FOCUS_ANNOTATIONS,focusedTags:e}},hideAnnotation:function(e){return{type:_.HIDE_ANNOTATION,id:e}},highlightAnnotations:function(e){return{type:_.HIGHLIGHT_ANNOTATIONS,highlighted:(0,u.toTrueMap)(e)}},removeAnnotations:function(e){return function(t,n){var r=function(e,t){var n={},r={};return t.forEach((function(e){e.id&&(n[e.id]=!0),e.$tag&&(r[e.$tag]=!0)})),e.filter((function(e){return!(e.id&&e.id in n||e.$tag&&e.$tag in r)}))}(n().annotations.annotations,e);t({type:_.REMOVE_ANNOTATIONS,annotationsToRemove:e,remainingAnnotations:r})}},unhideAnnotation:function(e){return{type:_.UNHIDE_ANNOTATION,id:e}},updateAnchorStatus:w,updateFlagStatus:function(e,t){return{type:_.UPDATE_FLAG_STATUS,id:e,isFlagged:t}}},selectors:{annotationCount:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return(0,u.countIf)(e,a.isAnnotation)})),annotationExists:function(e,t){return e.annotations.some((function(e){return e.id===t}))},findAnnotationByID:function(e,t){return v(e.annotations,t)},findIDsForTags:function(e,t){var n=[];return t.forEach((function(t){var r=g(e.annotations,t);r&&r.id&&n.push(r.id)})),n},focusedAnnotations:(0,i.createSelector)((function(e){return e.focused}),(function(e){return(0,u.trueKeys)(e)})),highlightedAnnotations:(0,i.createSelector)((function(e){return e.highlighted}),(function(e){return(0,u.trueKeys)(e)})),isAnnotationFocused:function(e,t){return!0===e.focused[t]},isWaitingToAnchorAnnotations:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return e.some(a.isWaitingToAnchor)})),newAnnotations:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return e.filter((function(e){return a.isNew(e)&&!a.isHighlight(e)}))})),newHighlights:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return e.filter((function(e){return a.isNew(e)&&a.isHighlight(e)}))})),noteCount:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return(0,u.countIf)(e,a.isPageNote)})),orphanCount:(0,i.createSelector)((function(e){return e.annotations}),(function(e){return(0,u.countIf)(e,a.isOrphan)})),savedAnnotations:function(e){return e.annotations.filter((function(e){return!a.isNew(e)}))}}};n.default=O},{"../../util/annotation-metadata":192,"../../util/collections":195,"../util":189,"./route":182,reselect:15}],175:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={SET_DEFAULT:function(e,t){return function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t.defaultKey,t.value)}},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(i);var u={init:function(){return{annotationPrivacy:null,focusedGroup:null}},namespace:"defaults",update:i,actions:{setDefault:function(e,t){return{type:a.SET_DEFAULT,defaultKey:e,value:t}}},selectors:{getDefault:function(e,t){return e[t]},getDefaults:function(e){return e}}};n.default=u},{"../util":189}],176:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED:function(e,t){return{directLinkedGroupFetchFailed:t.directLinkedGroupFetchFailed}},UPDATE_DIRECT_LINKED_GROUP_ID:function(e,t){return{directLinkedGroupId:t.directLinkedGroupId}},UPDATE_DIRECT_LINKED_ANNOTATION_ID:function(e,t){return{directLinkedAnnotationId:t.directLinkedAnnotationId}},CLEAR_DIRECT_LINKED_IDS:function(){return{directLinkedAnnotationId:null,directLinkedGroupId:null}},CLEAR_SELECTION:function(){return{directLinkedAnnotationId:null,directLinkedGroupId:null,directLinkedGroupFetchFailed:!1}}},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(i);var u={init:function(e){return{directLinkedGroupId:e.group||null,directLinkedAnnotationId:e.annotations||null,directLinkedGroupFetchFailed:!1}},namespace:"directLinked",update:i,actions:{setDirectLinkedGroupFetchFailed:function(){return{type:a.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!0}},setDirectLinkedGroupId:function(e){return{type:a.UPDATE_DIRECT_LINKED_GROUP_ID,directLinkedGroupId:e}},setDirectLinkedAnnotationId:function(e){return{type:a.UPDATE_DIRECT_LINKED_ANNOTATION_ID,directLinkedAnnotationId:e}},clearDirectLinkedGroupFetchFailed:function(){return{type:a.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!1}},clearDirectLinkedIds:function(){return{type:a.CLEAR_DIRECT_LINKED_IDS}}},selectors:{directLinkedAnnotationId:function(e){return e.directLinkedAnnotationId},directLinkedGroupFetchFailed:function(e){return e.directLinkedGroupFetchFailed},directLinkedGroupId:function(e){return e.directLinkedGroupId}}};n.default=u},{"../util":189}],177:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Draft=void 0;var o=e("reselect"),i=c(e("../../util/annotation-metadata")),a=c(e("../util"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.annotation={id:t.id,$tag:t.$tag},this.isPrivate=n.isPrivate,this.tags=n.tags,this.text=n.text}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(e,[{key:"match",value:function(e){return this.annotation.$tag&&e.$tag===this.annotation.$tag||this.annotation.id&&e.id===this.annotation.id}},{key:"isEmpty",value:function(){return!this.text&&0===this.tags.length}}]),e}();n.Draft=l;var f={DISCARD_ALL_DRAFTS:function(){return[]},REMOVE_DRAFT:function(e,t){return e.filter((function(e){return!e.match(t.annotation)}))},UPDATE_DRAFT:function(e,t){var n=e.filter((function(e){return!e.match(t.draft.annotation)}));return n.push(t.draft),n}},d=a.actionTypes(f);function p(e){return{type:d.REMOVE_DRAFT,annotation:e}}function m(e,t){for(var n=e,r=0;r<n.length;r++){var o=n[r];if(o.match(t))return o}return null}function h(e,t){var n=m(e,t);return n?n.isEmpty()?null:n:null}var y={init:function(){return[]},namespace:"drafts",update:f,actions:{createDraft:function(e,t){return{type:d.UPDATE_DRAFT,draft:new l(e,t)}},deleteNewAndEmptyDrafts:function(){var t=e("./annotations").default;return function(e,n){var r=n().drafts.filter((function(e){return i.isNew(e.annotation)&&!h(n().drafts,e.annotation)})).map((function(t){return e(p(t.annotation)),t.annotation}));e(t.actions.removeAnnotations(r))}},discardAllDrafts:function(){return{type:d.DISCARD_ALL_DRAFTS}},removeDraft:p},selectors:{countDrafts:function(e){return e.length},getDraft:m,getDraftIfNotEmpty:h,unsavedAnnotations:(0,o.createSelector)((function(e){return e}),(function(e){return e.filter((function(e){return!e.annotation.id})).map((function(e){return e.annotation}))}))}};n.default=y},{"../../util/annotation-metadata":192,"../util":189,"./annotations":174,reselect:15}],178:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=e("reselect"),a=(o=e("shallowequal"))&&o.__esModule?o:{default:o};function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={CONNECT_FRAME:function(e,t){return[].concat(c(e),[t.frame])},DESTROY_FRAME:function(e,t){return e.filter((function(e){return e!==t.frame}))},UPDATE_FRAME_ANNOTATION_FETCH_STATUS:function(e,t){return e.map((function(e){return e.uri&&e.uri===t.uri?Object.assign({},e,{isAnnotationFetchComplete:t.isAnnotationFetchComplete}):e}))}},f=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(l);var d={init:function(){return[]},namespace:"frames",update:l,actions:{connectFrame:function(e){return{type:f.CONNECT_FRAME,frame:e}},destroyFrame:function(e){return{type:f.DESTROY_FRAME,frame:e}},updateFrameAnnotationFetchStatus:function(e,t){return{type:f.UPDATE_FRAME_ANNOTATION_FETCH_STATUS,isAnnotationFetchComplete:t,uri:e}}},selectors:{frames:function(e){return e},mainFrame:(0,i.createSelector)((function(e){return e}),(function(e){return e.find((function(e){return!e.id}))||null})),searchUris:(0,i.createSelectorCreator)(i.defaultMemoize,a.default)((function(e){return e.reduce((function(e,t){return e.concat(function(e){var t=[e.uri];return e.metadata&&e.metadata.documentFingerprint&&(t=e.metadata.link.map((function(e){return e.href}))),e.metadata&&e.metadata.link&&e.metadata.link.forEach((function(e){e.href.startsWith("doi:")&&t.push(e.href)})),t}(t))}),[])}),(function(e){return e}))}};n.default=d},{"../util":189,reselect:15,shallowequal:20}],179:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=e("reselect"),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../util")),u=(o=e("./session"))&&o.__esModule?o:{default:o};function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}var s={FOCUS_GROUP:function(e,t){return e.groups.find((function(e){return e.id===t.id}))?{focusedGroupId:t.id}:(console.error("Attempted to focus group ".concat(t.id," which is not loaded")),{})},LOAD_GROUPS:function(e,t){var n=t.groups,r=e.focusedGroupId;return null!==e.focusedGroupId&&n.find((function(t){return t.id===e.focusedGroupId}))||(r=n.length>0?n[0].id:null),{focusedGroupId:r,groups:t.groups}},CLEAR_GROUPS:function(){return{focusedGroupId:null,groups:[]}}},l=a.actionTypes(s);function f(e){return e.groups}function d(e,t){return e.groups.find((function(e){return e.id===t}))}var p=(0,i.createSelector)((function(e){return e.groups}),(function(e){return e.filter((function(e){return!e.isMember&&e.isScopedToUri}))})),m=(0,i.createSelector)((function(e){return e.groups}),(function(e){return e.filter((function(e){return e.isScopedToUri}))})),h=(0,i.createSelector)((function(e){return e.groups.groups}),(function(e){return u.default.selectors.isLoggedIn(e.session)}),(function(e,t){return t?e.filter((function(e){return e.isMember})):[]})),y=(0,i.createSelector)((function(e){return f(e.groups)}),(function(e){return h(e)}),(function(e){return p(e.groups)}),(function(e,t,n){return e.filter((function(e){return!t.includes(e)&&!n.includes(e)}))})),v={init:function(){return{groups:[],focusedGroupId:null}},namespace:"groups",update:s,actions:{focusGroup:function(e){return{type:l.FOCUS_GROUP,id:e}},loadGroups:function(e){return{type:l.LOAD_GROUPS,groups:e}},clearGroups:function(){return{type:l.CLEAR_GROUPS}}},selectors:{allGroups:f,focusedGroup:function(e){return e.focusedGroupId?d(e,e.focusedGroupId):null},focusedGroupId:function(e){return e.focusedGroupId},getFeaturedGroups:p,getGroup:d,getInScopeGroups:m},rootSelectors:{getCurrentlyViewingGroups:y,getMyGroups:h}};n.default=v},{"../util":189,"./session":184,reselect:15}],180:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={UPDATE_LINKS:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.newLinks)}},a=(0,e("../util").actionTypes)(i);var u={init:function(){return null},namespace:"links",update:i,actions:{updateLinks:function(e){return{type:a.UPDATE_LINKS,newLinks:e}}},selectors:{}};n.default=u},{"../util":189}],181:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("reselect"),o=e("../util"),i=c(e("./annotations")),a=c(e("./groups")),u=c(e("./route"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={RECEIVE_REAL_TIME_UPDATES:function(e,t){return{pendingUpdates:d({},t.pendingUpdates),pendingDeletions:d({},t.pendingDeletions)}},CLEAR_PENDING_UPDATES:function(){return{pendingUpdates:{},pendingDeletions:{}}},ADD_ANNOTATIONS:function(e,t){var n=t.annotations,r=d({},e.pendingUpdates);return n.forEach((function(e){return delete r[e.id]})),{pendingUpdates:r}},REMOVE_ANNOTATIONS:function(e,t){var n=t.annotationsToRemove,r=d({},e.pendingUpdates),o=d({},e.pendingDeletions);return n.forEach((function(e){delete r[e.id],delete o[e.id]})),{pendingUpdates:r,pendingDeletions:o}},FOCUS_GROUP:function(){return{pendingUpdates:{},pendingDeletions:{}}}},h=(0,o.actionTypes)(m);var y={init:function(){return{pendingUpdates:{},pendingDeletions:{}}},namespace:"realTimeUpdates",update:m,actions:{receiveRealTimeUpdates:function(e){var t=e.updatedAnnotations,n=void 0===t?[]:t,r=e.deletedAnnotations,o=void 0===r?[]:r;return function(e,t){var r=d({},t().realTimeUpdates.pendingUpdates),c=d({},t().realTimeUpdates.pendingDeletions);n.forEach((function(e){e.group!==a.default.selectors.focusedGroupId(t())&&"sidebar"===u.default.selectors.route(t())||(r[e.id]=e)})),o.forEach((function(e){delete r[e.id],i.default.selectors.annotationExists(t(),e.id)&&(c[e.id]=!0)})),e({type:h.RECEIVE_REAL_TIME_UPDATES,pendingUpdates:r,pendingDeletions:c})}},clearPendingUpdates:function(){return{type:h.CLEAR_PENDING_UPDATES}}},selectors:{hasPendingDeletion:function(e,t){return e.pendingDeletions.hasOwnProperty(t)},pendingDeletions:function(e){return e.pendingDeletions},pendingUpdates:function(e){return e.pendingUpdates},pendingUpdateCount:(0,r.createSelector)((function(e){return[e.pendingUpdates,e.pendingDeletions]}),(function(e){var t=s(e,2),n=t[0],r=t[1];return Object.keys(n).length+Object.keys(r).length}))}};n.default=y},{"../util":189,"./annotations":174,"./groups":179,"./route":182,reselect:15}],182:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={CHANGE_ROUTE:function(e,t){return{name:t.name,params:t.params}}},o=(0,e("../util").actionTypes)(r);var i={init:function(){return{name:null,params:{}}},namespace:"route",update:r,actions:{changeRoute:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:o.CHANGE_ROUTE,name:e,params:t}}},selectors:{route:function(e){return e.name},routeParams:function(e){return e.params}}};n.default=i},{"../util":189}],183:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i,a=e("reselect"),u=(i=e("../../ui-constants"))&&i.__esModule?i:{default:i},c=d(e("../../util/annotation-metadata")),s=e("../../util/collections"),l=d(e("../util"));function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function d(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=(h(o={},u.default.TAB_ANNOTATIONS,"Location"),h(o,u.default.TAB_NOTES,"Oldest"),h(o,u.default.TAB_ORPHANS,"Location"),o);function v(e){var t={};return e.annotations&&!e.query&&(t[e.annotations]=!0),t}function g(e){var t=e.user||{},n=t.username||t.userid;return n?{configured:!0,active:!0,user:{filter:n,displayName:t.displayName||n||""}}:{configured:!1,active:!1}}var b=function(e,t){return u.default.TABS.includes(e)&&t!==e?{selectedTab:e,sortKey:y[e]}:{}},_={CHANGE_FOCUS_MODE_USER:function(e,t){return m(m({},{filterQuery:null,forcedVisible:{},selected:{}}),{},{focusMode:g({user:t.user})})},CLEAR_SELECTION:function(){return{filterQuery:null,forcedVisible:{},selected:{}}},SELECT_ANNOTATIONS:function(e,t){return m(m({},{filterQuery:null,forcedVisible:{},selected:{}}),{},{selected:t.selection})},SELECT_TAB:function(e,t){return b(t.tab,e.selectedTab)},SET_EXPANDED:function(e,t){var n=m({},e.expanded);return n[t.id]=t.expanded,{expanded:n}},SET_FILTER_QUERY:function(e,t){return m(m({},{filterQuery:null,forcedVisible:{},selected:{}}),{},{expanded:{},filterQuery:t.query})},SET_FOCUS_MODE:function(e,t){var n=void 0!==t.active?t.active:!e.focusMode.active;return m(m({},{filterQuery:null,forcedVisible:{},selected:{}}),{},{focusMode:m(m({},e.focusMode),{},{active:n})})},SET_FORCED_VISIBLE:function(e,t){return{forcedVisible:m(m({},e.forcedVisible),{},h({},t.id,t.visible))}},SET_SORT_KEY:function(e,t){return{sortKey:t.key}},TOGGLE_SELECTED_ANNOTATIONS:function(e,t){var n=m({},e.selected);return t.toggleIds.forEach((function(e){n[e]=!n[e]})),{selected:n}},ADD_ANNOTATIONS:function(e,t){var n=t.annotations.filter((function(e){return!c.isReply(e)})),r=(0,s.countIf)(t.annotations,c.isPageNote)===n.length;return 0===t.currentAnnotationCount&&r?b(u.default.TAB_NOTES,e.selectedTab):{}},REMOVE_ANNOTATIONS:function(e,t){var n=e.selectedTab;n===u.default.TAB_ORPHANS&&0===(0,s.countIf)(t.remainingAnnotations,c.isOrphan)&&(n=u.default.TAB_ANNOTATIONS);var r=function(e){return t.annotationsToRemove.forEach((function(t){t.id&&delete e[t.id],t.$tag&&delete e[t.$tag]})),e};return m(m({},b(n,e.selectedTab)),{},{expanded:r(m({},e.expanded)),forcedVisible:r(m({},e.forcedVisible)),selected:r(m({},e.selected))})}},w=l.actionTypes(_);function O(e){return e.expanded}function E(e){return e.filterQuery}function S(e){return e.focusMode.active}function A(e){return e.focusMode.configured}function j(e){return S(e)?e.focusMode.user.filter:null}function k(e){return A(e)?e.focusMode.user.displayName:""}var T=(0,a.createSelector)((function(e){return e.forcedVisible}),(function(e){return(0,s.trueKeys)(e)})),P=(0,a.createSelector)((function(e){return e.selected}),(function(e){var t=(0,s.trueKeys)(e);return t.length?t[0]:null})),x=(0,a.createSelector)((function(e){return e.selected}),(function(e){return(0,s.trueKeys)(e).length>0})),N=(0,a.createSelector)((function(e){return e.selected}),(function(e){return(0,s.trueKeys)(e)})),C=(0,a.createSelector)(E,S,x,(function(e,t,n){return!!e||t||n}));function M(e){return e.selectedTab}function D(e){return e.sortKey}var I=(0,a.createSelector)((function(e){return e}),(function(e){return{filterQuery:E(e),focusActive:S(e),focusConfigured:A(e),focusDisplayName:k(e),forcedVisibleCount:T(e).length,selectedCount:N(e).length}})),L=(0,a.createSelector)((function(e){return e.annotations.annotations}),(function(e){return e.route.name}),(function(e){return e.selection}),(function(e,t,n){var r={},o=j(n);return o&&(r.user=o),{annotations:e,route:t,selection:{expanded:O(n),filterQuery:E(n),filters:r,forcedVisible:T(n),selected:N(n),sortKey:D(n),selectedTab:M(n)}}})),R={init:function(e){return{selected:v(e),expanded:v(e)||{},forcedVisible:{},filterQuery:e.query||null,focusMode:g(e.focus||{}),selectedTab:u.default.TAB_ANNOTATIONS,sortKey:y[u.default.TAB_ANNOTATIONS]}},namespace:"selection",update:_,actions:{changeFocusModeUser:function(e){return{type:w.CHANGE_FOCUS_MODE_USER,user:e}},clearSelection:function(){return{type:w.CLEAR_SELECTION}},selectAnnotations:function(e){return function(t){t({type:w.SET_FOCUS_MODE,active:!1}),t({type:w.SELECT_ANNOTATIONS,selection:(0,s.toTrueMap)(e)})}},selectTab:function(e){return{type:w.SELECT_TAB,tab:e}},setExpanded:function(e,t){return{type:w.SET_EXPANDED,id:e,expanded:t}},setFilterQuery:function(e){return{type:w.SET_FILTER_QUERY,query:e}},setForcedVisible:function(e,t){return{type:w.SET_FORCED_VISIBLE,id:e,visible:t}},setSortKey:function(e){return{type:w.SET_SORT_KEY,key:e}},toggleFocusMode:function(e){return{type:w.SET_FOCUS_MODE,active:e}},toggleSelectedAnnotations:function(e){return{type:w.TOGGLE_SELECTED_ANNOTATIONS,toggleIds:e}}},selectors:{expandedMap:O,filterQuery:E,filterState:I,focusModeActive:S,focusModeConfigured:A,focusModeUserFilter:j,focusModeUserPrettyName:k,forcedVisibleAnnotations:T,getFirstSelectedAnnotationId:P,hasAppliedFilter:C,hasSelectedAnnotations:x,selectedAnnotations:N,selectedTab:M,sortKey:D,sortKeys:function(e){var t=["Newest","Oldest"];return e.selectedTab!==u.default.TAB_NOTES&&t.push("Location"),t}},rootSelectors:{threadState:L}};n.default=R},{"../../ui-constants":190,"../../util/annotation-metadata":192,"../../util/collections":195,"../util":189,reselect:15}],184:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s={features:{},preferences:{},userid:null};var l={UPDATE_PROFILE:function(e,t){return{profile:u({},t.profile)}}},f=o.actionTypes(l);var d={init:function(){return{profile:s}},namespace:"session",update:l,actions:{updateProfile:function(e){return{type:f.UPDATE_PROFILE,profile:e}}},selectors:{hasFetchedProfile:function(e){return e.profile!==s},isFeatureEnabled:function(e,t){return!!e.profile.features[t]},isLoggedIn:function(e){return null!==e.profile.userid},profile:function(e){return e.profile}}};n.default=d},{"../util":189}],185:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={OPEN_SIDEBAR_PANEL:function(e,t){return{activePanelName:t.panelName}},CLOSE_SIDEBAR_PANEL:function(e,t){var n=e.activePanelName;return t.panelName===n&&(n=null),{activePanelName:n}},TOGGLE_SIDEBAR_PANEL:function(e,t){var n=e.activePanelName===t.panelName,r=void 0!==t.panelState?t.panelState:!n;return{activePanelName:r?t.panelName:n&&!r?null:e.activePanelName}}},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(i);var u={namespace:"sidebarPanels",init:function(){return{activePanelName:null}},update:i,actions:{openSidebarPanel:function(e){return{type:a.OPEN_SIDEBAR_PANEL,panelName:e}},closeSidebarPanel:function(e){return{type:a.CLOSE_SIDEBAR_PANEL,panelName:e}},toggleSidebarPanel:function(e,t){return{type:a.TOGGLE_SIDEBAR_PANEL,panelName:e,panelState:t}}},selectors:{isSidebarPanelOpen:function(e,t){return e.activePanelName===t}}};n.default=u},{"../util":189}],186:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c={ADD_MESSAGE:function(e,t){return{messages:e.messages.concat(a({},t.message))}},REMOVE_MESSAGE:function(e,t){return{messages:e.messages.filter((function(e){return e.id!==t.id}))}},UPDATE_MESSAGE:function(e,t){return{messages:e.messages.map((function(e){return e.id&&e.id===t.message.id?a({},t.message):e}))}}},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(c);var l={init:function(){return{messages:[]}},namespace:"toastMessages",update:c,actions:{addToastMessage:function(e){return{type:s.ADD_MESSAGE,message:e}},removeToastMessage:function(e){return{type:s.REMOVE_MESSAGE,id:e}},updateToastMessage:function(e){return{type:s.UPDATE_MESSAGE,message:e}}},selectors:{getToastMessage:function(e,t){return e.messages.find((function(e){return e.id===t}))},getToastMessages:function(e){return e.messages},hasToastMessage:function(e,t,n){return e.messages.some((function(e){return e.type===t&&e.message===n}))}}};n.default=l},{"../util":189}],187:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={SET_HIGHLIGHTS_VISIBLE:function(e,t){return{visibleHighlights:t.visible}},SET_SIDEBAR_OPENED:function(e,t){return!0===t.opened?{sidebarHasOpened:!0}:{}}},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../util")).actionTypes(i);var u={init:function(){return{sidebarHasOpened:!1,visibleHighlights:!1}},namespace:"viewer",update:i,actions:{setShowHighlights:function(e){return{type:a.SET_HIGHLIGHTS_VISIBLE,visible:e}},setSidebarOpened:function(e){return{type:a.SET_SIDEBAR_OPENED,opened:e}}},selectors:{hasSidebarOpened:function(e){return e.sidebarHasOpened}}};n.default=u},{"../util":189}],188:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=(0,i.useService)("store"),n=(0,r.useRef)(null);n.current=e;var a=(0,r.useRef)(void 0);a.current=e(t);var c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useReducer)((function(e){return e+1}),0),2)[1];return(0,r.useEffect)((function(){function e(){var e=n.current(t);(0,o.default)(e,a.current)||(a.current=e,c())}return e(),t.subscribe(e)}),[c,t]),a.current};var r=e("preact/hooks"),o=a(e("shallowequal")),i=(a(e("../../shared/warn-once")),e("../util/service-context"));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},{"../../shared/warn-once":82,"../util/service-context":215,"preact/hooks":8,shallowequal:20}],189:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(n,"__esModule",{value:!0}),n.actionTypes=function(e){return Object.keys(e).reduce((function(e,t){return e[t]=t,e}),{})},n.createReducer=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=e[n.type];return r?Array.isArray(t)?a(r(t,n)):o(o({},t),r(t,n)):t}},n.bindSelectors=function(e,t){var n={};return Object.keys(e).forEach((function(r){var o=e[r],i=o.selectors,a=o.rootSelectors,u=void 0===a?{}:a;Object.keys(i).forEach((function(e){if(n[e])throw new Error('Duplicate selector "'.concat(e,'"'));n[e]=function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return i[e].apply(i,[t()[r]].concat(o))}})),Object.keys(u).forEach((function(e){if(n[e])throw new Error('Duplicate selector "'.concat(e,'"'));n[e]=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return u[e].apply(u,[t()].concat(r))}}))})),n}},{}],190:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={PANEL_HELP:"help",PANEL_LOGIN_PROMPT:"loginPrompt",PANEL_SHARE_ANNOTATIONS:"shareGroupAnnotations",TABS:["annotation","note","orphan"],TAB_ANNOTATIONS:"annotation",TAB_NOTES:"note",TAB_ORPHANS:"orphan"}},{}],191:[function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.match(/^acct:([^@]+)@(.+)/);return t?{username:t[1],provider:t[2]}:null}Object.defineProperty(n,"__esModule",{value:!0}),n.parseAccountID=r,n.username=function(e){var t=r(e);return t?t.username:""},n.isThirdPartyUser=function(e,t){var n=r(e);return!!n&&n.provider!==t}},{}],192:[function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t=e.uri,n=new URL(t).hostname,r=n;return e.document&&e.document.title&&(r=e.document.title[0]),"localhost"===n&&(n=""),{uri:t,domain:n,title:r}}function a(e){var t=e.uri;return t&&0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=null),e.links&&e.links.incontext&&(t=e.links.incontext),t}function u(e){var t=i(e),n="";if(t.uri&&0===t.uri.indexOf("file://")&&t.title){var r=t.uri.split("/"),o=r[r.length-1];o&&(n=o)}else t.domain&&t.domain!==t.title&&(n=t.domain);return n}function c(e){var t=i(e).title;return t.length>30&&(t=t.slice(0,30)+""),t}function s(e){return(e.references||[]).length>0}function l(e){return!e.id}function f(e){return!!(e.target&&e.target.length>0&&e.target[0].selector)}function d(e){return f(e)&&e.$orphan}function p(e){return!f(e)&&!s(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.documentMetadata=i,n.domainAndTitle=function(e){return{domain:u(e),titleText:c(e),titleLink:a(e)}},n.isReply=s,n.isNew=l,n.isPublic=function(e){var t=!1;return e.permissions?(e.permissions.read.forEach((function(e){var n=e.split(":");2===n.length&&"group"===n[0]&&(t=!0)})),t):t},n.isWaitingToAnchor=function(e){return f(e)&&void 0===e.$orphan&&!e.$anchorTimeout},n.isHidden=function(e){return!!e.hidden},n.isHighlight=function(e){return!!e.$highlight||!l(e)&&!(p(e)||s(e)||e.hidden||e.text||e.tags&&e.tags.length)},n.isOrphan=d,n.isPageNote=p,n.isAnnotation=function(e){return!(!f(e)||d(e))},n.location=function(e){if(e)for(var t=e.target||[],n=0;n<t.length;n++){var o,i=r(t[n].selector||[]);try{for(i.s();!(o=i.n()).done;){var a=o.value;if("TextPositionSelector"===a.type)return a.start}}catch(e){i.e(e)}finally{i.f()}}return Number.POSITIVE_INFINITY},n.flagCount=function(e){return e.moderation?e.moderation.flagCount:null},n.quote=function(e){if(0===e.target.length)return null;var t=e.target[0];if(!t.selector)return null;var n=t.selector.find((function(e){return"TextQuoteSelector"===e.type}));return n?n.exact:null}},{}],193:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sharingEnabled=i,n.shareURI=a,n.isShareable=function(e,t){return!(!i(t)||!a(e))};var r,o=(r=e("../service-config"))&&r.__esModule?r:{default:r};function i(e){var t=(0,o.default)(e);return null===t||"boolean"!=typeof t.enableShareLinks||t.enableShareLinks}function a(e){var t=e.links;return t&&(t.incontext||t.html)}},{"../service-config":149}],194:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=o(o({},h),t),r=!!n.filterFn,i=!!n.threadFilterFn,c=n.selected.length>0,f=n.forcedVisible&&n.forcedVisible.length,y=function(e){var t={};e.forEach((function(e){var n=u(e);t[n]=o(o({},a),{},{children:[],annotation:e,id:n})})),e.forEach((function(e){var n=(e.references||[]).filter((function(t){return t!==e.id}));return s(t,u(e),n)}));var n=[];for(var r in t)t[r].parent||(t[r].collapsed=!0,n.push(t[r]));return o(o({},a),{},{id:"root",children:n,totalChildren:n.length})}(e);return c&&(y.children=y.children.filter((function(e){var t=n.selected.includes(e.id),r=f&&e.annotation&&n.forcedVisible.includes(e.annotation.$tag);return t||r}))),i&&(y.children=y.children.filter(n.threadFilterFn)),(y=l(y,(function(e){var t=e.visible;return e.annotation?r&&(t=!(!f||!n.forcedVisible.includes(e.annotation.$tag))||!!n.filterFn(e.annotation)):t=!1,o(o({},e),{},{visible:t})}))).children=y.children.filter((function(e){return e.visible||m(e)})),y=p(y=d(y=l(y,(function(e){var t={collapsed:e.collapsed};if(n.expanded.hasOwnProperty(e.id))t.collapsed=!n.expanded[e.id];else{var i=r&&m(e);t.collapsed=e.collapsed&&!i}return o(o({},e),t)})),n.sortCompareFn,n.replySortCompareFn),-1)};var a={collapsed:!1,visible:!0,replyCount:0,totalChildren:0};function u(e){return e.id||e.$tag}function c(e,t,n){return!(!e[n]||e[n].parent===t)&&(!e[n].parent||c(e,t,e[n].parent))}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e[t].parent&&n.length){var r=n[n.length-1];e[r]||(e[r]=o(o({},a),{},{children:[],id:r}),s(e,r,n.slice(0,-1))),c(e,t,r)&&(e[t].parent=r,e[r].children.push(e[t]))}}function l(e,t){return Object.assign({},t(e),{children:e.children.map((function(e){return l(e,t)}))})}function f(e,t){return e.slice().sort((function(e,n){return e.annotation&&n.annotation?t(e.annotation,n.annotation)?-1:t(n.annotation,e.annotation)?1:0:e.annotation||n.annotation?e.annotation?1:-1:0}))}function d(e,t,n){var r=e.children.map((function(e){return d(e,n,n)}));return o(o({},e),{},{children:f(r,t)})}function p(e,t){var n=e.children.map((function(e){return p(e,t+1)})),r=n.reduce((function(e,t){return e+1+t.replyCount}),0);return o(o({},e),{},{children:n,depth:t,replyCount:r})}function m(e){return e.children.some((function(e){return e.visible||m(e)}))}var h={selected:[],expanded:{},sortCompareFn:function(e,t){return e.id<t.id},replySortCompareFn:function(e,t){return e.created<t.created}}},{}],195:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.countIf=function(e,t){return e.reduce((function(e,n){return t(n)?e+1:e}),0)},n.toTrueMap=function(e){var t={};return e.forEach((function(e){return t[e]=!0})),t},n.trueKeys=function(e){return Object.keys(e).filter((function(t){return!0===e[t]}))}},{}],196:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.copyText=function(e){var t=document.createElement("pre");t.className="copy-text",t.textContent=e,document.body.appendChild(t);try{var n=document.createRange(),r=document.getSelection();r.removeAllRanges(),n.selectNodeContents(t),r.addRange(n),document.execCommand("copy")}finally{t.remove()}}},{}],197:[function(e,t,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.format=function(e){return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(r||(r=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"})),r.format(e)):e.toDateString()+" "+e.toLocaleTimeString()}},{}],198:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){e.addEventListener("click",(function(e){var t=e.target;if("A"===t.tagName){var n=t;"_blank"===n.target&&(n.rel="noopener")}}))}},{}],199:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getElementHeightWithMargins=function(e){var t=window.getComputedStyle(e);return e.getBoundingClientRect().height+(parseFloat(t.marginTop)+parseFloat(t.marginBottom))},n.listen=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.useCapture,i=void 0!==o&&o;return Array.isArray(t)||(t=[t]),t.forEach((function(t){return e.addEventListener(t,n,i)})),function(){t.forEach((function(t){return e.removeEventListener(t,n,i)}))}}},{}],200:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.fetchConfig=void 0;var o=c(e("../get-api-url")),i=c(e("../host-config")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./postmessage-json-rpc"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){u=!0,i=e})),f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){if(e===e.top)return[];var t=[];do{e=e.parent,t.push(e)}while(e!==e.top);return t}function y(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,r=[],o=p(h(n));try{for(o.s();!(t=o.n()).done;){var i=t.value,u=3e3,c=a.call(i,e,"requestConfig",[],u);r.push(c)}}catch(e){o.e(e)}finally{o.f()}return 0===r.length&&r.push(Promise.reject(new Error("Client is top frame"))),Promise.race(r)}function v(e,t){var n=f(f({},e),t);return n.apiUrl=(0,o.default)(n),n}var g=s((function(e,t){void 0===t&&(t=window);var n=(0,i.default)(window),r=n.requestConfigFromFrame;if(!r)return v(e,n);if("string"==typeof r)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return y((0,i.default)(t).requestConfigFromFrame,t).then((function(t){var n=Object.assign({},e,t);return n.apiUrl=(0,o.default)(n),n}))}(e,t);if("number"==typeof r.ancestorLevel&&"string"==typeof r.origin){var a=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=0;n<e;n++){if(t===t.top)throw new Error("The target parent frame has exceeded the ancestor tree. Try reducing the `requestConfigFromFrame.ancestorLevel` value in the `hypothesisConfig`");t=t.parent}return t}(r.ancestorLevel,t);return _(e,a,r.origin)}throw new Error("Improper `requestConfigFromFrame` object. Both `ancestorLevel` and `origin` need to be specified")}));n.fetchConfig=g;var b=s((function(e,t){return Array.isArray(e.services)&&e.services.forEach((function(e,n){"$rpc:requestGroups"===e.groups&&(e.groups=t("requestGroups",[n],null).catch((function(){throw new Error("Unable to fetch groups")})))})),e})),_=s((function(e,t,n){return function(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(a.call(t,n,"requestConfig",[],3e3),(function(r){var o=v(e,r);return b(o,(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;return a.call(t,n,e,r,o)}))}))}))},{"../get-api-url":141,"../host-config":142,"./postmessage-json-rpc":210}],201:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.orgName=function(e){return e.organization&&e.organization.name}},{}],202:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=function(e){var t={};return e.forEach((function(e){if("object"===u(e.organization)){var n=function(e){return e.id===c?c:"".concat(e.name.toLowerCase()).concat(e.id)}(e.organization);void 0===t[n]&&(t[n]=Object.assign({},e.organization),t[n].groups=[]),function(e,t){var n=Object.assign({},e),r=t.groups;!r.length&&e.organization.logo&&(n.logo=e.organization.logo),r.push((0,o.default)(n))}(e,t[n])}})),t}(e),n=[],r=[];return Object.keys(t).sort().forEach((function(e){e===c?n.push.apply(n,i(t[e].groups)):r.push.apply(r,i(t[e].groups))})),n.length&&r.push.apply(r,n),r};var r,o=(r=e("./immutable"))&&r.__esModule?r:{default:r};function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c="__default__"},{"./immutable":204}],203:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.combineGroups=function(e,t,n,i){var a=t.find((function(e){return"__world__"===e.id}));a&&e.unshift(a);var u=e.map((function(e){return e.id}));(t=t.filter((function(e){return!u.includes(e.id)}))).forEach((function(e){return e.isMember=!1})),e.forEach((function(e){return e.isMember=!0}));var c=e.concat(t);return c.forEach((function(e){e.canLeave=!!function(e){var t=(0,o.default)(e);return!t||!!t.allowLeavingGroups}(i)&&"private"===e.type})),c.forEach((function(e){return e.isScopedToUri=function(e,t){return!(e.scopes&&e.scopes.uri_patterns.length>0&&t)||function(e,t){return void 0!==t.find((function(t){return e.match(t.split("*").map(r.default).join(".*"))}))}(t,e.scopes.uri_patterns)}(e,n)})),c};var r=i(e("escape-string-regexp")),o=i(e("../service-config"));function i(e){return e&&e.__esModule?e:{default:e}}},{"../service-config":149,"escape-string-regexp":4}],204:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e}},{}],205:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=(0,o.default)(e);return null!==t&&!!t.hasOwnProperty("authority")&&t.authority!==e.authDomain};var r,o=(r=e("../service-config"))&&r.__esModule?r:{default:r}},{"../service-config":149}],206:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(1!==e.length)throw new Error("Memoize input must be a function of one argument");var t,n;return function(r){return r===t?n:(t=r,n=e(r))}}},{}],207:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(e("query-string")),o=a(e("./random"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return e.json().then((function(e){return{accessToken:e.access_token,expiresAt:Date.now()+1e3*(e.expires_in-10),refreshToken:e.refresh_token}}))}function l(){return o.generateHexString(16)}var f=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.clientId=t.clientId,this.tokenEndpoint=t.tokenEndpoint,this.authorizationEndpoint=t.authorizationEndpoint,this.revokeEndpoint=t.revokeEndpoint,this.generateState=t.generateState||l}return function(e,t,n){t&&c(e.prototype,t),n&&c(e,n)}(e,[{key:"exchangeAuthCode",value:function(e){var t={client_id:this.clientId,grant_type:"authorization_code",code:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Authorization code exchange failed");return s(e)}))}},{key:"exchangeGrantToken",value:function(e){var t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Failed to retrieve access token");return s(e)}))}},{key:"refreshToken",value:function(e){var t={grant_type:"refresh_token",refresh_token:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Failed to refresh access token");return s(e)}))}},{key:"revokeToken",value:function(e){return this._formPost(this.revokeEndpoint,{token:e})}},{key:"authorize",value:function(e,t){var n=this.generateState(),o=new Promise((function(t,r){e.addEventListener("message",(function o(i){"object"===u(i.data)&&i.data.state===n&&("authorization_response"===i.data.type&&t(i.data),"authorization_canceled"===i.data.type&&r(new Error("Authorization window was closed")),e.removeEventListener("message",o))}))})),i=this.authorizationEndpoint;return i+="?"+r.stringify({client_id:this.clientId,origin:e.location.origin,response_mode:"web_message",response_type:"code",state:n}),t.location=i,o.then((function(e){return e.code}))}},{key:"_formPost",value:function(e,t){var n=r.stringify(t);return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n})}}],[{key:"openAuthPopupWindow",value:function(e){var t=e.screen.width/2-237.5,n=e.screen.height/2-215,o=r.stringify({left:t,top:n,width:475,height:430}).replace(/&/g,",");return e.open("about:blank","Log in to Hypothesis",o)}}]),e}();n.default=f},{"./random":211,"query-string":12}],208:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){if("undefined"!=typeof ResizeObserver){var n=new ResizeObserver((function(){return t(e.clientWidth,e.clientHeight)}));return n.observe(e),function(){return n.disconnect()}}var r=e.clientWidth,o=e.clientHeight,i=function(){r===e.clientWidth&&o===e.clientHeight||(r=e.clientWidth,o=e.clientHeight,t(r,o))};e.addEventListener("load",i),window.addEventListener("resize",i);var a=new MutationObserver(i);return a.observe(e,{characterData:!0,childList:!0,subtree:!0}),function(){e.removeEventListener("load",i),window.removeEventListener("resize",i),a.disconnect()}}},{}],209:[function(e,t,n){"use strict";function r(e){return{read:[e],update:[e],delete:[e]}}function o(e,t){return Object.assign(r(e),{read:["group:"+t]})}function i(e){return e.read.some((function(e){return 0===e.indexOf("group:")}))}Object.defineProperty(n,"__esModule",{value:!0}),n.privatePermissions=r,n.sharedPermissions=o,n.defaultPermissions=function(e,t,n){return"private"===function(e){switch(e){case"private":case"shared":return e;default:return"shared"}}(n)&&e?r(e):o(e,t)},n.isShared=i,n.isPrivate=function(e){return!i(e)},n.permits=function(e,t,n){return-1!==e[t].indexOf(n||"")}},{}],210:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.call=function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e3,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o(),l={jsonrpc:"2.0",method:n,params:a,id:s};try{e.postMessage(l,t)}catch(e){return Promise.reject(e)}var f=new Promise((function(e,n){r=function(r){if(r.origin===t&&r.data instanceof Object&&"2.0"===r.data.jsonrpc&&r.data.id===s){var o=r.data,i=o.error,a=o.result;void 0!==i?n(i):void 0!==a?e(a):n(new Error("RPC reply had no result or error"))}},c.addEventListener("message",r)})),d=[f];return u&&d.push(i(u,"Request to ".concat(t," timed out"))),Promise.race(d).then((function(e){return c.removeEventListener("message",r),e})).catch((function(e){throw c.removeEventListener("message",r),e}))};var r=e("./random");function o(){return(0,r.generateHexString)(10)}function i(e,t){return new Promise((function(n,r){setTimeout((function(){return r(new Error(t))}),e)}))}},{"./random":211}],211:[function(e,t,n){"use strict";function r(e){var t=e.toString(16);return 1===t.length?"0"+t:t}Object.defineProperty(n,"__esModule",{value:!0}),n.generateHexString=function(e){var t=window.crypto||window.msCrypto,n=new Uint8Array(e/2);return t.getRandomValues(n),Array.from(n).map(r).join("")}},{}],212:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.retryPromiseOperation=function(e,t){return new Promise((function(n,r){var i=o.default.operation(t);i.attempt((function(){e().then((function(e){i.retry(),n(e)})).catch((function(e){i.retry(e)||r(e)}))}))}))};var r,o=(r=e("retry"))&&r.__esModule?r:{default:r}},{retry:16}],213:[function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){var t=e.slice(0,e.indexOf(":"));return t&&["group","quote","since","tag","text","uri","user"].includes(t)?[t,e.slice(t.length+1)]:[null,e]}function c(e){if(!e)return[];var t=function(e){var t=e.slice(0,1),n=e.slice(-1);return'"'!==t&&"'"!==t||t!==n||(e=e.slice(1,e.length-1)),e},n=e.match(/(?:[^\s"']+|"[^"]*"|'[^']*')+/g)||[];n=n.map(t);for(var r=0;r<n.length;r++){var i=o(u(n[r]),2),a=i[0],c=i[1];a&&(n[r]=a+":"+t(c))}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.toObject=function(e){var t,n={},i=function(e,t){return n[e]?n[e].push(t):n[e]=[t]};if(e){var a,s=r(c(e));try{for(s.s();!(a=s.n()).done;){var l=a.value,f=o(u(l),2),d=f[0],p=f[1];d||(d="any",p=l),i("tag"===(t=d)?"tags":t,p)}}catch(e){s.e(e)}finally{s.f()}}return n},n.generateFacetedFilter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],o=[],i=[],a=[],u=[],s=[],l=t.user?[t.user]:[];if(e){var f,d=r(c(e));try{for(d.s();!(f=d.n()).done;){var p=f.value,m=p.slice(0,p.indexOf(":")),h=p.slice(m.length+1);switch(m){case"quote":o.push(h);break;case"since":var y=p.slice(6).toLowerCase(),v=86400,g={sec:1,min:60,hour:3600,day:v,week:7*v,month:30*v,year:365*v},b=y.match(/^(\d+)(sec|min|hour|day|week|month|year)?$/);if(b){var _=parseFloat(b[1]),w=b[2]||"sec";i.push(_*g[w])}break;case"tag":a.push(h);break;case"text":u.push(h);break;case"uri":s.push(h);break;case"user":l.push(h);break;default:n.push(p)}}}catch(e){d.e(e)}finally{d.f()}}return{any:{terms:n,operator:"and"},quote:{terms:o,operator:"and"},since:{terms:i,operator:"and"},tag:{terms:a,operator:"and"},text:{terms:u,operator:"and"},uri:{terms:s,operator:"or"},user:{terms:l,operator:"or"}}}},{}],214:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.init=function(e){var t=function(){try{var e=document.currentScript;return new URL(e.src).origin}catch(e){return null}}(),n=t?[t]:void 0;i.init({dsn:e.dsn,environment:e.environment,ignoreErrors:["Fetch operation failed"],release:"1.0.0-dummy-version",whitelistUrls:n,beforeSend:function(e,t){if(c>=5)return(0,a.default)("Client-side Sentry quota reached. No further Sentry events will be sent"),null;++c;try{var n=t&&t.originalException;n instanceof Event&&Object.assign(e.extra,{type:n.type,detail:n.detail,isTrusted:n.isTrusted})}catch(e){}return e}}),i.setExtra("document_url",document.referrer)},n.setUserInfo=function(e){i.setUser(e)},n.reset=function(){c=0};var o,i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("@sentry/browser")),a=(o=e("../../shared/warn-once"))&&o.__esModule?o:{default:o};function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}var c=0},{"../../shared/warn-once":82,"@sentry/browser":"@sentry/browser"}],215:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.withServices=function(e){if(!e.injectedProps)return e;function t(t){var n,i=(0,o.useContext)(l),a={},s=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(e.injectedProps);try{for(s.s();!(n=s.n()).done;){var f=n.value;f in t||(a[f]=i.get(f))}}catch(e){s.e(e)}finally{s.f()}return(0,r.createElement)(e,u({},a,t))}var n=e.displayName||e.name;return t.displayName="withServices(".concat(n,")"),t.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.propTypes),e.injectedProps.forEach((function(e){delete t.propTypes[e]})),t},n.useService=function(e){return(0,o.useContext)(l).get(e)},n.ServiceContext=void 0;var r=e("preact"),o=e("preact/hooks");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s={get:function(e){throw new Error('Missing ServiceContext provider to provide "'.concat(e,'" prop'))}},l=(0,r.createContext)(s);n.ServiceContext=l},{preact:7,"preact/hooks":8}],216:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shouldShowSidebarTutorial=function(e){return!!e.preferences.show_sidebar_tutorial},n.shouldAutoDisplayTutorial=function(e,t,n){var r="object"===i(t.preferences)&&!!t.preferences.show_sidebar_tutorial,a=(0,o.default)(n)||{onHelpRequestProvided:!1};return e&&!a.onHelpRequestProvided&&r};var r,o=(r=e("../service-config"))&&r.__esModule?r:{default:r};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../service-config":149}],217:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.awaitStateChange=function(e,t){var n=t(e);return null!==n?Promise.resolve(n):new Promise((function(n){var r=e.subscribe((function(){var o=t(e);null!==o&&(r(),n(o))}))}))}},{}],218:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.tabForAnnotation=a,n.shouldShowInTab=function(e,t){return!o.isWaitingToAnchor(e)&&a(e)===t};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("./annotation-metadata"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){return o.isOrphan(e)?"orphan":o.isPageNote(e)?"note":"annotation"}},{"./annotation-metadata":192}],219:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.applyTheme=function(e,t){var n={};return t.branding?(e.forEach((function(e){var o=r[e],i=t.branding[e];o&&i&&(n[o]=i)})),n):n};var r={accentColor:"color",appBackgroundColor:"backgroundColor",ctaBackgroundColor:"backgroundColor",ctaTextColor:"color",selectionFontFamily:"fontFamily",annotationFontFamily:"fontFamily"}},{}],220:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=f(e("./build-thread")),i=f(e("./memoize")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./annotation-metadata")),u=e("./search-filter"),c=f(e("./view-filter")),s=e("./tabs");function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function f(e){return e&&e.__esModule?e:{default:e}}var d={Newest:function(e,t){return e.updated>t.updated},Oldest:function(e,t){return e.updated<t.updated},Location:function(e,t){return a.location(e)<a.location(t)}};var p=(0,i.default)((function(e){var t=e.selection,n={expanded:t.expanded,forcedVisible:t.forcedVisible,selected:t.selected,sortCompareFn:d[t.sortKey]},r=!!t.filterQuery||Object.keys(t.filters).length>0;if(r){var i=(0,u.generateFacetedFilter)(t.filterQuery||"",t.filters);n.filterFn=function(e){return(0,c.default)([e],i).length>0}}return!r&&"sidebar"===e.route&&(n.threadFilterFn=function(e){return!!e.annotation&&(0,s.shouldShowInTab)(e.annotation,t.selectedTab)}),(0,o.default)(e.annotations,n)}));n.default=p},{"./annotation-metadata":192,"./build-thread":194,"./memoize":206,"./search-filter":213,"./tabs":218,"./view-filter":226}],221:[function(e,t,n){"use strict";function r(e,t){var n=!!e.annotation&&e.visible===t;return e.children.reduce((function(e,n){return e+r(n,t)}),n?1:0)}Object.defineProperty(n,"__esModule",{value:!0}),n.countHidden=function(e){return r(e,!1)},n.countVisible=function(e){return r(e,!0)}},{}],222:[function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(n,"__esModule",{value:!0}),n.clearFormatters=function(){c={}},n.nextFuzzyUpdate=m,n.decayingInterval=function(e,t){var n,r=e?new Date(e):null;return function o(){var i=m(r,new Date);null!==i&&(n=setTimeout((function(){t(e),o()}),i+500))}(),function(){return clearTimeout(n)}},n.toFuzzyString=function(e,t,n){return e?p(e,t).formatFn(e,t,n):""};var i=1e3,a=6e4,u=36e5,c={};function s(e,t){return t-e}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.Intl;if(n&&n.DateTimeFormat){var r=JSON.stringify(t),o=c[r];return o||(o=c[r]=new n.DateTimeFormat(void 0,t)),o.format(e)}return e.toDateString()}var f=[{test:function(e,t){return s(e,t)<3e4},formatFn:function(){return"Just now"},nextUpdate:1e3},{test:function(e,t){return s(e,t)<6e4},formatFn:function(e,t){var n=Math.floor(s(e,t)/i);return"".concat(n," secs ago")},nextUpdate:1e3},{test:function(e,t){return s(e,t)<1*u},formatFn:function(e,t){var n=Math.floor(s(e,t)/a),r=n>1?"s":"";return"".concat(n," min").concat(r," ago")},nextUpdate:6e4},{test:function(e,t){return s(e,t)<24*u},formatFn:function(e,t){var n=Math.floor(s(e,t)/u),r=n>1?"s":"";return"".concat(n," hr").concat(r," ago")},nextUpdate:1*u},{test:function(e,t){return e.getFullYear()===t.getFullYear()},formatFn:function(e,t,n){return l(e,{month:"short",day:"numeric"},n)},nextUpdate:null}],d={test:function(){return!0},formatFn:function(e,t,n){return l(e,{day:"numeric",month:"short",year:"numeric"},n)},nextUpdate:null};function p(e,t){var n,o=r(f);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.test(e,t))return i}}catch(e){o.e(e)}finally{o.f()}return d}function m(e,t){if(!e)return null;var n=p(e,t).nextUpdate;return null===n?null:(n=Math.max(n,5e3),n=Math.min(n,20736e5))}},{}],223:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fold=function(e){return e.replace(r,"")},n.normalize=function(e){return e.normalize("NFKD")};var r=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u08FE\u0900-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C82\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D02\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1DC0-\u1DE6\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE26]/g},{}],224:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.replaceURLParams=function(e,t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=":"+r;-1!==e.indexOf(i)?e=e.replace(i,encodeURIComponent(o)):n[r]=o}return{url:e,params:n}},n.resolve=function(e,t){return new URL(e,t).href}},{}],225:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;r(this,e);var i="N/A",a=n.metadata,u=i;t.userid&&(u=t.userid,t.displayName&&(u="".concat(t.displayName," (").concat(u,")"))),this.timestamp=(new Date).toString(),this.url=n.uri||i,this.fingerprint=a&&a.documentFingerprint?a.documentFingerprint:i,this.account=u,this.userAgent=o.navigator.userAgent,this.version="1.0.0-dummy-version"}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"asFormattedString",value:function(){var e="";for(var t in this)Object.prototype.hasOwnProperty.call(this,t)&&(e+="".concat(t,": ").concat(this[t],"\r\n"));return e}},{key:"asEncodedURLString",value:function(){return encodeURIComponent(this.asFormattedString())}}]),e}();n.default=i},{}],226:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=Object.entries(t).filter((function(e){return u(e,2)[1].terms.length>0})).map((function(e){var t,n=u(e,2),r=n[0],o=n[1],i=o.terms.map(d);if("any"===r){var a=["quote","text","tag","user"];t=i.map((function(e){return new m("or",a.map((function(t){return new p(t,e,h[t])})))}))}else t=i.map((function(e){return new p(r,e,h[r])}));return new m(o.operator,t)})),r=new m("and",n);return e.filter((function(e){return e.id&&r.matches(e)})).map((function(e){return e.id}))};var o=e("./annotation-metadata"),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./unicode"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function d(e){return"string"!=typeof e?e:i.fold(i.normalize(e)).toLowerCase()}var p=function(){function e(t,n,r){s(this,e),this.field=t,this.term=n,this.checker=r}return f(e,[{key:"matches",value:function(e){var t=this.checker;if(t.autofalse&&t.autofalse(e))return!1;var n=t.value(e);return n=Array.isArray(n)?n.map(d):d(n),t.match(this.term,n)}}]),e}(),m=function(){function e(t,n){s(this,e),this.operator=t,this.filters=n}return f(e,[{key:"matches",value:function(e){return"and"===this.operator?this.filters.every((function(t){return t.matches(e)})):this.filters.some((function(t){return t.matches(e)}))}}]),e}(),h={quote:{autofalse:function(e){return(e.references||[]).length>0},value:function(e){return(0,o.quote)(e)||""},match:function(e,t){return t.indexOf(e)>-1}},since:{autofalse:function(e){return"string"!=typeof e.updated},value:function(e){return new Date(e.updated)},match:function(e,t){return(Date.now()-t)/1e3<=e}},tag:{autofalse:function(e){return!Array.isArray(e.tags)},value:function(e){return e.tags},match:function(e,t){return t.includes(e)}},text:{autofalse:function(e){return"string"!=typeof e.text},value:function(e){return e.text},match:function(e,t){return t.indexOf(e)>-1}},uri:{autofalse:function(e){return"string"!=typeof e.uri},value:function(e){return e.uri},match:function(e,t){return t.indexOf(e)>-1}},user:{autofalse:function(e){return"string"!=typeof e.user},value:function(e){return e.user+" "+function(e){return e.user_info&&e.user_info.display_name||""}(e)},match:function(e,t){return t.indexOf(e)>-1}}}},{"./annotation-metadata":192,"./unicode":223}],227:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.calculateVisibleThreads=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r,a=i.defaultHeight,u=i.marginAbove,c=i.marginBelow,s=[],l=0,f=0,d=0;return e.forEach((function(e){var r=t[e.id]||a;l+r<n-u?f+=r:l<n+o+c?s.push(e):d+=r,l+=r})),{visibleThreads:s,offscreenUpperHeight:f,offscreenLowerHeight:d}},n.THREAD_DIMENSION_DEFAULTS=void 0;var r={defaultHeight:200,marginAbove:800,marginBelow:800};n.THREAD_DIMENSION_DEFAULTS=r},{}],228:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.watch=function(e,t,n){var r=Array.isArray(t),i=function(){return r?t.map((function(e){return e()})):t()},a=i();return e((function(){var e=i();if(!(r?(0,o.default)(e,a):e===a)){var t=a;a=e,n(e,t)}}))};var r,o=(r=e("shallowequal"))&&r.__esModule?r:{default:r}},{shallowequal:20}],229:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CLOSE_ABNORMAL=n.CLOSE_GOING_AWAY=n.CLOSE_NORMAL=void 0;var r,o=(r=e("retry"))&&r.__esModule?r:{default:r},i=e("tiny-emitter");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=1e3;n.CLOSE_NORMAL=p;n.CLOSE_GOING_AWAY=1001;n.CLOSE_ABNORMAL=1006;var m=function(e){u(n,i.TinyEmitter);var t=s(n);function n(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var i,a,u=f(r=t.call(this)),c=[];function s(){for(;c.length>0;){var e=JSON.stringify(c.shift());i.send(e)}}return r.close=function(){i.close(p)},r.send=function(e){c.push(e),this.isConnected()&&s()},r.isConnected=function(){return i.readyState===WebSocket.OPEN},function t(){a||(a=o.default.operation({minTimeout:2e3,retries:10,randomize:!0})).attempt((function(){(i=new WebSocket(e)).onopen=function(e){a=null,s(),u.emit("open",e)},i.onclose=function(e){if(e.code!==p&&1001!==e.code){var n=new Error("WebSocket closed abnormally, code: "+e.code);console.warn(n),function(e){if(a)a.retry(e)||console.error("reached max retries attempting to reconnect websocket");else{var n=1e3;n+=Math.floor(Math.random()*n),a=setTimeout((function(){a=null,t()}),n)}}(n)}else u.emit("close",e)},i.onerror=function(e){u.emit("error",e)},i.onmessage=function(e){u.emit("message",e)}}))}(),r}return n}();n.default=m},{retry:16,"tiny-emitter":24}]},{},[144]);
//# sourceMappingURL=sidebar.bundle.js.map